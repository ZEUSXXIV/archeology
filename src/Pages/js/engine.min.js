var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(p){var d=0;return function(){return d<p.length?{done:!1,value:p[d++]}:{done:!0}}};$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,d,P){p!=Array.prototype&&p!=Object.prototype&&(p[d]=P.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(p,d){this.$jscomp$symbol$id_=p;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function p(P){if(this instanceof p)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(P||"")+"_"+d++,P)}var d=0;return p}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.asyncIterator;p||(p=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};
(function(p,d){"object"===typeof exports&&"undefined"!==typeof module?d(exports,require("three"),require("hls.js")):"function"===typeof define&&define.amd?define(["exports","three","hls.js"],d):(p=p||self,d(p.PANOLENS={},p.THREE,p.Hls))})(this,function(p,d,P){function xa(d,f){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(d);f&&(a=a.filter(function(a){return Object.getOwnPropertyDescriptor(d,a).enumerable}));g.push.apply(g,a)}return g}function z(d){for(var f=
1;f<arguments.length;f++){var g=null!=arguments[f]?arguments[f]:{};f%2?xa(Object(g),!0).forEach(function(a){var b=g[a];a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):xa(Object(g)).forEach(function(a){Object.defineProperty(d,a,Object.getOwnPropertyDescriptor(g,a))})}return d}function ya(d,f,k,a,b,c,e){try{var h=d[c](e),x=h.value}catch(m){k(m);return}h.done?
f(x):Promise.resolve(x).then(a,b)}function Ma(d){return function(){var f=this,g=arguments;return new Promise(function(a,b){function c(f){ya(h,a,b,c,e,"next",f)}function e(f){ya(h,a,b,c,e,"throw",f)}var h=d.apply(f,g);c(void 0)})}}function C(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function");}function za(d,f){for(var g=0;g<f.length;g++){var a=f[g];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(d,a.key,a)}}function H(d,
f,k){f&&za(d.prototype,f);k&&za(d,k);return d}function F(d,f){if("function"!==typeof f&&null!==f)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,writable:!0,configurable:!0}});f&&ka(d,f)}function v(d){v=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)};return v(d)}function ka(d,f){ka=Object.setPrototypeOf||function(f,a){f.__proto__=a;return f};return ka(d,f)}
function Na(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(g){return!1}}function t(d){if(void 0===d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function Aa(d,f){if(f&&("object"===typeof f||"function"===typeof f))return f;if(void 0!==f)throw new TypeError("Derived constructors may only return object or undefined");
return t(d)}function G(d){var f=Na();return function(){var g=v(d);if(f){var a=v(this).constructor;g=Reflect.construct(g,arguments,a)}else g=g.apply(this,arguments);return Aa(this,g)}}function r(d,f,k){r="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=v(a),null!==a););if(a)return b=Object.getOwnPropertyDescriptor(a,b),b.get?b.get.call(c):b.value};return r(d,f,k||d)}function Oa(d,f){if(d){if("string"===typeof d)return Ba(d,f);
var g=Object.prototype.toString.call(d).slice(8,-1);"Object"===g&&d.constructor&&(g=d.constructor.name);if("Map"===g||"Set"===g)return Array.from(d);if("Arguments"===g||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Ba(d,f)}}function Ba(d,f){if(null==f||f>d.length)f=d.length;for(var g=0,a=Array(f);g<f;g++)a[g]=d[g];return a}function la(d,f){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var g="undefined"!==typeof Symbol&&d[Symbol.iterator]||d["@@iterator"];if(!g){if(Array.isArray(d)||
(g=Oa(d))||f&&d&&"number"===typeof d.length){g&&(d=g);var a=0;f=function(){};return{s:f,n:function(){return a>=d.length?{done:!0}:{done:!1,value:d[a++]}},e:function(a){throw a;},f:f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var b=!0,c=!1,e;return{s:function(){g=g.call(d)},n:function(){var a=g.next();b=a.done;return a},e:function(a){c=!0;e=a},f:function(){try{b||null==g.return||g.return()}finally{if(c)throw e;
}}}}function ma(g,f){ba.uniforms.threshold.value=g.threshold;ba.uniforms.useTexture.value=g.useTexture;ba.uniforms.tMixTexture.value=f;return new d.ShaderMaterial(ba)}function na(d,f,k,a,b){var c;function e(a,b){if(1<b.length)for(var c=0;c<b.length;c++)e(a,b[c]);else b.rotation.x+=Math.sign(a.y)*q}function h(a,c){if(1<c.length)for(var e=0;e<c.length;e++)h(a,c[e]);else r+=-Math.sign(a.x),r=r===b?0:r,r=0>r?b-1:r,C.dispatchEvent({type:"rotation",data:{currentSide:r}}),c.rotation.y+=-(Math.sign(a.x)*
Math.PI*2)/b}function x(a,c){if(1<c.length)for(var e=0;e<c.length;e++)x(a,c[e]);else r+=-Math.sign(a.x),r=r===b?0:r,r=0>r?b-1:r,C.dispatchEvent({type:"rotation",data:{currentSide:r}}),c.rotation.y+=-(Math.sign(a.x)*Math.PI*2)/b}function m(a,b){return a/b}function g(a,b,c,e,h,f){var d=6<arguments.length&&void 0!==arguments[6]?arguments[6]:!1,x=0;setTimeout(function Pa(){oa||(x++,r=(b+x)%e,w.rotation.y+=-(Math.sign(a)*Math.PI*2)/e,C.dispatchEvent({type:"rotation",data:{currentSide:r}}),d&&(x%=e),x===
c?C.dispatchEvent({type:"initial-auto-rotate-finished"}):setTimeout(Pa,f(h,c)))},f(h,c))}function l(a,b){if(D[b].enabled){if(1<w.length){for(var c=!0,e=0;e<w.length;e++){if(!c)return!1;D[b].enabled&&(c=!!(-1*D[b].from<w[e].rotation[b]+a&&w[e].rotation[b]+a<D[b].to))}return c}return!!(-1*D[b].from<w.rotation[b]+a&&w.rotation[b]+a<D[b].to)}return!0}function E(){u=!1;A=c=0}var n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;this.setObjectToMove=function(a){w=a};this.setZoomSpeed=function(a){p=
a};this.setDistance=function(a,b){Ca=a;N=b};this.setRotationSpeed=function(a){};this.setRotationSpeedTouchDevices=function(a){q=a};this.enableVerticalRotation=function(){t=!0};this.disableVerticalRotation=function(){t=!1};this.enableHorizontalRotation=function(){y=!0};this.disableHorizontalRotation=function(){y=!1};this.setMaxVerticalRotationAngle=function(a,b){D.x.from=a;D.x.to=b;D.x.enabled=!0};this.setMaxHorizontalRotationAngle=function(a,b){D.y.from=a;D.y.to=b;D.y.enabled=!0};this.disableMaxHorizontalAngleRotation=
function(){D.y.enabled=!1};this.disableMaxVerticalAngleRotation=function(){D.x.enabled=!1};this.disableZoom=function(){v=!1};this.enableZoom=function(){v=!0};this.setIsZoomed=function(a){};f=void 0!==f?f:document;var D={x:{enabled:!1,from:Math.PI/8,to:Math.PI/8},y:{enabled:!1,from:Math.PI/4,to:Math.PI/4}},w=k,N=300,Ca=300,p=.5,q=2E-4,u=!1,oa=!1,t=!1,y=!0,v=!1;var A=c=0;var z=[],r=n,B={X:null,Y:null},C=this;this.animate=function(a){g(-1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b,b,
3E3,m,a)};f.addEventListener("mousedown",function(a){u=oa=!0;c=a.offsetX;A=a.offsetY},!1);f.addEventListener("mousemove",function(a){u&&y&&(h({x:a.offsetX-c,y:a.offsetY-A},w),c=a.offsetX,A=a.offsetY)},!1);f.addEventListener("mouseup",E,!1);f.addEventListener("mouseout",E,!1);f.addEventListener("touchstart",function(a){a.preventDefault();oa=!0;2===a.touches.length?(B.X=Math.abs(a.touches[0].clientX-a.touches[1].clientX),B.Y=Math.abs(a.touches[0].clientY-a.touches[1].clientY),z=Array(2)):(c=a.touches[0].pageX,
A=a.touches[0].pageY)},!1);f.addEventListener("touchmove",function(a){a.preventDefault();if(2===a.touches.length&&v){z=Array(2);var b=Math.abs(a.touches[0].clientX-a.touches[1].clientX);a=Math.abs(a.touches[0].clientY-a.touches[1].clientY);B&&0<B.X&&0<B.Y&&(b>B.X&&a>B.Y&&d.position.z>Ca?d.position.z-=p:b<B.X&&d.position.z<N&&a<B.Y&&(d.position.z+=p));B.X=b;B.Y=a}else if(0===z.length){B.X=null;B.Y=null;b={x:a.touches[0].pageX-c,y:a.touches[0].pageY-A};c=a.touches[0].pageX;A=a.touches[0].pageY;if(y&&
0!=b.x){if(!l(Math.sign(b.x)*q,"y"))return;x(b,w)}t&&0!=b.y&&l(Math.sign(b.y)*q,"x")&&e(b,w)}},!1);f.addEventListener("touchend",function(a){B.X=null;B.Y=null;0<z.length?z.pop():z=[];a.preventDefault();A=c=0},!1)}function ca(g,f,k){function a(){k.addEventListener("mousemove",c,!1);k.addEventListener("mousedown",e,!1);k.addEventListener("mouseup",h,!1);k.addEventListener("mouseleave",h,!1);k.addEventListener("touchmove",x,!1);k.addEventListener("touchstart",m,!1);k.addEventListener("touchend",I,!1)}
function b(){k.removeEventListener("mousemove",c,!1);k.removeEventListener("mousedown",e,!1);k.removeEventListener("mouseup",h,!1);k.removeEventListener("mouseleave",h,!1);k.removeEventListener("touchmove",x,!1);k.removeEventListener("touchstart",m,!1);k.removeEventListener("touchend",I,!1)}function c(a){a.preventDefault();var b=k.getBoundingClientRect();w.x=(a.clientX-b.left)/b.width*2-1;w.y=2*-((a.clientY-b.top)/b.height)+1;D.setFromCamera(w,f);q&&t.enabled?(D.ray.intersectPlane(n,p)&&q.position.copy(p.sub(N)),
t.dispatchEvent({type:"drag",object:q})):(D.setFromCamera(w,f),a=D.intersectObjects(g),0<a.length?(a=a[0].object,n.setFromNormalAndCoplanarPoint(f.getWorldDirection(n.normal),a.position),u!==a&&(t.dispatchEvent({type:"hoveron",object:a}),k.style.cursor="pointer",u=a)):null!==u&&(t.dispatchEvent({type:"hoveroff",object:u}),k.style.cursor="auto",u=null))}function e(a){a.preventDefault();D.setFromCamera(w,f);a=D.intersectObjects(g,l);0<a.length&&(q=a[0].object,D.ray.intersectPlane(n,p)&&N.copy(p).sub(q.position),
k.style.cursor="move",t.dispatchEvent({type:"dragstart",object:q}))}function h(a){a.preventDefault();q&&(t.dispatchEvent({type:"dragend",object:q}),q=null);k.style.cursor="auto"}function x(a){a.preventDefault();a=a.changedTouches[0];var b=k.getBoundingClientRect();w.x=(a.clientX-b.left)/b.width*2-1;w.y=2*-((a.clientY-b.top)/b.height)+1;D.setFromCamera(w,f);q&&t.enabled&&(D.ray.intersectPlane(n,p)&&q.position.copy(p.sub(N)),t.dispatchEvent({type:"drag",object:q}))}function m(a){a.preventDefault();
a=a.changedTouches[0];var b=k.getBoundingClientRect();w.x=(a.clientX-b.left)/b.width*2-1;w.y=2*-((a.clientY-b.top)/b.height)+1;D.setFromCamera(w,f);a=D.intersectObjects(g,l);0<a.length&&(q=a[0].object,n.setFromNormalAndCoplanarPoint(f.getWorldDirection(n.normal),q.position),D.ray.intersectPlane(n,p)&&N.copy(p).sub(q.position),k.style.cursor="move",t.dispatchEvent({type:"dragstart",object:q}))}function I(a){a.preventDefault();q&&(t.dispatchEvent({type:"dragend",object:q}),q=null);k.style.cursor="auto"}
var l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1;if(g.isCamera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var E=g;g=f;f=E}var n=new d.Plane,D=new d.Raycaster,w=new d.Vector2,N=new d.Vector3,p=new d.Vector3,q=null,u=null,t=this;a();this.enabled=!0;this.activate=a;this.deactivate=b;this.dispose=function(){b()};this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")};this.on=function(a,b){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");
t.addEventListener(a,b)};this.off=function(a,b){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");t.removeEventListener(a,b)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");t.dispatchEvent({type:a})}}function da(g,f){function k(){return 2*Math.PI/60/60*n.autoRotateSpeed}function a(a){if(!1!==n.enabled){a.preventDefault();if(a.button===n.mouseButtons.ORBIT){if(!0===n.noRotate)return;
M=L.ROTATE;D.set(a.clientX,a.clientY)}else if(a.button===n.mouseButtons.ZOOM){if(!0===n.noZoom)return;M=L.DOLLY;y.set(a.clientX,a.clientY)}else if(a.button===n.mouseButtons.PAN){if(!0===n.noPan)return;M=L.PAN;p.set(a.clientX,a.clientY)}M!==L.NONE&&(document.addEventListener("mousemove",b,!1),document.addEventListener("mouseup",c,!1),n.dispatchEvent(R))}}function b(a){if(!1!==n.enabled){a.preventDefault();var b=n.domElement===document?n.domElement.body:n.domElement;M===L.ROTATE?!0!==n.noRotate&&(w.set(a.clientX,
a.clientY),N.subVectors(w,D),0==D.x&&0==D.y?(D.set(w.x,w.y),N.subVectors(w,D)):(n.rotateLeft(2*Math.PI*N.x/b.clientHeight*n.rotateSpeed),n.rotateUp(2*Math.PI*N.y/b.clientHeight*n.rotateSpeed),D.copy(w))):M===L.DOLLY?!0!==n.noZoom&&(A.set(a.clientX,a.clientY),B.subVectors(A,y),0<B.y?n.dollyIn():0>B.y&&n.dollyOut(),y.copy(A)):M===L.PAN&&!0!==n.noPan&&(q.set(a.clientX,a.clientY),t.subVectors(q,p),n.pan(t.x,t.y),p.copy(q))}}function c(){!1!==n.enabled&&(document.removeEventListener("mousemove",b,!1),
document.removeEventListener("mouseup",c,!1),n.dispatchEvent(S),M=L.NONE)}function e(a){if(!1!==n.enabled&&!0!==n.noZoom&&M===L.NONE){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?(n.object.fov=n.object.fov<n.maxFov?n.object.fov+1:n.maxFov,n.object.updateProjectionMatrix()):0>b&&(n.object.fov=n.object.fov>n.minFov?n.object.fov-1:n.minFov,n.object.updateProjectionMatrix());n.object.fov<=n.maxFov&&(n.dispatchEvent(O),n.dispatchEvent(R),
n.dispatchEvent(S),n.dispatchEvent(T))}}function h(a){}function x(a){if(!1!==n.enabled&&!0!==n.noKeys&&!0!==n.noRotate){n.autoRotate&&(clearTimeout(this.autoRotateRequestId),n.autoRotate=!1,this.autoRotateRequestId=window.setTimeout(function(){n.autoRotate=!0},5E3));var b=n.momentum&&!n.autoRotate?n.momentumKeydownFactor*n.momentumFactor:n.momentumKeydownFactor;switch(a.keyCode){case n.keys.UP:n.rotateUp(n.rotateSpeed*b);break;case n.keys.BOTTOM:n.rotateUp(-n.rotateSpeed*b);break;case n.keys.LEFT:n.rotateLeft(n.rotateSpeed*
b);break;case n.keys.RIGHT:n.rotateLeft(-n.rotateSpeed*b)}}}function m(a){if(!1!==n.enabled){switch(a.touches.length){case 1:if(!0===n.noRotate)return;M=L.TOUCH_ROTATE;D.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(!0===n.noZoom)return;M=L.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;y.set(0,Math.sqrt(b*b+a*a));break;case 3:if(!0===n.noPan)return;M=L.TOUCH_PAN;p.set(a.touches[0].pageX,a.touches[0].pageY);break;default:M=L.NONE}M!==L.NONE&&
n.dispatchEvent(R)}}function I(a){if(!1!==n.enabled){a.preventDefault();a.stopPropagation();var b=n.domElement===document?n.domElement.body:n.domElement;switch(a.touches.length){case 1:var c=.38*n.rotateSpeed;if(!0===n.noRotate)break;if(M!==L.TOUCH_ROTATE)break;w.set(a.touches[0].pageX,a.touches[0].pageY);N.subVectors(w,D);n.rotateLeft(2*Math.PI*N.x/b.clientHeight*c);n.rotateUp(2*Math.PI*N.y/b.clientHeight*c);D.copy(w);break;case 2:if(!0===n.noZoom)break;if(M!==L.TOUCH_DOLLY)break;b=a.touches[0].pageX-
a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;A.set(0,Math.sqrt(b*b+a*a));B.subVectors(A,y);0>B.y?(n.object.fov=n.object.fov<n.maxFov?n.object.fov+1:n.maxFov,n.object.updateProjectionMatrix()):0<B.y&&(n.object.fov=n.object.fov>n.minFov?n.object.fov-1:n.minFov,n.object.updateProjectionMatrix());y.copy(A);n.dispatchEvent(O);n.dispatchEvent(T);break;case 3:if(!0===n.noPan)break;if(M!==L.TOUCH_PAN)break;q.set(a.touches[0].pageX,a.touches[0].pageY);t.subVectors(q,p);n.pan(t.x,t.y);p.copy(q);
break;default:M=L.NONE}}}function l(){!1!==n.enabled&&(n.dispatchEvent(S),M=L.NONE)}var E=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{panSpeed:1};this.object=g;this.domElement=void 0!==f?f:document;this.panSpeed=E.panSpeed;this.frameId=null;this.enabled=!0;this.center=this.target=new d.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.noRotate=!1;this.rotateSpeed=-.15;this.noPan=!0;this.keyPanSpeed=7;this.autoRotate=
!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.momentumKeydownFactor=.05;this.speedLimit=.04;this.publicSphericalDelta=new d.Spherical;this.momentum=!0;this.momentumFactor=7.5;this.enableDamping=!0;this.dampingFactor=.03;this.minFov=30;this.maxFov=120;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:d.MOUSE.LEFT,ZOOM:d.MOUSE.MIDDLE,PAN:d.MOUSE.RIGHT};var n=this,D=new d.Vector2,
w=new d.Vector2,N=new d.Vector2,p=new d.Vector2,q=new d.Vector2,t=new d.Vector2,u=new d.Vector3,r=new d.Vector3,y=new d.Vector2,A=new d.Vector2,B=new d.Vector2,z=0,v=0,C=0,F=0,G=1,H=new d.Vector3,J=new d.Vector3,K=new d.Quaternion,L={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},M=L.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var P=(new d.Quaternion).setFromUnitVectors(g.up,new d.Vector3(0,1,0)),Q=P.clone().invert(),
O={type:"change"},R={type:"start"},S={type:"end"},T={type:"fov"};this.setLastQuaternion=function(a){K.copy(a);n.object.quaternion.copy(a)};this.getLastPosition=function(){return J};this.rotateLeft=function(a){void 0===a&&(a=k());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;F-=a};this.rotateUp=function(a){void 0===a&&(a=k());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;C-=a};this.rotateLeftStatic=function(a){this.enableDamping=!1;F-=a;this.update();this.enableDamping=!0};
this.rotateUpStatic=function(a){this.enableDamping=!1;C-=a;this.update();this.enableDamping=!0};this.centerTo=function(a,b){var c=n.enableDamping;n.enableDamping=!1;var e=this.object.position;r.copy(e).sub(this.target);r.applyQuaternion(P);z=Math.atan2(r.x,r.z);v=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y);this.autoRotate&&M===L.NONE&&this.rotateLeft(k());z=a;v=b;n.publicSphericalDelta.data={theta:z};z=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,z));v=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,
v));v=Math.max(1E-7,Math.min(Math.PI-1E-7,v));a=r.length()*G;a=Math.max(this.minDistance,Math.min(this.maxDistance,a));this.target.add(H);r.x=a*Math.sin(v)*Math.sin(z);r.y=a*Math.cos(v);r.z=a*Math.sin(v)*Math.cos(z);r.applyQuaternion(Q);e.copy(this.target).add(r);this.object.lookAt(this.target);G=1;H.set(0,0,0);if(1E-7<J.distanceToSquared(this.object.position)||1E-7<8*(1-K.dot(this.object.quaternion)))this.dispatchEvent(O),J.copy(this.object.position),K.copy(this.object.quaternion);n.enableDamping=
c};this.getRotations=function(){return{h:z,v:v}};this.panLeft=function(a){var b=this.object.matrix.elements;u.set(b[0],b[1],b[2]);u.multiplyScalar(-a);H.add(u)};this.panUp=function(a){var b=this.object.matrix.elements;u.set(b[4],b[5],b[6]);u.multiplyScalar(a);H.add(u)};this.pan=function(a,b){var c=n.domElement===document?n.domElement.body:n.domElement;if(n.object instanceof d.PerspectiveCamera){var e=n.object.position.clone().sub(n.target).length();e*=Math.tan(n.object.fov/2*Math.PI/180);n.panLeft(2*
this.panSpeed*a*e/c.clientHeight);n.panUp(2*this.panSpeed*b*e/c.clientHeight)}else n.object instanceof d.OrthographicCamera?(n.panLeft(a*(n.object.right-n.object.left)/c.clientWidth),n.panUp(b*(n.object.top-n.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};this.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,n.zoomSpeed));n.object instanceof d.PerspectiveCamera?G/=a:n.object instanceof d.OrthographicCamera?(n.object.zoom=
Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*a)),n.object.updateProjectionMatrix(),n.dispatchEvent(O)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,n.zoomSpeed));n.object instanceof d.PerspectiveCamera?G*=a:n.object instanceof d.OrthographicCamera?(n.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/a)),n.object.updateProjectionMatrix(),n.dispatchEvent(O)):
console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.update=function(a){var b=this.object.position;r.copy(b).sub(this.target);r.applyQuaternion(P);z=Math.atan2(r.x,r.z);v=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y);this.autoRotate&&M===L.NONE&&this.rotateLeft(k());!0===this.enableDamping&&(F=d.Math.clamp(F,-this.speedLimit,this.speedLimit),C=d.Math.clamp(C,-this.speedLimit,this.speedLimit));z+=F;v+=C;n.publicSphericalDelta.data={theta:z};z=Math.max(this.minAzimuthAngle,
Math.min(this.maxAzimuthAngle,z));v=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,v));v=Math.max(1E-7,Math.min(Math.PI-1E-7,v));var c=r.length()*G;c=Math.max(this.minDistance,Math.min(this.maxDistance,c));this.target.add(H);r.x=c*Math.sin(v)*Math.sin(z);r.y=c*Math.cos(v);r.z=c*Math.sin(v)*Math.cos(z);r.applyQuaternion(Q);b.copy(this.target).add(r);this.object.lookAt(this.target);this.autoRotate||!0!==this.enableDamping||(!this.momentum||M!==L.ROTATE&&M!==L.TOUCH_ROTATE)&&M!==L.NONE?C=F=
0:(F*=1-this.dampingFactor,C*=1-this.dampingFactor);G=1;H.set(0,0,0);if(1E-7<J.distanceToSquared(this.object.position)||1E-7<8*(1-K.dot(this.object.quaternion)))!0!==a&&this.dispatchEvent(O),J.copy(this.object.position),K.copy(this.object.quaternion)};this.reset=function(){M=L.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(O);this.update()};this.getPolarAngle=function(){return v};this.getAzimuthalAngle=
function(){return z};this.dispose=function(){this.domElement.removeEventListener("mousedown",a,{passive:!1});this.domElement.removeEventListener("mousewheel",e,{passive:!1});this.domElement.removeEventListener("DOMMouseScroll",e,{passive:!1});this.domElement.removeEventListener("touchstart",m,{passive:!1});this.domElement.removeEventListener("touchend",l,{passive:!1});this.domElement.removeEventListener("touchmove",I,{passive:!1});window.removeEventListener("keyup",h,{passive:!1});window.removeEventListener("keydown",
x,{passive:!1});document.removeEventListener("mousemove",b,{passive:!1});document.removeEventListener("mouseup",c,{passive:!1})};this.domElement.addEventListener("mousedown",a,{passive:!1});this.domElement.addEventListener("mousewheel",e,{passive:!1});this.domElement.addEventListener("DOMMouseScroll",e,{passive:!1});this.domElement.addEventListener("touchstart",m,{passive:!1});this.domElement.addEventListener("touchend",l,{passive:!1});this.domElement.addEventListener("touchmove",I,{passive:!1});
window.addEventListener("keyup",h,{passive:!1});window.addEventListener("keydown",x,{passive:!1});this.update()}function pa(g,f){var k=this,a=0,b=0,c=0,e=0;this.camera=g;this.camera.rotation.reorder("YXZ");this.domElement=void 0!==f?f:document;this.enabled=!0;this.deviceOrientation={alpha:null,beta:null,gamma:null};this.initialViewOffsetAngle=this.alphaOffsetAngle=this.alpha=this.screenOrientation=0;var h=function(a){null==k.deviceOrientation.alpha&&a&&a.alpha&&(k.initialViewOffsetAngle=d.Math.degToRad(a.alpha));
k.enabled&&(k.deviceOrientation=a)},x=function(){k.screenOrientation=window.orientation||0},m=function(a){k.enabled&&(a.preventDefault(),a.stopPropagation(),c=a.touches[0].pageX,e=a.touches[0].pageY)},I=function(h){k.enabled&&(h.preventDefault(),h.stopPropagation(),a+=d.Math.degToRad((h.touches[0].pageX-c)/4),b+=d.Math.degToRad((e-h.touches[0].pageY)/4),k.updateAlphaOffsetAngle(a),c=h.touches[0].pageX,e=h.touches[0].pageY)};this.connect=function(){x();window.addEventListener("orientationchange",x,
{passive:!0});window.addEventListener("deviceorientation",h,{passive:!0});window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0});k.domElement.addEventListener("touchstart",m,{passive:!1});k.domElement.addEventListener("touchmove",I,{passive:!1});k.enabled=!0};this.disconnect=function(){window.removeEventListener("orientationchange",x,!1);window.removeEventListener("deviceorientation",h,!1);window.removeEventListener("deviceorientation",this.update.bind(this),!1);k.domElement.removeEventListener("touchstart",
m,!1);k.domElement.removeEventListener("touchmove",I,!1);k.enabled=!1};this.update=function(a){if(!1!==k.enabled){a=null!=k.deviceOrientation.alpha?d.Math.degToRad(k.deviceOrientation.alpha)+k.alphaOffsetAngle-k.initialViewOffsetAngle:k.alphaOffsetAngle;var c=null!=k.deviceOrientation.beta?d.Math.degToRad(k.deviceOrientation.beta):1.6,e=null!=k.deviceOrientation.gamma?d.Math.degToRad(k.deviceOrientation.gamma):0,h=k.screenOrientation?d.Math.degToRad(k.screenOrientation):0,f=k.camera.quaternion,x=
new d.Vector3(0,0,1),m=new d.Euler,l=new d.Quaternion,g=new d.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),I=new d.Quaternion,p=new d.Quaternion;if(0==k.screenOrientation){var q=new d.Vector3(1,0,0);I.setFromAxisAngle(q,-b)}else 180==k.screenOrientation?(q=new d.Vector3(1,0,0),I.setFromAxisAngle(q,b)):90==k.screenOrientation?(q=new d.Vector3(0,1,0),I.setFromAxisAngle(q,b)):-90==k.screenOrientation&&(q=new d.Vector3(0,1,0),I.setFromAxisAngle(q,-b));g.multiply(I);g.multiply(p);m.set(c,a,-e,"YXZ");f.setFromEuler(m);
f.multiply(g);f.multiply(l.setFromAxisAngle(x,-h));k.alpha=a}};this.updateAlphaOffsetAngle=function(b){this.alphaOffsetAngle=b;0==a&&(a=b);this.update()};this.getRotations=function(){return{h:k.alpha,v:0}};this.dispose=function(){this.disconnect()};this.connect()}function ea(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.064;this.format=null;this.eyeSep=g;this.loffset=new d.Vector2;this.roffset=new d.Vector2}function Qa(g){var f=new d.OrthographicCamera(-1,1,1,-1,0,1),k=new d.Scene,
a=new d.StereoCamera;a.aspect=.5;var b=new d.WebGLRenderTarget(512,512,{minFilter:d.LinearFilter,magFilter:d.NearestFilter,format:d.RGBAFormat});b.scissorTest=!0;b.texture.generateMipmaps=!1;var c=new d.Vector2(.441,.156),e=(new d.PlaneBufferGeometry(1,1,10,20)).deleteAttribute("normal").toNonIndexed(),h=e.attributes.position.array,x=e.attributes.uv.array;e.attributes.position.count*=2;e.attributes.uv.count*=2;var m=new Float32Array(2*h.length);m.set(h);m.set(h,h.length);var I=new Float32Array(2*
x.length);I.set(x);I.set(x,x.length);x=new d.Vector2;h=h.length/3;for(var l=0,E=m.length/3;l<E;l++){x.x=m[3*l];x.y=m[3*l+1];var n=x.dot(x);n=1.5+(c.x+c.y*n)*n;var p=l<h?0:1;m[3*l]=x.x/n*1.5-.5+p;m[3*l+1]=x.y/n*3;I[2*l]=.5*(I[2*l]+p)}e.attributes.position.array=m;e.attributes.uv.array=I;c=new d.MeshBasicMaterial({map:b.texture});e=new d.Mesh(e,c);k.add(e);this.setEyeSeparation=function(b){a.eyeSep=b};this.setSize=function(a,c){g.setSize(a,c);var e=g.getPixelRatio();b.setSize(a*e,c*e)};this.render=
function(c,e,h,d,x){var m=h instanceof Ra||h instanceof Sa;c.updateMatrixWorld();m&&this.setEyeSeparation(h.stereo.eyeSep);null===e.parent&&e.updateMatrixWorld();a.update(e);e=b.width/2;var l=b.height;g.autoClear&&g.clear();m&&h.updateTextureToLeft();b.scissor.set(0,0,e,l);b.viewport.set(0,0,e,l);g.setRenderTarget(b);g.render(c,a.cameraL);g.clearDepth();m&&h.updateTextureToRight();b.scissor.set(e,0,e,l);b.viewport.set(e,0,e,l);g.setRenderTarget(b);g.render(c,a.cameraR);g.clearDepth();g.setRenderTarget(d?
x:null);g.render(k,f)}}var y="default"in d?d["default"]:d;P=P&&Object.prototype.hasOwnProperty.call(P,"default")?P["default"]:P;var Ta="^0.134.0".replace(/[^0-9.]/g,""),Q={ORBIT:0,DEVICEORIENTATION:1,OBJECT:2,DRAG:3},B={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3},U={TAB:0,SBS:1},X={X:0,Y:-200,Z:0},O={DEFAULT:"default",POINTER:"pointer",GRAB:"-webkit-grab",CROSSHAIR:"crosshair"},qa={FLOOR:"floor_ring_cursor"},Y={DEFAULT:"default",COLOR:"color",BLUR:"blur"},q={BASIC:"basic_panorama",CUBE:"cube_panorama",
DOLLHOUSE:"dollhouse",IMAGE_LITTLE_PLANET:"image_little_planet",IMAGE:"image_panorama",LITTLE_PLANET:"little_planet",PANORAMA:"panorama",SLIDER:"slider_panorama",SPIN:"spin_panorama",STEREO_IMAGE:"stereo_image",STEREO_VIDEO_PANORAMA:"stereo_video_panorama",VIDEO:"video_panorama",PROGRESSVIE_IMAGE:"progressive_image_panorama"},A={DOLLSPOT:"dollspot",FLOOR_RING_INFOSPOT:"floor_ring_infospot",INFOSPOT:"infospot",HOTSPOT:"toScene",NADIR:"nadir",SPOT_MODEL:"spot_model"},S={FLOOR_PLANE:"floor_plane",SPOT_SPHERE:"spot_sphere"},
fa={VIDEO_SOUND_BUTTON:"video-sound__button"},J={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",
Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",
WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",
ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+",
VideoPlay:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==",VideoPause:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==",
VideoUnmute:"data:image/svg+xml;base64,PHN2ZyBpZD0iU3ZnanNTdmcxMDAxIiB3aWR0aD0iMjg4IiBoZWlnaHQ9IjI4OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpzdmdqcz0iaHR0cDovL3N2Z2pzLmNvbS9zdmdqcyI+PGRlZnMgaWQ9IlN2Z2pzRGVmczEwMDIiPjwvZGVmcz48ZyBpZD0iU3ZnanNHMTAwOCIgdHJhbnNmb3JtPSJtYXRyaXgoMC45MTY3LDAsMCwwLjkxNjcsMTIuMTc5NDIyNTcxNTYzNzIsMTIuMjM4MTQzMTg2NTY5MjMyKSI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyODgiIGhlaWdodD0iMjg4IiB2ZXJzaW9uPSIxLjAiIHZpZXdCb3g9IjAgMCA3NSA3NSI+PHBhdGggZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjZmZmZmZmIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjUiIGQ9Ik0zOS4zODksMTMuNzY5IEwyMi4yMzUsMjguNjA2IEw2LDI4LjYwNiBMNiw0Ny42OTkgTDIxLjk4OSw0Ny42OTkgTDM5LjM4OSw2Mi43NSBMMzkuMzg5LDEzLjc2OXoiIGNsYXNzPSJjb2xvcjExMSBzdmdTaGFwZSBjb2xvclN0cm9rZTExMSBzdmdTdHJva2UiPjwvcGF0aD48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNDgsMjcuNmExOS41LDE5LjUgMCAwIDEgMCwyMS40TTU1LjEsMjAuNWEzMCwzMCAwIDAgMSAwLDM1LjZNNjEuNiwxNGEzOC44LDM4LjggMCAwIDEgMCw0OC42IiBjbGFzcz0iY29sb3JTdHJva2UxMTEgc3ZnU3Ryb2tlIj48L3BhdGg+PC9zdmc+PC9nPjwvc3ZnPg==",
VideoMute:"data:image/svg+xml;base64,PHN2ZyBzdHJva2Utd2lkdGg9IjUiIHN0cm9rZT0id2hpdGUiIHZpZXdCb3g9IjAgMCA3NSA3NSIgaGVpZ2h0PSI1MDAiIHdpZHRoPSI1MDAiIHZlcnNpb249IjEuMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0id2hpdGUiIGQ9Im0zOSwxNC0xNywxNUg2VjQ4SDIybDE3LDE1eiI+PC9wYXRoPgo8cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIGQ9Im00OSwyNiAyMCwyNG0wLTI0LTIwLDI0Ij48L3BhdGg+Cjwvc3ZnPg=="},ra={load:function(g){var f=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:function(){},k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};d.Cache.enabled=!0;var b,c,e;for(l in J)J.hasOwnProperty(l)&&g===J[l]&&(e=l);var h=d.Cache.get(e?e:g);if(void 0!==h)return f&&setTimeout(function(){k({loaded:1,total:1});f(h)},0),h;var x=window.URL||window.webkitURL;var m=document.createElementNS("http://www.w3.org/1999/xhtml","img");var I=function(){var a=0<arguments.length&&void 0!==
arguments[0]?arguments[0]:!1;x.revokeObjectURL(m.src);void 0==h&&d.Cache.add(e?e:g,m);f(m,a)};if(0===(null===g||void 0===g?void 0:g.indexOf("data:")))return m.addEventListener("load",I,!1),m.src=g,m;m.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"";var l=new window.XMLHttpRequest;l.open("GET",g,!0);l.responseType="arraybuffer";l.addEventListener("error",a);l.addEventListener("progress",function(a){if(a){var b=a.loaded,c=a.total;a.lengthComputable&&k({loaded:b,total:c})}});l.addEventListener("loadend",
function(a){if(a){a=a.currentTarget;var e=a.status;b=new Uint8Array(a.response);c=new window.Blob([b]);m.addEventListener("load",function(){I(400<=e)},!1);m.addEventListener("error",function(){I(400<=e)},!1);m.src=x.createObjectURL(c)}});l.send(null)}},V={load:function(g){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},k=2<arguments.length?arguments[2]:void 0,a=3<arguments.length?arguments[3]:void 0,b=new d.Texture;ra.load(g,function(a){b.image=a;a=0<g.search(/\.(jpg|jpeg)$/)||
0===g.search(/^data:image\/jpeg/);b.format=a?d.RGBFormat:d.RGBAFormat;b.magFilter=d.LinearFilter;b.needsUpdate=!0;f(b)},k,a);return b}};y.MTLLoader=function(d){this.manager=void 0!==d?d:y.DefaultLoadingManager};y.MTLLoader.prototype={constructor:y.MTLLoader,load:function(d,f,k,a){var b=this,c=new y.FileLoader(this.manager);c.setPath(this.path);c.load(d,function(a){f(b.parse(a))},k,a)},setPath:function(d){this.path=d;return this},setTexturePath:function(d){this.texturePath=d;return this},setBaseUrl:function(d){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");
return this.setTexturePath(d)},setCrossOrigin:function(d){this.crossOrigin=d;return this},setMaterialOptions:function(d){this.materialOptions=d;return this},parse:function(d){var f=d.split("\n"),g={},a=/\s+/;d={};for(var b=0;b<f.length;b++){var c=f[b];c=c.trim();if(0!==c.length&&"#"!==c.charAt(0)){var e=c.indexOf(" "),h=0<=e?c.substring(0,e):c;h=h.toLowerCase();c=0<=e?c.substring(e+1):"";c=c.trim();"newmtl"===h?(g={name:c},d[c]=g):g&&("ka"===h||"kd"===h||"ks"===h?(c=c.split(a,3),g[h]=[parseFloat(c[0]),
parseFloat(c[1]),parseFloat(c[2])]):g[h]=c)}}f=new y.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);f.setCrossOrigin(this.crossOrigin);f.setManager(this.manager);f.setMaterials(d);return f}};y.MTLLoader.MaterialCreator=function(d,f){this.baseUrl=d||"";this.options=f;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:y.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:
y.RepeatWrapping};y.MTLLoader.MaterialCreator.prototype={constructor:y.MTLLoader.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(d){this.crossOrigin=d},setManager:function(d){this.manager=d},setMaterials:function(d){this.materialsInfo=this.convert(d);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(d){if(!this.options)return d;var f={},g;for(g in d){var a=d[g],b={};f[g]=b;for(var c in a){var e=!0,h=a[c],x=c.toLowerCase();switch(x){case "kd":case "ka":case "ks":this.options&&
this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[2]&&(e=!1)}e&&(b[x]=h)}}return f},preload:function(){for(var d in this.materialsInfo)this.create(d)},getIndex:function(d){return this.nameLookup[d]},getAsArray:function(){var d=0,f;for(f in this.materialsInfo)this.materialsArray[d]=this.create(f),this.nameLookup[f]=d,d++;return this.materialsArray},create:function(d){void 0===this.materials[d]&&this.createMaterial_(d);return this.materials[d]},
createMaterial_:function(d){function f(a,b){return"string"!==typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function g(b,e){if(!c[b]){e=a.getTextureParams(e,c);var h=a.loadTexture(f(a.baseUrl,e.url));h.repeat.copy(e.scale);h.offset.copy(e.offset);h.wrapS=a.wrap;h.wrapT=a.wrap;c[b]=h}}var a=this,b=this.materialsInfo[d],c={name:d,side:this.side},e;for(e in b){var h=b[e];if(""!==h)switch(e.toLowerCase()){case "kd":c.color=(new y.Color).fromArray(h);break;case "ks":c.specular=(new y.Color).fromArray(h);
break;case "map_kd":g("map",h);break;case "map_ks":g("specularMap",h);break;case "norm":g("normalMap",h);break;case "map_bump":case "bump":g("bumpMap",h);break;case "ns":c.shininess=parseFloat(h);break;case "d":h=parseFloat(h);1>h&&(c.opacity=h,c.transparent=!0);break;case "tr":h=parseFloat(h),this.options&&this.options.invertTrProperty&&(h=1-h),0<h&&(c.opacity=1-h,c.transparent=!0)}}this.materials[d]=new y.MeshPhongMaterial(c);return this.materials[d]},getTextureParams:function(d,f){var g={scale:new y.Vector2(1,
1),offset:new y.Vector2(0,0)};d=d.split(/\s+/);var a=d.indexOf("-bm");0<=a&&(f.bumpScale=parseFloat(d[a+1]),d.splice(a,2));a=d.indexOf("-s");0<=a&&(g.scale.set(parseFloat(d[a+1]),parseFloat(d[a+2])),d.splice(a,4));a=d.indexOf("-o");0<=a&&(g.offset.set(parseFloat(d[a+1]),parseFloat(d[a+2])),d.splice(a,4));g.url=d.join(" ").trim();return g},loadTexture:function(d,f,k,a,b){var c=void 0!==this.manager?this.manager:y.DefaultLoadingManager,e=c.getHandler(d);null===e&&(e=new y.TextureLoader(c));e.setCrossOrigin&&
e.setCrossOrigin(this.crossOrigin);d=e.load(d,k,a,b);void 0!==f&&(d.mapping=f);return d}};y.OBJLoader=function(){function d(){var a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)this.object.name=a,this.object.fromDeclaration=!1!==b;else{var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&
this.object._finalize(!0);this.object={name:a||"",fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);a={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){a={index:"number"===
typeof a?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};a.clone=this.clone.bind(a);return a}};this.materials.push(a);return a},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1);if(a&&1<this.materials.length)for(var c=
this.materials.length-1;0<=c;c--)0>=this.materials[c].groupCount&&this.materials.splice(c,1);a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return b}};c&&c.name&&"function"===typeof c.clone&&(a=c.clone(0),a.inherited=!0,this.object.materials.push(a));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseNormalIndex:function(a,
b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseUVIndex:function(a,b){a=parseInt(a,10);return 2*(0<=a?a-1:a+b/2)},addVertex:function(a,b,c){var e=this.vertices,h=this.object.geometry.vertices;h.push(e[a+0],e[a+1],e[a+2]);h.push(e[b+0],e[b+1],e[b+2]);h.push(e[c+0],e[c+1],e[c+2])},addVertexPoint:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addVertexLine:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addNormal:function(a,
b,c){var e=this.normals,h=this.object.geometry.normals;h.push(e[a+0],e[a+1],e[a+2]);h.push(e[b+0],e[b+1],e[b+2]);h.push(e[c+0],e[c+1],e[c+2])},addColor:function(a,b,c){var e=this.colors,h=this.object.geometry.colors;h.push(e[a+0],e[a+1],e[a+2]);h.push(e[b+0],e[b+1],e[b+2]);h.push(e[c+0],e[c+1],e[c+2])},addUV:function(a,b,c){var e=this.uvs,h=this.object.geometry.uvs;h.push(e[a+0],e[a+1]);h.push(e[b+0],e[b+1]);h.push(e[c+0],e[c+1])},addUVLine:function(a){var b=this.uvs;this.object.geometry.uvs.push(b[a+
0],b[a+1])},addFace:function(a,b,c,d,f,l,g,n,k){var e=this.vertices.length;a=this.parseVertexIndex(a,e);b=this.parseVertexIndex(b,e);c=this.parseVertexIndex(c,e);this.addVertex(a,b,c);void 0!==d&&""!==d&&(c=this.uvs.length,a=this.parseUVIndex(d,c),b=this.parseUVIndex(f,c),c=this.parseUVIndex(l,c),this.addUV(a,b,c));void 0!==g&&""!==g&&(d=this.normals.length,a=this.parseNormalIndex(g,d),b=g===n?a:this.parseNormalIndex(n,d),c=g===k?a:this.parseNormalIndex(k,d),this.addNormal(a,b,c));0<this.colors.length&&
this.addColor(a,b,c)},addPointGeometry:function(a){this.object.geometry.type="Points";for(var b=this.vertices.length,c=0,e=a.length;c<e;c++)this.addVertexPoint(this.parseVertexIndex(a[c],b))},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,e=this.uvs.length,h=0,d=a.length;h<d;h++)this.addVertexLine(this.parseVertexIndex(a[h],c));a=0;for(d=b.length;a<d;a++)this.addUVLine(this.parseUVIndex(b[a],e))}};a.startObject("",!1);return a}function f(a){this.manager=
void 0!==a?a:y.DefaultLoadingManager;this.materials=null}var k=/^[og]\s*(.+)?/,a=/^mtllib /,b=/^usemtl /;f.prototype={constructor:f,load:function(a,b,h,d){var c=this,e=new y.FileLoader(c.manager);e.setPath(this.path);e.load(a,function(a){b(c.parse(a))},h,d)},setPath:function(a){this.path=a;return this},setMaterials:function(a){this.materials=a;return this},parse:function(c){console.time("OBJLoader r117");var e=new d;-1!==c.indexOf("\r\n")&&(c=c.replace(/\r\n/g,"\n"));-1!==c.indexOf("\\\n")&&(c=c.replace(/\\\n/g,
""));var h=c.split("\n"),f,m="function"===typeof"".trimLeft;c=0;for(var g=h.length;c<g;c++){var l=h[c];l=m?l.trimLeft():l.trim();var E=l.length;if(0!==E&&(E=l.charAt(0),"#"!==E))if("v"===E)switch(l=l.split(/\s+/),l[0]){case "v":e.vertices.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));8===l.length&&e.colors.push(parseFloat(l[4]),parseFloat(l[5]),parseFloat(l[6]));break;case "vn":e.normals.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case "vt":e.uvs.push(parseFloat(l[1]),
parseFloat(l[2]))}else if("f"===E){l=l.substr(1).trim();var n=l.split(/\s+/);l=[];E=0;for(f=n.length;E<f;E++){var p=n[E];0<p.length&&(p=p.split("/"),l.push(p))}n=l[0];E=1;for(f=l.length-1;E<f;E++){p=l[E];var w=l[E+1];e.addFace(n[0],p[0],w[0],n[1],p[1],w[1],n[2],p[2],w[2])}}else if("l"===E){E=l.substring(1).trim().split(" ");f=[];n=[];if(-1===l.indexOf("/"))f=E;else for(l=0,p=E.length;l<p;l++)w=E[l].split("/"),""!==w[0]&&f.push(w[0]),""!==w[1]&&n.push(w[1]);e.addLineGeometry(f,n)}else if("p"===E)l=
l.substr(1).trim(),l=l.split(" "),e.addPointGeometry(l);else if(null!==(f=k.exec(l)))l=(" "+f[0].substr(1).trim()).substr(1),e.startObject(l);else if(b.test(l))e.object.startMaterial(l.substring(7).trim(),e.materialLibraries);else if(a.test(l))e.materialLibraries.push(l.substring(7).trim());else if("s"===E){if(f=l.split(" "),1<f.length?(l=f[1].trim().toLowerCase(),e.object.smooth="0"!==l&&"off"!==l):e.object.smooth=!0,l=e.object.currentMaterial())l.smooth=e.object.smooth}else if("\x00"!==l)throw Error('THREE.OBJLoader: Unexpected line: "'+
l+'"');}e.finalize();h=new y.Group;h.materialLibraries=[].concat(e.materialLibraries);c=0;for(g=e.objects.length;c<g;c++)if(m=e.objects[c],l=m.geometry,E=m.materials,f="Line"===l.type,n="Points"===l.type,p=!1,0!==l.vertices.length){w=new y.BufferGeometry;w.setAttribute("position",new y.Float32BufferAttribute(l.vertices,3));0<l.normals.length?w.setAttribute("normal",new y.Float32BufferAttribute(l.normals,3)):w.computeVertexNormals();0<l.colors.length&&(p=!0,w.setAttribute("color",new y.Float32BufferAttribute(l.colors,
3)));0<l.uvs.length&&w.setAttribute("uv",new y.Float32BufferAttribute(l.uvs,2));for(var N=[],q=0,r=E.length;q<r;q++){var t=E[q];l=void 0;if(null!==this.materials)if(l=this.materials.create(t.name),f&&l&&!(l instanceof y.LineBasicMaterial)){var u=new y.LineBasicMaterial;u.copy(l);u.lights=!1;l=u}else if(n&&l&&!(l instanceof y.PointsMaterial)){var v=new y.PointsMaterial({size:10,sizeAttenuation:!1});u.copy(l);l=v}l||(l=f?new y.LineBasicMaterial:n?new y.PointsMaterial({size:1,sizeAttenuation:!1}):new y.MeshPhongMaterial,
l.name=t.name);l.flatShading=t.smooth?!1:!0;l.vertexColors=p?y.VertexColors:y.NoColors;N.push(l)}if(1<N.length){q=0;for(r=E.length;q<r;q++)t=E[q],w.addGroup(t.groupStart,t.groupCount,q);l=f?new y.LineSegments(w,N):n?new y.Points(w,N):new y.Mesh(w,N)}else l=f?new y.LineSegments(w,N[0]):n?new y.Points(w,N[0]):new y.Mesh(w,N[0]);l.name=m.name;h.add(l)}console.timeEnd("OBJLoader r117");return h}};return f}();var Ua=y.MTLLoader,Va=y.OBJLoader,Z=function(d){function f(){var a=0<arguments.length&&void 0!==
arguments[0]?arguments[0]:{};C(this,f);var b=g.call(this);b.options=z({},a);b.shortId=b.options.shortId;b.element=b.createElement();b.container=null;b.isSelected=!1;b.type=A.DOLLSPOT;b.addEventListener("panolens-container",b.setContainer.bind(t(b)));return b}F(f,d);var g=G(f);H(f,[{key:"updateTitle",value:function(a){this.element.innerHTML='\n      <div class="panolens-dollspot-container">\n        <div class="panolens-dollspot-title">'.concat(a,'</div>\n        <svg class="panolens-dollspot-icon" width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 8L15 1V0H1V1L8 8Z" fill="currentColor"/>\n        </svg>\n\n    <div class="panolens-dollspot__wrapper-spot">\n      <svg width="9" height="5" viewBox="0 0 9 5" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <ellipse cx="4.50013" cy="2.13327" rx="3.53846" ry="1.88718" fill="white"/>\n      </svg>\n    </div>\n  </div>\n    ')}},
{key:"select",value:function(){this.isSelected=!0}},{key:"unselect",value:function(){this.isSelected=!1}},{key:"createElement",value:function(){var a=document.createElement("div");a.innerHTML='\n      <div class="panolens-dollspot-container">\n        <div class="panolens-dollspot-title">'.concat(this.options.title||". . .",'</div>\n        <svg class="panolens-dollspot-icon" width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 8L15 1V0H1V1L8 8Z" fill="currentColor"/>\n        </svg>\n\n        <div class="panolens-dollspot__wrapper-spot">\n          <svg width="9" height="5" viewBox="0 0 9 5" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <ellipse cx="4.50013" cy="2.13327" rx="3.53846" ry="1.88718" fill="white"/>\n          </svg>\n        </div>\n      </div>\n  ');
var b=document.createElement("style");b.type="text/css";b.textContent="\n    .panolens-dollspot-container {\n      position: absolute;\n      bottom: 0;\n      left: '50%';\n      display: flex;\n      overflow: visible;\n      align-items: center;\n      flex-direction: column;\n      justify-content: flex-end;\n      transform: translate(-50%, 0);\n      filter: drop-shadow(0 1px #00000020) drop-shadow(0 3px 4px #00000020);\n      cursor: pointer;\n    }\n\n    .panolens-dollspot-title {\n      position: relative;\n      z-index: -1;\n      bottom: 0px;\n      overflow: hidden;\n      max-width: 128px;\n      padding: 2px 12px 4px;\n      text-align: center;\n      text-overflow: ellipsis;\n      color: #FFF;\n      border-radius: 6px;\n      background-color: rgba(0, 0, 0, 0.75);\n      backdrop-filter: blur(4px);\n      font-size: 12px;\n      white-space: nowrap;\n    }\n\n    .panolens-dollspot-container:hover .panolens-dollspot-title {\n      background: #000000;\n      backdrop-filter: blur(3px);\n    }\n\n    .panolens-dollspot-icon {\n      color: rgba(0, 0, 0, 0.75);\n      position: relative;\n      width: 16px;\n      height: 10px;\n      margin: 0 auto;\n    }\n\n    .panolens-dollspot-container:hover .panolens-dollspot-icon {\n      color: #000000;\n      backdrop-filter: blur(3px);\n    }\n  ";
a.append(b);document.head.append(b);a.style.display="none";a.style.position="absolute";a.style.width=0;a.style.height=0;a.style.top=0;a.style.left=0;a.classList.add("panolens-infospot");a.addEventListener("mousedown",this.onClick.bind(this));return a}},{key:"translateElement",value:function(a,b){this.element&&this.container&&(b-=this.element.clientHeight,a="translate(".concat(a-this.element.clientWidth,"px, ").concat(b,"px)"),this.element.style.transform=a,this.element.style.webkitTransform=a,this.element.style.msTransform=
a,this.element.style.display="flex")}},{key:"onClick",value:function(){this.dispatchEvent({type:"select-dollspot",dollspot:this})}},{key:"destroy",value:function(){this.element.remove()}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}}]);return f}(d.Object3D),Da=function(g){function f(a,b,c){C(this,f);var e=k.call(this);e.loaded=!1;d.ImageUtils.crossOrigin="";e.mtlLoader=new Ua;
e.objLoader=new Va;e.loadMtlObj(a,b,c);e.name=q.DOLLHOUSE;e.type=q.DOLLHOUSE;e.isInfospotVisible=!1;e.container=null;e.addEventListener("click",e.onClick.bind(t(e)));e.addEventListener("panolens-container",e.setContainer.bind(t(e)));return e}F(f,g);var k=G(f);H(f,[{key:"add",value:function(a){var b=this;if(a instanceof Z){var c=this.container;a.addEventListener("select-dollspot",function(a){b.dispatchEvent({type:"dollhouse-select-dollspot",dollspot:a.dollspot})});c&&a.dispatchEvent({type:"panolens-container",
container:c});a.dispatchEvent({type:"panolens-infospot-focus",method:function(a,b,c){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[a,b,c]})}})}r(v(f.prototype),"add",this).call(this,a);this.dispatchEvent({type:"addChild"})}},{key:"toggleInfospotVisibility",value:function(a,b){b=void 0!==b?b:0;var c=void 0!==a?a:!this.isInfospotVisible;this.traverse(function(a){a instanceof Z&&(c?a.show(b):a.hide(b))});this.isInfospotVisible=c}},{key:"onClick",value:function(a){a.intersects&&
0===a.intersects.length&&this.traverse(function(a){a.dispatchEvent({type:"dismiss"})})}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&(this.children.forEach(function(a){a instanceof Z&&a.dispatchEvent&&a.dispatchEvent({type:"panolens-container",container:b})}),this.container=b)}},{key:"loadMtlObj",value:function(a,b,c){var e=this;this.dispatchEvent({type:"load-start"});this.mtlLoader.crossOrigin="";this.mtlLoader.setPath(a);this.mtlLoader.load(b,
function(a){a.preload();e.objLoader.setMaterials(a);e.objLoader.load(c,e.onObjLoadSuccess.bind(e),e.onObjLoadProgress.bind(e),e.onObjLoadError.bind(e))})}},{key:"onObjLoadSuccess",value:function(a){this.loaded=!0;a.position.set(0,0,0);a.name="dollhouseObject";var b=new window.THREE.AmbientLight(16777215,.8);b.name="dollhouseLight";a.add(b);this.add(a);this.dispatchEvent({type:"loaded"});this.dispatchEvent({type:"ready"})}},{key:"addLight",value:function(a){var b=new window.THREE.AmbientLight(16777215,
.8);b.name="dollhouseLight";a.add(b)}},{key:"onObjLoadProgress",value:function(a){this.dispatchEvent({type:"loading",percentDownloaded:"".concat(Math.trunc(100*a.loaded/a.total))})}},{key:"onObjLoadError",value:function(a){this.dispatchEvent({type:"error"});console.error("An error happened",a.message)}},{key:"dispose",value:function(){function a(b){for(var c=b.geometry,h=b.material,d=b.children.length-1;0<=d;d--)a(b.children[d]),b.remove(b.children[d]);c&&(c.dispose(),b.geometry=null);h&&(Array.isArray(h)?
h.forEach(function(a){return a.dispose()}):h.dispose(),b.material=null)}var b=this.material;b&&b.uniforms&&b.uniforms.tEquirect&&b.uniforms.tEquirect.value.dispose();this.dispatchEvent({type:"panolens-viewer-handler",method:"onDollhouseDispose",data:this});a(this);this.parent&&this.parent.remove(this)}}]);return f}(d.Mesh),Ea={load:function(g){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length?
arguments[3]:void 0,b;var c=new d.CubeTexture([]);var e=0;var h={};var x={};g.map(function(d,g){ra.load(d,function(a){c.images[g]=a;e++;6===e&&(c.needsUpdate=!0,f(c))},function(a){h[g]={loaded:a.loaded,total:a.total};x.loaded=0;b=x.total=0;for(var c in h)b++,x.loaded+=h[c].loaded,x.total+=h[c].total;6>b&&(x.total=x.total/b*6);k(x)},a)});return c}},Fa=function(d){function f(a){C(this,f);a||console.warn("PANOLENS.Widget: No container specified");var b=g.call(this);b.DEFAULT_TRANSITION="all 0.27s ease";
b.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);b.PREVENT_EVENT_HANDLER=function(a){a.preventDefault();a.stopPropagation()};b.container=a;b.barElement=null;b.fullscreenElement=null;b.videoElement=null;b.settingElement=null;b.mainMenu=null;b.activeMainItem=null;b.activeSubMenu=null;b.mask=null;return b}F(f,d);var g=G(f);H(f,[{key:"addControlBar",value:function(){if(this.container){var a=this,b,c;var e=document.createElement("div");e.classList.add("videoWidgetBar");
e.style.width="200px";e.style.height="44px";e.style.left="50%";e.style.transform=e.style.webkitTransform=e.style.msTransform="translate(-100px, -100%)";e.style.bottom="120px";e.style.background="-webkit-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");e.style.background="-moz-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");e.style.background="-o-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");e.style.background="-ms-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");
e.style.background="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))";e.style.transition=this.DEFAULT_TRANSITION;e.style.pointerEvents="none";e.style.position="absolute";e.isHidden=!1;e.toggle=function(){e.isHidden=!e.isHidden;b=e.isHidden?"translate(-100px, 0)":"translate(-100px, -100%)";c=e.isHidden?0:1;e.style.transform=e.style.webkitTransform=e.style.msTransform=b;e.style.opacity=c};var h=this.createDefaultMenu();this.mainMenu=this.createMainMenu(h);e.append(this.mainMenu);this.mask=h=
this.createMask();this.container.append(h);e.dispose=function(){a.fullscreenElement&&(a.fullscreenElement.remove(),a.fullscreenElement.dispose(),a.fullscreenElement=null);a.settingElement&&(a.settingElement.remove(),a.settingElement.dispose(),a.settingElement=null);a.videoElement&&(a.videoElement.remove(),a.videoElement.dispose(),a.videoElement=null)};this.container.append(e);this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0);this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,
!0);this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0);this.mask.addEventListener(a.TOUCH_ENABLED?"touchend":"click",function(b){b.preventDefault();b.stopPropagation();a.mask.hide();a.settingElement.deactivate()},!1);this.addEventListener("control-bar-toggle",e.toggle);this.barElement=e}else console.warn("Widget container not set")}},{key:"createDefaultMenu",value:function(){var a=this;var b=function(b,e){return function(){a.dispatchEvent({type:"panolens-viewer-handler",method:b,
data:e})}};return[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:b("enableControl",Q.ORBIT)},{title:"Sensor",handler:b("enableControl",Q.DEVICEORIENTATION)}]},{title:"Mode",subMenu:[{title:"Normal",handler:b("disableEffect")},{title:"Cardboard",handler:b("enableEffect",B.CARDBOARD)},{title:"Stereoscopic",handler:b("enableEffect",B.STEREO)}]}]}},{key:"addControlButton",value:function(a){switch(a){case "fullscreen":this.fullscreenElement=a=this.createFullscreenButton();
break;case "setting":this.settingElement=a=this.createSettingButton();break;case "video":this.videoElement=a=this.createVideoControl();break;default:return}a&&this.barElement.append(a)}},{key:"createMask",value:function(){var a=document.createElement("div");a.classList.add("videoWidgetMask");a.style.position="absolute";a.style.top=0;a.style.left=0;a.style.width="100%";a.style.height="100%";a.style.background="transparent";a.style.display="none";a.show=function(){this.style.display="block"};a.hide=
function(){this.style.display="none"};return a}},{key:"createSettingButton",value:function(){var a=this;var b=this.createCustomItem({style:{backgroundImage:'url("'.concat(J.Setting,'")'),webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(b){b.preventDefault();b.stopPropagation();a.mainMenu.toggle();this.activated?this.deactivate():this.activate()}});b.activate=function(){this.style.transform="rotate3d(0,0,1,90deg)";this.activated=!0;a.mask.show()};b.deactivate=
function(){this.style.transform="rotate3d(0,0,0,0)";this.activated=!1;a.mask.hide();a.mainMenu&&a.mainMenu.visible&&a.mainMenu.hide();a.activeSubMenu&&a.activeSubMenu.visible&&a.activeSubMenu.hide();a.mainMenu&&a.mainMenu._width&&(a.mainMenu.changeSize(a.mainMenu._width),a.mainMenu.unslideAll())};b.activated=!1;return b}},{key:"createFullscreenButton",value:function(){function a(){e&&(c=!c,d.style.backgroundImage=c?'url("'.concat(J.FullscreenLeave,'")'):'url("'.concat(J.FullscreenEnter,'")'));b.dispatchEvent({type:"panolens-viewer-handler",
method:"onWindowResize"});e=!0}var b=this,c=!1,e=!0,h=this.container;if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){document.addEventListener("fullscreenchange",a,!1);document.addEventListener("webkitfullscreenchange",a,!1);document.addEventListener("mozfullscreenchange",a,!1);document.addEventListener("MSFullscreenChange",a,!1);var d=this.createCustomItem({style:{backgroundImage:'url("'.concat(J.FullscreenEnter,'")')},
onTap:function(a){a.preventDefault();a.stopPropagation();e=!1;c?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),c=!1):(h.requestFullscreen&&h.requestFullscreen(),h.msRequestFullscreen&&h.msRequestFullscreen(),h.mozRequestFullScreen&&h.mozRequestFullScreen(),h.webkitRequestFullscreen&&h.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),
c=!0);this.style.backgroundImage=c?'url("'.concat(J.FullscreenLeave,'")'):'url("'.concat(J.FullscreenEnter,'")')}});if(!document.querySelector("panolens-style-addon")){var f=document.createElement("style");f.id="panolens-style-addon";f.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }";document.body.append(f)}return d}}},{key:"createVideoControl",value:function(){var a=document.createElement("span");a.style.display="none";a.show=function(){a.style.display=""};a.hide=
function(){a.style.display="none";a.controlButton.paused=!0;a.controlButton.update()};a.controlButton=this.createVideoControlButton();a.soundButton=this.createVideoSoundButton();a.seekBar=this.createVideoControlSeekbar();a.append(a.controlButton);a.append(a.seekBar);a.append(a.soundButton);a.dispose=function(){a.controlButton.remove();a.seekBar.remove();a.controlButton.dispose();a.controlButton=null;a.seekBar.dispose();a.seekBar=null};this.addEventListener("video-control-show",a.show);this.addEventListener("video-control-hide",
a.hide);return a}},{key:"createVideoControlButton",value:function(){var a=this,b=this.createCustomItem({style:{"float":"left",backgroundImage:'url("'.concat(J.VideoPlay,'")')},onTap:function(c){c.preventDefault();c.stopPropagation();a.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused});this.paused=!this.paused;b.update()}});b.paused=!0;b.update=function(a){this.paused=void 0!==a?a:this.paused;this.style.backgroundImage='url("'.concat(this.paused?J.VideoPlay:
J.VideoPause,'")')};return b}},{key:"createVideoSoundButton",value:function(){var a=this,b=this.createCustomItem({style:{"float":"left",backgroundImage:'url("'.concat(J.VideoMute,'")')},id:fa.VIDEO_SOUND_BUTTON,onTap:function(c){c.preventDefault();c.stopPropagation();b.isDisabled||(a.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoSound"}),this.muted=!this.muted,b.update())}});this.muted=!0;b.update=function(a){this.muted=void 0!==a?a:this.muted;this.style.backgroundImage='url("'.concat(this.muted?
J.VideoUnmute:J.VideoMute,'")')};return b}},{key:"createVideoControlSeekbar",value:function(){function a(a){a.stopPropagation();d=!0;f=a.clientX||a.changedTouches&&a.changedTouches[0].clientX;g=Number.parseInt(k.style.width)/100;h.container.addEventListener("mousemove",b,{passive:!0});h.container.addEventListener("mouseup",c,{passive:!0});h.container.addEventListener("touchmove",b,{passive:!0});h.container.addEventListener("touchend",c,{passive:!0})}function b(a){d&&(l=((a.clientX||a.changedTouches&&
a.changedTouches[0].clientX)-f)/p.clientWidth,l=g+l,l=1<l?1:0>l?0:l,p.setProgress(l),h.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:l}))}function c(a){a.stopPropagation();d=!1;e()}function e(){h.container.removeEventListener("mousemove",b,!1);h.container.removeEventListener("mouseup",c,!1);h.container.removeEventListener("touchmove",b,!1);h.container.removeEventListener("touchend",c,!1)}var h=this,d=!1,f,g,l;var k=document.createElement("div");k.style.width="0%";
k.style.height="100%";k.style.backgroundColor="#fff";var n=document.createElement("div");n.style["float"]="right";n.style.width="14px";n.style.height="14px";n.style.transform="translate(7px, -5px)";n.style.borderRadius="50%";n.style.backgroundColor="#ddd";n.addEventListener("mousedown",a,{passive:!0});n.addEventListener("touchstart",a,{passive:!0});k.append(n);var p=this.createCustomItem({style:{"float":"left",width:"110px",display:"flex",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},
onTap:function(a){a.preventDefault();a.stopPropagation();if(a.target!==n){var b=a.changedTouches&&0<a.changedTouches.length?(a.changedTouches[0].pageX-a.target.getBoundingClientRect().left)/this.clientWidth:a.offsetX/this.clientWidth;h.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:b});p.setProgress(a.offsetX/this.clientWidth)}},onDispose:function(){e();n=k=null}});p.append(k);p.setProgress=function(a){k.style.width="".concat(100*a,"%")};this.addEventListener("video-update",
function(a){p.setProgress(a.percentage)});p.progressElement=k;p.progressElementControl=n;return p}},{key:"createMenuItem",value:function(a){var b=this,c=document.createElement("a");c.textContent=a;c.style.display="block";c.style.padding="10px";c.style.textDecoration="none";c.style.cursor="pointer";c.style.pointerEvents="auto";c.style.transition=this.DEFAULT_TRANSITION;c.slide=function(a){this.style.transform="translateX(".concat(a?"":"-","100%)")};c.unslide=function(){this.style.transform="translateX(0)"};
c.setIcon=function(a){this.icon&&(this.icon.style.backgroundImage="url(".concat(a,")"))};c.setSelectionTitle=function(a){this.selection&&(this.selection.textContent=a)};c.addSelection=function(a){var b=document.createElement("span");b.style.fontSize="13px";b.style.fontWeight="300";b.style["float"]="right";this.selection=b;this.setSelectionTitle(a);this.append(b);return this};c.addIcon=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:J.ChevronRight,b=1<arguments.length&&void 0!==
arguments[1]?arguments[1]:!1,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,d=document.createElement("span");d.style["float"]=b?"left":"right";d.style.width="17px";d.style.height="17px";d.style["margin".concat(b?"Right":"Left")]="12px";d.style.backgroundSize="cover";c&&(d.style.transform="rotateZ(180deg)");this.icon=d;this.setIcon(a);this.append(d);return this};c.addSubMenu=function(a,c){this.subMenu=b.createSubMenu(a,c);return this};c.addEventListener("mouseenter",function(){this.style.backgroundColor=
"#e0e0e0"},!1);c.addEventListener("mouseleave",function(){this.style.backgroundColor="#fafafa"},!1);return c}},{key:"createMenuItemHeader",value:function(a){a=this.createMenuItem(a);a.style.borderBottom="1px solid #333";a.style.paddingBottom="15px";return a}},{key:"createMainMenu",value:function(a){function b(a){a.preventDefault();a.stopPropagation();var b=c.mainMenu,e=this.subMenu;b.hide();b.slideAll();b.parentElement.append(e);c.activeMainItem=this;c.activeSubMenu=e;window.requestAnimationFrame(function(){b.changeSize(e.clientWidth);
e.show();e.unslideAll()})}var c=this,e=this.createMenu();e._width=200;e.changeSize(e._width);a=la(a);var h;try{for(a.s();!(h=a.n()).done;){var d=h.value,f=e.addItem(d.title);f.style.paddingLeft="20px";f.addIcon().addEventListener(c.TOUCH_ENABLED?"touchend":"click",b,!1);d.subMenu&&0<d.subMenu.length&&f.addSelection(d.subMenu[0].title).addSubMenu(d.title,d.subMenu)}}catch(I){a.e(I)}finally{a.f()}return e}},{key:"createSubMenu",value:function(a,b){function c(a){a.preventDefault();a.stopPropagation();
h=e.mainMenu;h.changeSize(h._width);h.unslideAll();h.show();d.slideAll(!0);d.hide();"header"!==this.type&&(d.setActiveItem(this),e.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}var e=this,h,d=this.createMenu();d.items=b;d.activeItem=null;d.addHeader(a).addIcon(void 0,!0,!0).addEventListener(e.TOUCH_ENABLED?"touchend":"click",c,!1);a=la(b);var f;try{for(a.s();!(f=a.n()).done;){var g=f.value,l=d.addItem(g.title);l.style.fontWeight=300;l.handler=g.handler;l.addIcon(" ",
!0);l.addEventListener(e.TOUCH_ENABLED?"touchend":"click",c,!1);d.activeItem||d.setActiveItem(l)}}catch(E){a.e(E)}finally{a.f()}d.slideAll(!0);return d}},{key:"createMenu",value:function(){var a=this,b=document.createElement("span"),c=b.style;c.padding="5px 0";c.position="fixed";c.bottom="100%";c.right="14px";c.backgroundColor="#fafafa";c.fontFamily="Helvetica Neue";c.fontSize="14px";c.visibility="hidden";c.opacity=0;c.boxShadow="0 0 12pt rgba(0,0,0,0.25)";c.borderRadius="2px";c.overflow="hidden";
c.willChange="width, height, opacity";c.pointerEvents="auto";c.transition=this.DEFAULT_TRANSITION;b.visible=!1;b.changeSize=function(a,b){a&&(this.style.width="".concat(a,"px"));b&&(this.style.height="".concat(b,"px"))};b.show=function(){this.style.opacity=1;this.style.visibility="visible";this.visible=!0};b.hide=function(){this.style.opacity=0;this.style.visibility="hidden";this.visible=!1};b.toggle=function(){this.visible?this.hide():this.show()};b.slideAll=function(a){for(var c=0;c<b.children.length;c++)b.children[c].slide&&
b.children[c].slide(a)};b.unslideAll=function(){for(var a=0;a<b.children.length;a++)b.children[a].unslide&&b.children[a].unslide()};b.addHeader=function(b){b=a.createMenuItemHeader(b);b.type="header";this.append(b);return b};b.addItem=function(b){b=a.createMenuItem(b);b.type="item";this.append(b);return b};b.setActiveItem=function(a){this.activeItem&&this.activeItem.setIcon(" ");a.setIcon(J.Check);this.activeItem=a};b.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0);b.addEventListener("mouseup",
this.PREVENT_EVENT_HANDLER,!0);b.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0);return b}},{key:"createCustomItem",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=this,c=a.element||document.createElement("span"),e=a.onDispose;c.style.cursor="pointer";c.style["float"]="right";c.style.width="44px";c.style.height="100%";c.style.backgroundSize="60%";c.style.backgroundRepeat="no-repeat";c.style.backgroundPosition="center";c.style.webkitUserSelect=c.style.MozUserSelect=
c.style.userSelect="none";c.style.position="relative";c.style.pointerEvents="auto";a.id&&c.setAttribute("id",a.id);c.addEventListener(b.TOUCH_ENABLED?"touchstart":"mouseenter",function(){c.style.filter=c.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"},{passive:!0});c.addEventListener(b.TOUCH_ENABLED?"touchend":"mouseleave",function(){c.style.filter=c.style.webkitFilter=""},{passive:!0});this.mergeStyleOptions(c,a.style);a.onTap&&c.addEventListener(b.TOUCH_ENABLED?"touchend":"click",
a.onTap,!1);c.dispose=function(){c.removeEventListener(b.TOUCH_ENABLED?"touchend":"click",a.onTap,!1);if(e)a.onDispose()};return c}},{key:"mergeStyleOptions",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c;for(c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c]);return a}},{key:"dispose",value:function(){this.barElement&&(this.barElement.remove(),this.barElement.dispose(),this.barElement=null)}}]);return f}(d.EventDispatcher),Ga=function(g){function f(){var a=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:16777215,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1500;C(this,f);var e=window.devicePixelRatio,h=function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=32*e;a.height=32*e;b.scale(e,e);b.shadowBlur=5;b.shadowColor="rgba(200,200,200,0.9)";return{canvas:a,context:b}}(),x=h.canvas;h=h.context;var m=new d.SpriteMaterial({color:a,map:function(a){a=new d.CanvasTexture(a);
a.minFilter=d.LinearFilter;a.magFilter=d.LinearFilter;a.generateMipmaps=!1;return a}(x)});m=k.call(this,m);m.dpr=e;m.canvasWidth=x.width;m.canvasHeight=x.height;m.context=h;m.color=a instanceof d.Color?a:new d.Color(a);m.autoSelect=b;m.dwellTime=c;m.rippleDuration=500;m.position.z=-10;m.center.set(.5,.5);m.scale.set(.5,.5,1);m.startTimestamp=null;m.timerId=null;m.callback=null;m.frustumCulled=!1;m.updateCanvasArcByProgress(0);return m}F(f,g);var k=G(f);H(f,[{key:"setColor",value:function(a){this.material.color.copy(a instanceof
d.Color?a:new d.Color(a))}},{key:"updateCanvasArcByProgress",value:function(a){var b=this.context,c=this.canvasWidth,e=this.canvasHeight,d=this.material,f=this.dpr,m=a*Math.PI*2,g=this.color.getStyle(),l=.5*c/f;f=.5*e/f;b.clearRect(0,0,c,e);b.beginPath();0===a?(b.arc(l,f,c/16,0,2*Math.PI),b.fillStyle=g,b.fill()):(b.arc(l,f,c/4-3,-Math.PI/2,-Math.PI/2+m),b.strokeStyle=g,b.lineWidth=3,b.stroke());b.closePath();d.map.needsUpdate=!0}},{key:"ripple",value:function(){var a=this,b=this.context,c=this.canvasWidth,
e=this.canvasHeight,d=this.material,f=this.rippleDuration,m=performance.now(),g=this.color,l=this.dpr,k=.5*c/l,n=.5*e/l;this.dispatchEvent({type:"reticle-ripple-start"});(function w(){var h=window.requestAnimationFrame(w),x=(performance.now()-m)/f,I=0<1-x?1-x:0,p=x*c*.5/l;b.clearRect(0,0,c,e);b.beginPath();b.arc(k,n,p,0,2*Math.PI);b.fillStyle="rgba(".concat(255*g.r,", ").concat(255*g.g,", ").concat(255*g.b,", ").concat(I,")");b.fill();b.closePath();1<=x&&(window.cancelAnimationFrame(h),a.updateCanvasArcByProgress(0),
a.dispatchEvent({type:"reticle-ripple-end"}));d.map.needsUpdate=!0})()}},{key:"show",value:function(){this.visible=!0}},{key:"hide",value:function(){this.visible=!1}},{key:"start",value:function(a){this.autoSelect&&(this.dispatchEvent({type:"reticle-start"}),this.startTimestamp=performance.now(),this.callback=a,this.update())}},{key:"end",value:function(){this.startTimestamp&&(window.cancelAnimationFrame(this.timerId),this.updateCanvasArcByProgress(0),this.startTimestamp=this.timerId=this.callback=
null,this.dispatchEvent({type:"reticle-end"}))}},{key:"update",value:function(){this.timerId=window.requestAnimationFrame(this.update.bind(this));var a=(performance.now()-this.startTimestamp)/this.dwellTime;this.updateCanvasArcByProgress(a);this.dispatchEvent({type:"reticle-update",progress:a});1<=a&&(window.cancelAnimationFrame(this.timerId),this.callback&&this.callback(),this.end(),this.ripple())}}]);return f}(d.Sprite),R=function(g){function f(){C(this,f);var a=k.call(this,f.createGeometry(),f.createMaterial());
a.subtype=S.FLOOR_PLANE;a.position.set(X.X,X.Y,X.Z);a.rotateX(-Math.PI/2);return a}F(f,g);var k=G(f);H(f,[{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.parent&&this.parent.remove(this);c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new d.PlaneBufferGeometry(3E3,3E3,1,1)}},{key:"createMaterial",value:function(){return new d.MeshBasicMaterial({color:0,side:d.DoubleSide,
opacity:0,transparent:!0})}}]);return f}(d.Mesh),u=function(d,f){return f={exports:{}},d(f,f.exports),f.exports}(function(d,f){f=function(){this._tweens={};this._tweensAddedDuringUpdate={}};f.prototype={getAll:function(){return Object.keys(this._tweens).map(function(a){return this._tweens[a]}.bind(this))},removeAll:function(){this._tweens={}},add:function(a){this._tweens[a.getId()]=a;this._tweensAddedDuringUpdate[a.getId()]=a},remove:function(a){delete this._tweens[a.getId()];delete this._tweensAddedDuringUpdate[a.getId()]},
update:function(a,b){var c=Object.keys(this._tweens);if(0===c.length)return!1;for(a=void 0!==a?a:g.now();0<c.length;){this._tweensAddedDuringUpdate={};for(var e=0;e<c.length;e++){var d=this._tweens[c[e]];d&&!1===d.update(a)&&(d._isPlaying=!1,b||delete this._tweens[c[e]])}c=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var g=new f;g.Group=f;g._nextId=0;g.nextId=function(){return g._nextId++};g.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var a=process.hrtime();
return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};g.Tween=function(a,b){this._object=a;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=g.Easing.Linear.None;
this._interpolationFunction=g.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=b||g;this._id=g.nextId()};g.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(a,b){this._valuesEnd=Object.create(a);void 0!==b&&(this._duration=b);return this},duration:function(a){this._duration=a;return this},
start:function(a){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==a?"string"===typeof a?g.now()+parseFloat(a):a:g.now();this._startTime+=this._delayTime;for(var b in this._valuesEnd){if(this._valuesEnd[b]instanceof Array){if(0===this._valuesEnd[b].length)continue;this._valuesEnd[b]=[this._object[b]].concat(this._valuesEnd[b])}void 0!==this._object[b]&&(this._valuesStart[b]=this._object[b],!1===this._valuesStart[b]instanceof Array&&(this._valuesStart[b]*=
1),this._valuesStartRepeat[b]=this._valuesStart[b]||0)}return this},stop:function(){if(!this._isPlaying)return this;this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var a=0,b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].stop()},group:function(a){this._group=a;return this},delay:function(a){this._delayTime=a;
return this},repeat:function(a){this._repeat=a;return this},repeatDelay:function(a){this._repeatDelayTime=a;return this},yoyo:function(a){this._yoyo=a;return this},easing:function(a){this._easingFunction=a;return this},interpolation:function(a){this._interpolationFunction=a;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(a){this._onStartCallback=a;return this},onUpdate:function(a){this._onUpdateCallback=a;return this},onRepeat:function(a){this._onRepeatCallback=
a;return this},onComplete:function(a){this._onCompleteCallback=a;return this},onStop:function(a){this._onStopCallback=a;return this},update:function(a){var b;if(a<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var c=(a-this._startTime)/this._duration;c=0===this._duration||1<c?1:c;var e=this._easingFunction(c);for(b in this._valuesEnd)if(void 0!==this._valuesStart[b]){var d=this._valuesStart[b]||
0,f=this._valuesEnd[b];f instanceof Array?this._object[b]=this._interpolationFunction(f,e):("string"===typeof f&&(f="+"===f.charAt(0)||"-"===f.charAt(0)?d+parseFloat(f):parseFloat(f)),"number"===typeof f&&(this._object[b]=d+(f-d)*e))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,c);if(1===c)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(b in this._valuesStartRepeat)"string"===typeof this._valuesEnd[b]&&(this._valuesStartRepeat[b]+=parseFloat(this._valuesEnd[b])),
this._yoyo&&(c=this._valuesStartRepeat[b],this._valuesStartRepeat[b]=this._valuesEnd[b],this._valuesEnd[b]=c),this._valuesStart[b]=this._valuesStartRepeat[b];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?a+this._repeatDelayTime:a+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);a=0;for(b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].start(this._startTime+
this._duration);return!1}return!0}};g.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*
a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-
Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*
Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-g.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*g.Easing.Bounce.In(2*a):.5*g.Easing.Bounce.Out(2*
a-1)+.5}}};g.Interpolation={Linear:function(a,b){var c=a.length-1,e=c*b,d=Math.floor(e),f=g.Interpolation.Utils.Linear;return 0>b?f(a[0],a[1],e):1<b?f(a[c],a[c-1],c-e):f(a[d],a[d+1>c?c:d+1],e-d)},Bezier:function(a,b){for(var c=0,e=a.length-1,d=Math.pow,f=g.Interpolation.Utils.Bernstein,m=0;m<=e;m++)c+=d(1-b,e-m)*d(b,m)*a[m]*f(e,m);return c},CatmullRom:function(a,b){var c=a.length-1,e=c*b,d=Math.floor(e),f=g.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(d=Math.floor(e=c*(1+b))),f(a[(d-1+
c)%c],a[d],a[(d+1)%c],a[(d+2)%c],e-d)):0>b?a[0]-(f(a[0],a[0],a[1],a[1],-e)-a[0]):1<b?a[c]-(f(a[c],a[c],a[c-1],a[c-1],e-c)-a[c]):f(a[d?d-1:0],a[d],a[c<d+1?c:d+1],a[c<d+2?c:d+2],e-d)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=g.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var e=b;1<e;e--)c*=e;return a[b]=c}}(),CatmullRom:function(a,b,c,e,d){a=.5*(c-a);e=.5*(e-b);var h=d*d;return(2*
b-2*c+a+e)*d*h+(-3*b+3*c-2*a-e)*h+a*d+b}}};d.exports=g}),Ha=function(g){function f(){C(this,f);var a=k.call(this,f.createGeometry(),f.createMaterial(.7));a.defaultOpacity=.7;a.type=qa.FLOOR;a.enabled=!0;a.visible=!1;a.rotateX(-Math.PI/2);a.scale.set(25,25,25);a.fadeOut=(new u.Tween(a.material)).to({opacity:0});a.fadeIn=(new u.Tween(a.material)).to({opacity:a.defaultOpacity});a.fadeTimeout=null;a.onMove=function(){a.visible?a.show():a.hide()};return a}F(f,g);var k=G(f);H(f,[{key:"show",value:function(){this.visible||
(this.fadeOut.stop(),this.fadeIn.start(),this.visible=!0)}},{key:"hide",value:function(){this.visible&&(this.fadeIn.stop(),this.fadeOut.start(),this.visible=!1)}},{key:"enable",value:function(){this.enabled||(this.fadeOut.stop(),this.fadeIn.start(),this.enabled=this.visible=!0)}},{key:"disable",value:function(){this.enabled&&(this.fadeOut.stop(),this.fadeIn.start(),this.enabled=this.visible=!1)}}],[{key:"createGeometry",value:function(){return new d.RingGeometry(1.4,1,30)}},{key:"createMaterial",
value:function(a){return new d.MeshBasicMaterial({color:16777215,opacity:a,transparent:!0,side:d.DoubleSide})}}]);return f}(d.Mesh),Wa=function(g){function f(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:25,b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};C(this,f);var e=k.call(this);e.hoverOpacity=void 0!==c.opacity?.7*c.opacity:.7;e.defaultOpacity=void 0!==c.opacity?.4*c.opacity:.4;e.baseColor=c.baseColor?new d.Color(c.baseColor):
new d.Color(16777215);e.showTitleHotspotInfospot=void 0!==c.showTitleHotspotInfospot?c.showTitleHotspotInfospot:!1;e.isHiddenDuringTransition=!1;e.options=z({isHide:!1},c);c=new d.TextureLoader;e.type=A.FLOOR_RING_INFOSPOT;e.subtype=A.FLOOR_RING_INFOSPOT;e.animated=void 0!==b?b:!0;e.isHovering=!1;e.element=null;e.toPanorama=null;e.cursorStyle=null;e.mode=B.NORMAL;e.loaded=!1;e.scale.set(a,a,a);e.rotateX(-Math.PI/2);e.container=null;e.originalRaycast=e.raycast;e.HANDLER_FOCUS=null;e.geometry=new d.CircleGeometry(1.4,
30,1,2*Math.PI);e.material.depthTest=!1;e.material.transparent=!0;e.material.opacity=0;e.hoverEnterAnimation=new u.Tween;e.hoverLeaveAnimation=new u.Tween;a=function(a){this.material&&(this.material.color=this.baseColor,this.material.needsUpdate=!0,this.material.alphaMap=a,this.loaded=!0,this.hoverEnterAnimation=(new u.Tween(this.material)).to({opacity:this.hoverOpacity},100),this.hoverLeaveAnimation=(new u.Tween(this.material)).to({opacity:this.defaultOpacity}),this.options.isHide||this.show(100,
!0))}.bind(t(e));e.showAnimation=(new u.Tween(e.material)).to({opacity:e.defaultOpacity},100).onStart(e.enableRaycast.bind(t(e),!0)).easing(u.Easing.Quartic.Out);e.hideAnimation=(new u.Tween(e.material)).to({opacity:0},100).onStart(e.enableRaycast.bind(t(e),!1)).easing(u.Easing.Quartic.Out);e.addEventListener("click",e.onClick);e.addEventListener("hover",e.onHover);e.addEventListener("hoverenter",e.onHoverStart);e.addEventListener("hoverleave",e.onHoverEnd);e.addEventListener("panolens-dual-eye-effect",
e.onDualEyeEffect);e.addEventListener("panolens-container",e.setContainer.bind(t(e)));e.addEventListener("dismiss",e.onDismiss);e.addEventListener("panolens-infospot-focus",e.setFocusMethod);e.addEventListener("parallax-transition-start",e.onTransitionStart.bind(t(e)));e.addEventListener("parallax-transition-complete",e.onTransitionComplete.bind(t(e)));e.addEventListener("not-parallax-transition-start",e.onTransitionStart.bind(t(e)));e.addEventListener("not-parallax-transition-complete",e.onTransitionComplete.bind(t(e)));
c.load("data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjE0MCIgdmlld0JveD0iMCAwIDE0MCAxNDAiIHdpZHRoPSIxNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTAgMGgxNDB2MTQwaC0xNDB6IiBmaWxsPSIjZmZmIi8+PGNpcmNsZSBjeD0iNzAiIGN5PSI3MCIgZmlsbD0iIzAwMCIgcj0iNTAiLz48L3N2Zz4=",a);return e}F(f,g);var k=G(f);H(f,[{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}},{key:"getContainer",
value:function(){return this.container}},{key:"onClick",value:function(a){this.element&&this.getContainer()&&(this.onHoverStart(a),this.lockHoverElement())}},{key:"onDismiss",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.element&&(this.unlockHoverElement(),this.onHoverEnd(a))}},{key:"onHover",value:function(a){if(this.isVisible&&!this.isHovering)this.onHoverStart(a)}},{key:"onHoverStart",value:function(a){var b=this;if(this.loaded&&!this.isHovering&&this.isVisible&&
this.getContainer()){var c=this.cursorStyle||(this.mode===B.NORMAL?O.POINTER:O.DEFAULT),e=this.hoverEnterAnimation,d=this.hoverLeaveAnimation,f=this.element;this.isHovering=!0;this.container.style.cursor=c;setTimeout(function(){b.container.style.cursor=c},0);this.animated&&(d.stop(),e.start());f&&0<=a.mouseEvent.clientX&&0<=a.mouseEvent.clientY&&(a=f.left,e=f.right,d=f.style,this.mode===B.CARDBOARD||this.mode===B.STEREO?(d.display="none",a.style.display="block",e.style.display="block",f._width=a.clientWidth,
f._height=a.clientHeight):(d.display="block",a&&(a.style.display="none"),e&&(e.style.display="none"),f._width=f.clientWidth,f._height=f.clientHeight))}}},{key:"onHoverEnd",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;if(this.getContainer()){var b=this.hoverLeaveAnimation,c=this.hoverEnterAnimation,e=this.element;this.isHovering=!1;a&&(this.container.style.cursor=O.GRAB);this.animated&&(c.stop(),b.start());e&&!this.element.locked&&(a=e.left,b=e.right,e.style.display=
"none",a&&(a.style.display="none"),b&&(b.style.display="none"),this.unlockHoverElement())}}},{key:"onDualEyeEffect",value:function(a){if(this.getContainer()){this.mode=a.mode;a=this.element;var b=this.container.clientWidth/2;var c=this.container.clientHeight/2;a&&(a.left||a.right||(a.left=a.cloneNode(!0),a.right=a.cloneNode(!0)),this.mode===B.CARDBOARD||this.mode===B.STEREO?(a.left.style.display=a.style.display,a.right.style.display=a.style.display,a.style.display="none"):(a.style.display=a.left.style.display,
a.left.style.display="none",a.right.style.display="none"),this.translateElement(b,c),this.container.append(a.left),this.container.append(a.right))}}},{key:"translateElement",value:function(a,b){if(this.element&&this.element._width&&this.element._height&&this.getContainer()){var c=this.container;var e=this.element;var d=e._width/2;var f=e._height/2;var m=void 0!==e.verticalDelta?e.verticalDelta:40;var g=a-d;var l=b-f-m;this.mode!==B.CARDBOARD&&this.mode!==B.STEREO||!e.left||!e.right||a===c.clientWidth/
2&&b===c.clientHeight/2?this.setElementStyle("transform",e,"translate(".concat(g,"px, ").concat(l,"px)")):(g=c.clientWidth/4-d+(a-c.clientWidth/2),l=c.clientHeight/2-f-m+(b-c.clientHeight/2),this.setElementStyle("transform",e.left,"translate(".concat(g,"px, ").concat(l,"px)")),g+=c.clientWidth/2,this.setElementStyle("transform",e.right,"translate(".concat(g,"px, ").concat(l,"px)")))}}},{key:"setElementStyle",value:function(a,b,c){b=b.style;"transform"===a&&(b.webkitTransform=b.msTransform=b.transform=
c)}},{key:"setText",value:function(a){this.element&&(this.element.textContent=a)}},{key:"setCursorHoverStyle",value:function(a){this.cursorStyle=a}},{key:"addHoverText",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",
this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b);this.setText(a)}},{key:"addHoverElement",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=a.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=
b)}},{key:"removeHoverElement",value:function(){this.element&&(this.element.left&&(this.element.left.remove(),this.element.left=null),this.element.right&&(this.element.right.remove(),this.element.right=null),this.element.remove(),this.element=null)}},{key:"lockHoverElement",value:function(){this.element&&(this.element.locked=!0)}},{key:"unlockHoverElement",value:function(){this.element&&(this.element.locked=!1)}},{key:"enableRaycast",value:function(){this.raycast=(0<arguments.length&&void 0!==arguments[0]?
arguments[0]:1)?this.originalRaycast:function(){}}},{key:"show",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=this.hideAnimation,c=this.showAnimation,e=this.material,d=this.defaultOpacity;this.animated&&this.loaded?(b.stop(),c.delay(a).start()):(this.enableRaycast(!0),e.opacity=d);this.isVisible=!0}},{key:"hide",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=this.hideAnimation,c=this.showAnimation,e=this.material;this.animated&&
this.loaded?(c.stop(),b.delay(a).start()):(this.enableRaycast(!1),e.opacity=0);this.isVisible=!1}},{key:"setFocusMethod",value:function(a){a&&(this.HANDLER_FOCUS=a.method)}},{key:"focus",value:function(a,b){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,a,b),this.onDismiss())}},{key:"handleAlwaysShowTitle",value:function(a){if(this.showTitleHotspotInfospot){var b=this.element;if(b){var c=b.left,e=b.right,d=b.style;a?(a&&""!==d.transform&&!this.isHiddenDuringTransition?(d.visibility="visible",
d.display="block"):(d.display="block",d.visibility="hidden"),b._width=b.clientWidth,b._height=b.clientHeight):(d.display="none",c&&(c.style.display="none"),e&&(e.style.display="none"))}}}},{key:"onTransitionStart",value:function(){this.hide();this.isHiddenDuringTransition=!0}},{key:"onTransitionComplete",value:function(){this.show();this.isHiddenDuringTransition=!1}},{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.removeHoverElement();this.parent&&this.parent.remove(this);
c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}]);return f}(d.Mesh),Ia=function(g){function f(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:300,b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length?arguments[2]:void 0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};C(this,f);b=b||J.Info;var h=k.call(this);h.type=A.INFOSPOT;h.subtype=e.isHotspot?A.HOTSPOT:A.INFOSPOT;h.animated=void 0!==c?c:!0;h.isHovering=!1;
h.showTitleHotspotInfospot=void 0!==e.showTitleHotspotInfospot?e.showTitleHotspotInfospot:!1;h.isHiddenDuringTransition=!1;h.maxOpacity=void 0!==e.opacity?1*e.opacity:1;h.minOpacity=0;h.frustumCulled=!1;h.element=null;h.toPanorama=null;h.cursorStyle=null;h.mode=B.NORMAL;h.loaded=!1;h.scale.set(a,a,1);h.rotation.y=Math.PI;h.container=null;h.originalRaycast=h.raycast;h.HANDLER_FOCUS=null;h.material.side=d.DoubleSide;h.material.depthTest=!1;h.material.transparent=!0;h.material.opacity=0;h.visible=!1;
h.shouldRender=!0;h.scaleUpAnimation=new u.Tween;h.scaleDownAnimation=new u.Tween;c=function(b){if(this.material){this.material.map=b;this.material.needsUpdate=!0;this.loaded=this.material.map.needsUpdate=!0;this._parentRatio||(this._parentRatio=1);var c=b.image.width/b.image.height,e=new d.Vector3;b.image.width=b.image.naturalWidth||64;b.image.height=b.image.naturalHeight||64;this.scale.set(c/this._parentRatio*a,a,1);this.material.needsUpdate=!0;this.material.map.needsUpdate=!0;e.copy(this.scale);
this.scaleUpAnimation=(new u.Tween(this.scale)).to({x:1.3*e.x,y:1.3*e.y},500).easing(u.Easing.Elastic.Out);this.scaleDownAnimation=(new u.Tween(this.scale)).to({x:e.x,y:e.y},500).easing(u.Easing.Elastic.Out);this.isHiddenDuringTransition||this.show(500)}}.bind(t(h));h.showAnimation=(new u.Tween(h.material)).to({opacity:h.maxOpacity},500).onStart(h.enableRaycast.bind(t(h),!0)).easing(u.Easing.Quartic.Out);h.hideAnimation=(new u.Tween(h.material)).to({opacity:0},500).onStart(h.enableRaycast.bind(t(h),
!1)).easing(u.Easing.Quartic.Out);h.addEventListener("click",h.onClick);h.addEventListener("hover",h.onHover);h.addEventListener("hoverenter",h.onHoverStart);h.addEventListener("hoverleave",h.onHoverEnd);h.addEventListener("panolens-dual-eye-effect",h.onDualEyeEffect);h.addEventListener("panolens-container",h.setContainer);h.addEventListener("dismiss",h.onDismiss);h.addEventListener("panolens-infospot-focus",h.setFocusMethod);h.addEventListener("parallax-transition-start",h.onTransitionStart.bind(t(h)));
h.addEventListener("parallax-transition-complete",h.onTransitionComplete.bind(t(h)));h.addEventListener("not-parallax-transition-start",h.onTransitionStart.bind(t(h)));h.addEventListener("not-parallax-transition-complete",h.onTransitionComplete.bind(t(h)));V.load(b,c);return h}F(f,g);var k=G(f);H(f,[{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}},{key:"getContainer",value:function(){return this.container}},
{key:"onClick",value:function(a){this.element&&this.getContainer()&&(this.onHoverStart(a),this.lockHoverElement())}},{key:"onDismiss",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.element&&(this.unlockHoverElement(),this.onHoverEnd(a))}},{key:"onHover",value:function(a){if(!this.isHovering)this.onHoverStart(a)}},{key:"onHoverStart",value:function(a){var b=this;if(this.loaded&&this.getContainer()){var c=this.cursorStyle||(this.mode===B.NORMAL?O.POINTER:O.DEFAULT),
e=this.scaleDownAnimation,d=this.scaleUpAnimation,f=this.element;this.isHovering=!0;this.container.style.cursor=c;setTimeout(function(){b.container.style.cursor=c},0);this.animated&&(e.stop(),d.start());f&&0<=a.mouseEvent.clientX&&0<=a.mouseEvent.clientY&&(a=f.left,e=f.right,d=f.style,this.mode===B.CARDBOARD||this.mode===B.STEREO?(d.display="none",a.style.display="block",e.style.display="block",f._width=a.clientWidth,f._height=a.clientHeight):(d.display="block",a&&(a.style.display="none"),e&&(e.style.display=
"none"),f._width=f.clientWidth,f._height=f.clientHeight))}}},{key:"onHoverEnd",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;if(this.getContainer()){var b=this.scaleDownAnimation,c=this.scaleUpAnimation,e=this.element;this.isHovering=!1;a&&(this.container.style.cursor=O.GRAB);this.animated&&(c.stop(),b.start());e&&!this.element.locked&&(a=e.left,b=e.right,e.style.display="none",a&&(a.style.display="none"),b&&(b.style.display="none"),this.unlockHoverElement())}}},
{key:"onDualEyeEffect",value:function(a){if(this.getContainer()){this.mode=a.mode;a=this.element;var b=this.container.clientWidth/2;var c=this.container.clientHeight/2;a&&(a.left||a.right||(a.left=a.cloneNode(!0),a.right=a.cloneNode(!0)),this.mode===B.CARDBOARD||this.mode===B.STEREO?(a.left.style.display=a.style.display,a.right.style.display=a.style.display,a.style.display="none"):(a.style.display=a.left.style.display,a.left.style.display="none",a.right.style.display="none"),this.translateElement(b,
c),this.container.append(a.left),this.container.append(a.right))}}},{key:"translateElement",value:function(a,b){if(this.element&&this.element._width&&this.element._height&&this.getContainer()){var c=this.container;var e=this.element;var d=e._width/2;var f=e._height/2;var g=void 0!==e.verticalDelta?e.verticalDelta:40;var k=a-d;var l=b-f-g;this.mode!==B.CARDBOARD&&this.mode!==B.STEREO||!e.left||!e.right||a===c.clientWidth/2&&b===c.clientHeight/2?this.setElementStyle("transform",e,"translate(".concat(k,
"px, ").concat(l,"px)")):(k=c.clientWidth/4-d+(a-c.clientWidth/2),l=c.clientHeight/2-f-g+(b-c.clientHeight/2),this.setElementStyle("transform",e.left,"translate(".concat(k,"px, ").concat(l,"px)")),k+=c.clientWidth/2,this.setElementStyle("transform",e.right,"translate(".concat(k,"px, ").concat(l,"px)")))}}},{key:"setElementStyle",value:function(a,b,c){b=b.style;"transform"===a&&(b.webkitTransform=b.msTransform=b.transform=c)}},{key:"setText",value:function(a){this.element&&(this.element.textContent=
a)}},{key:"setCursorHoverStyle",value:function(a){this.cursorStyle=a}},{key:"addHoverText",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',
this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b);this.setText(a)}},{key:"addHoverElement",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=a.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b)}},{key:"removeHoverElement",value:function(){if(this.element){var a;
if(this.element.left){var b;null===(b=this.container)||void 0===b?void 0:b.removeChild(this.element.left);this.element.left=null}if(this.element.right){var c;null===(c=this.container)||void 0===c?void 0:c.removeChild(this.element.right);this.element.right=null}null===(a=this.container)||void 0===a?void 0:a.removeChild(this.element);this.element=null}}},{key:"lockHoverElement",value:function(){this.element&&(this.element.locked=!0)}},{key:"unlockHoverElement",value:function(){this.element&&(this.element.locked=
!1)}},{key:"enableRaycast",value:function(){this.raycast=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)?this.originalRaycast:function(){}}},{key:"show",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=this.hideAnimation,e=this.showAnimation,d=this.material,f=this.maxOpacity;this.animated?(c.stop(),e.delay(b).onStart(function(){return a.visible=!0}).start()):(this.enableRaycast(!0),this.visible=!0,d.opacity=f)}},{key:"hide",value:function(){var a=
this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=this.hideAnimation,e=this.showAnimation,d=this.material;this.animated?(e.stop(),c.delay(b).start().onStart(function(){return a.visible=!1})):(this.enableRaycast(!1),this.visible=!1,d.opacity=0)}},{key:"setFocusMethod",value:function(a){a&&(this.HANDLER_FOCUS=a.method)}},{key:"focus",value:function(a,b){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,a,b),this.onDismiss())}},{key:"handleAlwaysShowTitle",value:function(a){if(this.showTitleHotspotInfospot){var b=
this.element;if(b){var c=b.left,e=b.right,d=b.style;a?(a&&""!==d.transform&&!this.isHiddenDuringTransition?(d.visibility="visible",d.display="block"):(d.display="block",d.visibility="hidden"),b._width=b.clientWidth,b._height=b.clientHeight):(d.display="none",c&&(c.style.display="none"),e&&(e.style.display="none"))}}}},{key:"onTransitionStart",value:function(){this.hide();this.isHiddenDuringTransition=!0}},{key:"onTransitionComplete",value:function(){this.show();this.isHiddenDuringTransition=!1}},
{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.removeHoverElement();this.parent&&this.parent.remove(this);c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}]);return f}(d.Sprite),Xa=function(g){function f(a){C(this,f);a=z({url:"/public/nadir/nadir-default.png",scale:1,rotation:0,altitude:-199,defaultOpacity:.25,defaultHoverOpacity:.35,rateOfIncrease:100,isDefault:null!==a&&void 0!==a&&a.url?!1:!0},a);var b=k.call(this,
f.createGeometry(a.rateOfIncrease,a.scale),f.createMaterial());b.options=a;b.RATE_OF_INCREASE=1E3;b.DEFAULT_OPACITY=.25;b.DEFAULT_HOVER_OPACITY=.35;b.DEFAULT_NUMBER_OF_SEGMENTS=64;b.url=b.options.url;b.ordinaryScale=b.options.scale;b.defaultOpacity=b.options.defaultOpacity;b.defaultHoverOpacity=b.options.defaultHoverOpacity;b.rateOfIncrease=b.options.rateOfIncrease;b.isDefault=b.options.isDefault;b.geometry=new d.PlaneGeometry(b.rateOfIncrease*b.ordinaryScale,b.rateOfIncrease*b.ordinaryScale);b.setNadirProportions=
function(a,b){var c=b.image;b=c.width;c=c.height;b>c&&a.scale(1,c/b,1);b<c&&a.scale(b/c,1,1)};b.material=new d.MeshBasicMaterial;(new d.TextureLoader).load(b.url,function(a){b.setNadirProportions(b.geometry,a);b.material.map=a;b.material.needsUpdate=!0});b.material.transparent=!0;b.material.side=d.DoubleSide;b.rotation.x=-Math.PI/2;b.rotation.y=Math.PI;b.rotation.z=b.options.rotation/180*Math.PI;b.position.y=b.options.altitude;b.type=A.NADIR;b.addEventListener("parallax-transition-start",b.onParallaxTransitionStart.bind(t(b)));
b.addEventListener("parallax-transition-complete",b.onParallaxTransitionComplete.bind(t(b)));return b}F(f,g);var k=G(f);H(f,[{key:"setIsDefault",value:function(a){this.isDefault=!0;this.material.opacity=.25;this.changeTexture(a)}},{key:"setIsNotDefault",value:function(){this.isDefault=!1;this.material.opacity=1}},{key:"changeScale",value:function(a){this.ordinaryScale=a;this.geometry=new d.PlaneGeometry(this.rateOfIncrease*this.ordinaryScale,this.rateOfIncrease*this.ordinaryScale);this.setNadirProportions(this.geometry,
this.material.map)}},{key:"changeRotation",value:function(a){this.rotation.z=a/180*Math.PI}},{key:"changeTexture",value:function(a){var b=this;(new d.TextureLoader).load(a,function(a){b.geometry=new d.PlaneGeometry(b.rateOfIncrease*b.ordinaryScale,b.rateOfIncrease*b.ordinaryScale);b.setNadirProportions(b.geometry,a);b.material.map=a;b.material.needsUpdate=!0},function(a){console.log("".concat(a.loaded/a.total*100,"% loaded"))},function(a){console.log("An error happened".concat(a))})}},{key:"hide",
value:function(){this.material.opacity=0}},{key:"show",value:function(){this.material.opacity=this.isDefault?this.defaultOpacity:1}},{key:"onParallaxTransitionStart",value:function(){this.hide()}},{key:"onParallaxTransitionComplete",value:function(){this.show()}}],[{key:"createGeometry",value:function(a,b){return new d.PlaneGeometry(a*b,a*b)}},{key:"createMaterial",value:function(){return new d.MeshBasicMaterial}}]);return f}(d.Mesh),Ya={tEquirect:{value:new d.Texture},repeat:{value:new d.Vector2(1,
1)},offset:{value:new d.Vector2(0,0)},opacity:{value:1}},T=function(g){function f(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f.createGeometry();var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f.createMaterial();C(this,f);a=k.call(this,a,b);a.type=q.PANORAMA;a.ImageQualityLow=1;a.ImageQualityFair=2;a.ImageQualityMedium=3;a.ImageQualityHigh=4;a.ImageQualitySuperHigh=5;a.animationDuration=1E3;a.defaultInfospotSize=350;a.container=void 0;a.loaded=!1;a.linkedSpots=[];a.isInfospotVisible=
!1;a.linkingImageURL=void 0;a.linkingImageScale=void 0;a.scale.x*=-1;a.renderOrder=-1;a.visible=!1;a.active=!1;a.infospotAnimation=(new u.Tween(t(a))).to({},a.animationDuration/2);a.addEventListener("panolens-container",a.setContainer.bind(t(a)));a.addEventListener("click",a.onClick.bind(t(a)));a.addEventListener("parallax-transition-start",a.onParallaxTransitionStart.bind(t(a)));a.addEventListener("parallax-transition-complete",a.onParallaxTransitionComplete.bind(t(a)));a.addEventListener("not-parallax-transition-start",
a.onNotParallaxTransitionStart.bind(t(a)));a.addEventListener("not-parallax-transition-complete",a.onNotParallaxTransitionComplete.bind(t(a)));a.setupTransitions();return a}F(f,g);var k=G(f);H(f,[{key:"add",value:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}a.type!==A.INFOSPOT&&a.subtype!==A.FLOOR_RING_INFOSPOT||this.dispatchInfospotListeners(a);r(v(f.prototype),"add",this).call(this,a);this.dispatchEvent({type:"addChild"})}},{key:"dispatchInfospotListeners",
value:function(a){var b=this.container;b&&a.dispatchEvent({type:"panolens-container",container:b});a.dispatchEvent({type:"panolens-infospot-focus",method:function(a,b,d){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[a,b,d]})}})}},{key:"getTexture",value:function(){return this.material.uniforms.tEquirect.value}},{key:"load",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.dispatchEvent({type:"load-start"});if(a)this.onLoad()}},
{key:"onClick",value:function(a){a.intersects&&0===a.intersects.length&&this.traverse(function(a){a.dispatchEvent({type:"dismiss"})})}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);if(b){var c=function(a){(a.type===A.INFOSPOT&&a.dispatchEvent||a.subtype===A.FLOOR_RING_INFOSPOT&&a.dispatchEvent)&&a.dispatchEvent({type:"panolens-container",container:b})};this.children.forEach(function(a){c(a);a.subtype===A.SPOT_MODEL&&a.children.forEach(function(a){return c(a)})});
this.container=b}}},{key:"onLoad",value:function(){this.loaded=!0;this.dispatchEvent({type:"loaded"});this.dispatchEvent({type:"ready"})}},{key:"onProgress",value:function(a){this.dispatchEvent({type:"progress",progress:a})}},{key:"onError",value:function(){this.dispatchEvent({type:"error"})}},{key:"getZoomLevel",value:function(){return 800>=window.innerWidth?this.ImageQualityFair:800<window.innerWidth&&1280>=window.innerWidth?this.ImageQualityMedium:1280<window.innerWidth&&1920>=window.innerWidth?
this.ImageQualityHigh:1920<window.innerWidth?this.ImageQualitySuperHigh:this.ImageQualityLow}},{key:"updateTexture",value:function(a){var b=this.material.uniforms.tEquirect.value.clone();this.material.uniforms.tEquirect.value=a;requestAnimationFrame(function(){return null===b||void 0===b?void 0:b.dispose()})}},{key:"toggleInfospotVisibility",value:function(a,b){var c=this;b=void 0!==b?b:0;var e=void 0!==a?a:!this.isInfospotVisible;this.traverse(function(a){if(a.type===A.INFOSPOT||a.subtype===A.FLOOR_RING_INFOSPOT)e?
a.show(b):a.hide(b)});this.isInfospotVisible=e;this.infospotAnimation.onComplete(function(){c.dispatchEvent({type:"infospot-animation-complete",visible:e})}).delay(b).start()}},{key:"reset",value:function(){this.children.length=0}},{key:"setupTransitions",value:function(){var a=this;this.fadeInAnimation=new u.Tween;this.fadeOutAnimation=new u.Tween;this.enterTransition=(new u.Tween(this)).easing(u.Easing.Quartic.Out).onComplete(function(){a.dispatchEvent({type:"enter-complete"})}).start();this.leaveTransition=
(new u.Tween(this)).easing(u.Easing.Quartic.Out)}},{key:"fadeIn",value:function(){var a,b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.animationDuration,e=(null===(a=this.material.uniforms)||void 0===a?void 0:a.opacity)||{value:0};this.fadeOutAnimation.stop();this.fadeInAnimation=(new u.Tween(e)).to({value:1},c).easing(u.Easing.Quartic.Out).onStart(function(){b.visible=!0;b.dispatchEvent({type:"enter-fade-start"})}).onComplete(function(){b.toggleInfospotVisibility(!0,c/2);b.dispatchEvent({type:"enter-fade-complete"})}).start()}},
{key:"fadeOut",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.animationDuration,b=this.material.uniforms.opacity,c=function(){this.visible=!1;this.dispatchEvent({type:"leave-complete"})}.bind(this);this.fadeInAnimation.stop();this.fadeOutAnimation=(new u.Tween(b)).to({value:0},a).easing(u.Easing.Quartic.Out).onComplete(c).start()}},{key:"onEnter",value:function(){var a=this,b=this.animationDuration;this.dispatchEvent({type:"enter"});this.leaveTransition.stop();
this.enterTransition.to({},b).onStart(function(){a.dispatchEvent({type:"enter-start"});a.loaded?a.dispatchEvent({type:"ready"}):a.load()}).start();this.children.forEach(function(a){a.dispatchEvent({type:"panorama-enter"});a.subtype===A.SPOT_MODEL&&a.children.forEach(function(a){return a.dispatchEvent({type:"panorama-enter"})})});this.active=!0}},{key:"onLeave",value:function(){var a=this,b=this.animationDuration;this.enterTransition.stop();this.leaveTransition.to({},b).onStart(function(){a.dispatchEvent({type:"leave-start"});
a.fadeOut(b);a.toggleInfospotVisibility(!1)}).start();this.dispatchEvent({type:"leave"});this.traverse(function(a){return a.dispatchEvent({type:"panorama-leave"})});this.active=!1}},{key:"onParallaxTransitionComplete",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"parallax-transition-complete"})})}},{key:"onParallaxTransitionStart",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"parallax-transition-start"})})}},
{key:"onNotParallaxTransitionComplete",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"not-parallax-transition-complete"})})}},{key:"onNotParallaxTransitionStart",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"not-parallax-transition-start"})})}},{key:"dispose",value:function(){function a(b){for(var c=b.geometry,d=b.material,f=b.type,g=b.subtype,k=b.children.length-1;0<=k;k--)a(b.children[k]),
b.remove(b.children[k]);f!==A.INFOSPOT&&g!==A.FLOOR_RING_INFOSPOT&&g!==A.SPOT_MODEL||b.dispose();null!==c&&void 0!==c&&c.dispose&&(c.dispose(),b.geometry=null);null!==d&&void 0!==d&&d.dispose&&(d.dispose(),b.material=null)}var b=this.material;b&&b.uniforms&&b.uniforms.tEquirect&&b.uniforms.tEquirect.value.dispose();this.infospotAnimation.stop();this.fadeInAnimation.stop();this.fadeOutAnimation.stop();this.enterTransition.stop();this.leaveTransition.stop();this.dispatchEvent({type:"panolens-viewer-handler",
method:"onPanoramaDispose",data:this});a(this);this.parent&&this.parent.remove(this)}}],[{key:"createGeometry",value:function(){return new d.SphereBufferGeometry(5050,100,80)}},{key:"createMaterial",value:function(){var a=d.UniformsUtils.clone(Ya);a.repeat.value.copy(new d.Vector2(1,1));a.offset.value.copy(new d.Vector2(0,0));a.opacity.value=0;return new d.ShaderMaterial({fragmentShader:"\n        uniform sampler2D tEquirect;\n        uniform vec2 repeat;\n        uniform vec2 offset;\n        uniform float opacity;\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vec3 direction = normalize( vWorldDirection );\n            vec2 sampleUV;\n            sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n            sampleUV.x = atan( -direction.z, -direction.x ) * RECIPROCAL_PI2 + 0.5;\n            sampleUV *= repeat;\n            sampleUV += offset;\n            sampleUV.x = fract(sampleUV.x);\n            sampleUV.y = fract(sampleUV.y);\n            gl_FragColor = vec4(texture2D( tEquirect, sampleUV ).rgb, opacity);\n        }\n    ",
vertexShader:"\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vWorldDirection = transformDirection( position, modelMatrix );\n            #include <begin_vertex>\n            #include <project_vertex>\n        }\n    ",uniforms:a,side:d.BackSide,transparent:!0})}}]);return f}(d.Mesh),sa=function(g){function f(a,b,c){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};C(this,f);var d=k.call(this,b,c);d.subtype=q.IMAGE;d.options=z({onInitialLoadedFinished:function(){}},
e);d.src=a;d.floorPlane=null;return d}F(f,g);var k=G(f);H(f,[{key:"load",value:function(a){r(v(f.prototype),"load",this).call(this,!1);a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)V.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new d.Texture(a))}},{key:"onLoad",value:function(a){a.minFilter=d.LinearFilter;a.magFilter=d.LinearFilter;a.needsUpdate=!0;this.updateTexture(a);
window.requestAnimationFrame(r(v(f.prototype),"onLoad",this).bind(this));window.requestAnimationFrame(this.options.onInitialLoadedFinished)}},{key:"add",value:function(a){if(1<arguments.length){var b=la(arguments),c;try{for(b.s();!(c=b.n()).done;)this.add(c.value)}catch(e){b.e(e)}finally{b.f()}return this}a instanceof R&&(this.floorPlane=a);r(v(f.prototype),"add",this).call(this,a)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof R||(this.floorPlane=new R,this.add(this.floorPlane))}},
{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof R&&(this.floorPlane.dispose(),this.floorPlane=null)}},{key:"dispose",value:function(){d.Cache.remove(this.src);this.floorPlane=null;r(v(f.prototype),"dispose",this).call(this)}}]);return f}(T),Za=function(g){function f(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,f);var c=k.call(this,f.createGeometry(),f.createMaterial());c.options=z({},b);c.container=a;c.passThrough=!0;c.subtype=S.SPOT_SPHERE;
return c}F(f,g);var k=G(f);H(f,[{key:"dispose",value:function(){var a=this.geometry,b=this.material;a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new d.SphereBufferGeometry(5050,8,4)}},{key:"createMaterial",value:function(){var a=new d.MeshBasicMaterial({color:302836,transparent:!0,opacity:0});a.side=d.BackSide;return a}}]);return f}(d.Mesh),ta={tilesByEdge:1,level:0,prefix:"low"},aa={tilesByEdge:2,level:1,prefix:"med"},ua=
{tilesByEdge:4,level:2,prefix:"high"},$a="px nx py ny pz nz".split(" "),Ja=new d.Frustum,Ka=new d.Matrix4,va=new d.Vector3,ab=function(g){function f(a){var b=a.blob,c=a.tileSourceFolder,e=a.qualityLevel,h=a.renderer,g=a.camera;C(this,f);a=k.call(this,f.createGeometry(),f.createMaterial());a.subtype=q.PROGRESSVIE_IMAGE;a.srcTexture=new d.Texture(b);a.tileSourceFolder=c;a.renderer=h;a.camera=g;a.spotModel=new Za(a.container);a.spotModel.position.set(0,0,0);a.add(a.spotModel);a.tilesUploadingToGPU=0;
a.tilesByEdge=null;a.segmentsByTile=null;a.renderedTiles=0;a.currentQuality=e===ta.level?ta:aa;a.maxQualityLevel=e;a._calculateTilesAndFaces(a.currentQuality);a.queue=new Map;a.loader=new d.ImageBitmapLoader;a.loader.setOptions({imageOrientation:"flipY"});a.floorPlane=null;a.addEventListener("fov",a._handleFovChange);return a}F(f,g);var k=G(f);H(f,[{key:"onLoad",value:function(){r(v(f.prototype),"onLoad",this).call(this);this._setTexture(this.srcTexture);this.geometry.setAttribute("uv",this.geometry.getAttribute("originaluv").clone());
this.previewTextureLoaded=!0}},{key:"refresh",value:function(){if(!(3<=this.tilesUploadingToGPU)&&this.geometry&&this.previewTextureLoaded){this.camera.updateMatrixWorld();Ka.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse);Ja.setFromProjectionMatrix(Ka);for(var a=this.geometry.getAttribute("position"),b=[],c=0;6>c;c++)for(var e=0;e<this.tilesByEdge;e++)for(var f=0;f<this.tilesByEdge;f++){var g=[],m=384*c+e*this.segmentsByTile*48+f*this.segmentsByTile*6,k=m+48*(this.segmentsByTile-
1)+1;g.push(m,k,k+6*this.segmentsByTile-3,m+6*this.segmentsByTile-1);if(4<=this.segmentsByTile){var l=m+48*(this.segmentsByTile/2-1)+1;g.push(m+this.segmentsByTile/2*6-1,k+this.segmentsByTile/2*6-3,l,l+6*this.segmentsByTile-3,l+this.segmentsByTile/2*6)}g.some(function(b){va.set(-a.getX(b),a.getY(b),a.getZ(b));return Ja.containsPoint(va)})&&(g=new d.Vector3(-1,0,0),g=va.angleTo(g),b.push({face:c,col:f,row:e,angle:g,level:this.currentQuality.level}))}this._loadTiles(b)}}},{key:"_handleFovChange",value:function(){60>
this.camera.fov&&this.currentQuality.level<=aa.level?this.maxQualityLevel<ua.level||(this.currentQuality=ua,this._calculateTilesAndFaces(ua)):75>this.camera.fov&&this.currentQuality.level<=ta.level&&!(this.maxQualityLevel<aa.level)&&(this.currentQuality=aa,this._calculateTilesAndFaces(aa))}},{key:"_calculateTilesAndFaces",value:function(a){this.tilesByEdge=a=a.tilesByEdge;this.segmentsByTile=8/a}},{key:"_setTexture",value:function(a){var b=this.geometry.getAttribute("uv");a?(a.needsUpdate=!0,a=new d.MeshBasicMaterial({map:a,
side:d.BackSide})):a=new d.MeshBasicMaterial({opacity:0,transparent:!0});for(var c=0;384>c;c++)this.material.push(a);b.needsUpdate=!0}},{key:"_loadTiles",value:function(a){var b=this;a.forEach(function(a){setTimeout(Ma(regeneratorRuntime.mark(function h(){var c,d;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:c=b._tileId(a);d=b.queue.get(c);if(null===d||void 0===d||!d.uploaded){f.next=4;break}return f.abrupt("return");case 4:if(!d){f.next=8;break}b.queue.set(c,z(z({},
d),{},{priority:a.angle}));f.next=11;break;case 8:return b.queue.set(c,{priority:a.angle,uploaded:!1}),f.next=11,b._loadTile(a);case 11:case "end":return f.stop()}},h)})))})}},{key:"_tileUrl",value:function(a,b,c){var e=this.tileSourceFolder;b="00".concat(c*this.currentQuality.tilesByEdge+b).slice(-2);return"".concat(e,"/").concat(this.currentQuality.prefix,"-").concat(a,"-").concat(b,".jpg")}},{key:"_tileId",value:function(a){return"".concat(a.level,"-").concat(a.face,":").concat(a.col,"-").concat(a.row,
"111")}},{key:"_loadTile",value:function(a){var b=this;this.renderedTiles++;var c=this._tileUrl($a[a.face],a.col,a.row);this.tilesUploadingToGPU+=1;return(new Promise(function(a,d){b.loader.load(c,a,void 0,d)})).then(function(c){setTimeout(function(){--b.tilesUploadingToGPU;var e=new d.Texture(c);e.minFilter=e.magFilter=d.LinearFilter;b.renderer.initTexture(e);e.needsUpdate=!0;e=new d.MeshBasicMaterial({map:e,side:d.BackSide});b._swapMaterial(a.face,a.col,a.row,e);b.queue.set(b._tileId(a),{uploaded:!0})},
0)})["catch"](function(){--b.tilesUploadingToGPU})}},{key:"_swapMaterial",value:function(a,b,c,e){for(var d=this,f=this.geometry.getAttribute("uv"),g=0;g<this.segmentsByTile;g++)for(var k=function(h){var m=384*a+6*(8*(c*d.segmentsByTile+g)+(b*d.segmentsByTile+h)),l=d.geometry.groups.find(function(a){return a.start===m}).materialIndex;e.map.needsUpdate=!0;e.needsUpdate=!0;d.material[l]=e;d.material.needsUpdate=!0;l=1-g/d.segmentsByTile;var k=1-(g+1)/d.segmentsByTile,x=h/d.segmentsByTile;h=(h+1)/d.segmentsByTile;
f.setXY(m,x,l);f.setXY(m+1,x,k);f.setXY(m+2,h,l);f.setXY(m+3,x,k);f.setXY(m+4,h,k);f.setXY(m+5,h,l)},l=0;l<this.segmentsByTile;l++)k(l);f.needsUpdate=!0}},{key:"handleEndOfTransition",value:function(){this.loadOtherTiles();this.removeEventListener("preview-texture-ready",this.handleEndOfTransition)}},{key:"dispose",value:function(){delete this.srcTexture;delete this.loader;this.tilesUploadingToGPU=null;this.material.forEach(function(a){var b;null===a||void 0===a?void 0:null===(b=a.map)||void 0===
b?void 0:b.dispose()});this.material.length=0;r(v(f.prototype),"dispose",this).call(this)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane.subtype===S.FLOOR_PLANE||(this.floorPlane=new R,this.add(this.floorPlane))}},{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane.subtype===S.FLOOR_PLANE&&(this.floorPlane.dispose(),this.floorPlane=null)}}],[{key:"createMaterial",value:function(){return[]}},{key:"createGeometry",value:function(){var a=(new d.BoxBufferGeometry(12E3,
12E3,12E3,8,8,8)).toNonIndexed();a.clearGroups();for(var b=0,c=0;2304>b;b+=6)a.addGroup(b,6,c++);b=a.attributes.position.array;c=a.attributes.uv.array;for(var e=0;e<b.length/3;e++){var f=b[3*e]/6E3,g=b[3*e+1]/6E3,m=b[3*e+2]/6E3,k=Math.sqrt(1/(Math.pow(f,2)+Math.pow(g,2)+Math.pow(m,2)));f*=k;g*=k;m*=k;k=Math.asin(g);g=Math.atan2(f,m);0===f&&0>m&&(f=Math.floor(e/3),0>b[9*f]||0>b[9*(f+1)]||0>b[9*(f+2)])&&(g=-Math.PI);f=(k+Math.PI/2)/Math.PI;c[2*e]=(.5+(g+Math.PI)/(2*Math.PI))%1;c[2*e+1]=f}a.rotateY(-Math.PI/
2);a.setAttribute("originaluv",a.getAttribute("uv").clone());return a}}]);return f}(T),bb=function(g){function f(){C(this,f);var a=new d.BufferGeometry,b=new d.MeshBasicMaterial({color:0,opacity:0,transparent:!0});a.addAttribute("position",new d.BufferAttribute(new Float32Array,1));return k.call(this,a,b)}F(f,g);var k=G(f);return f}(T),cb=function(d){function f(){C(this,f);var a=[];for(var b=0;6>b;b++)a.push(J.WhiteTile);a=g.call(this,a);a.type=q.BASIC;return a}F(f,d);var g=G(f);return f}(function(g){function f(){var a=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];C(this,f);var b=k.call(this,null,f.createMaterial());b.images=a;b.type=q.CUBE;return b}F(f,g);var k=G(f);H(f,[{key:"load",value:function(){r(v(f.prototype),"load",this).call(this,!1);Ea.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))}},{key:"onLoad",value:function(a){this.material.uniforms.tCube.value=a;r(v(f.prototype),"onLoad",this).call(this)}},{key:"getTexture",value:function(){return this.material.uniforms.tCube.value}},
{key:"dispose",value:function(){var a=this.material.uniforms.tCube.value;this.images.forEach(function(a){d.Cache.remove(a)});a instanceof d.CubeTexture&&a.dispose();r(v(f.prototype),"dispose",this).call(this)}}],[{key:"createMaterial",value:function(){var a=d.ShaderLib.cube,b=a.fragmentShader,c=a.vertexShader;a=d.UniformsUtils.clone(a.uniforms);a.opacity.value=0;return new d.ShaderMaterial({fragmentShader:b,vertexShader:c,uniforms:a,side:d.BackSide,transparent:!0,opacity:0})}}]);return f}(T)),La=
{tEquirect:{value:new d.Texture},repeat:{value:new d.Vector2(1,1)},offset:{value:new d.Vector2(0,0)},opacity:{value:1}},db=function(g){function f(a){C(this,f);var b=k.call(this,f.createGeometry(),f.createMaterial());b.subtype=q.SLIDER;b.desiredWidth=null;b.desiredHeight=null;b.desiredPosition=new d.Vector3(0,0,-2);b.src=a.url;b.backgroundMode=Y.DEFAULT;return b}F(f,g);var k=G(f);H(f,[{key:"hide",value:function(){}},{key:"load",value:function(a){a=a||this.src;if(!a)console.warn("Image source undefined");
else if("string"===typeof a)V.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new d.Texture(a))}},{key:"onLoad",value:function(a){a.minFilter=d.LinearMipmapNearestFilter;a.magFilter=d.LinearFilter;a.needsUpdate=!0;this.desiredWidth=a.image.width;this.desiredHeight=a.image.height;this.container.children[0].style.backgroundImage="url(".concat(this.src,")");this.container.children[0].style.backgroundPosition="center";
this.container.children[0].style.backgroundSize=this.backgroundMode===Y.COLOR?"1%":"cover";this.updateTexture(a);window.requestAnimationFrame(r(v(f.prototype),"onLoad",this).bind(this))}},{key:"reset",value:function(){r(v(f.prototype),"reset",this).call(this)}},{key:"dispose",value:function(){if(this.material){var a=this.material.map;a&&a.dispose()}d.Cache.remove(this.src);r(v(f.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(){return new d.PlaneBufferGeometry(1,1)}},
{key:"createMaterial",value:function(){var a=d.UniformsUtils.clone(La);a.repeat.value.copy(new d.Vector2(1,1));a.offset.value.copy(new d.Vector2(0,0));a.opacity.value=0;return new d.ShaderMaterial({fragmentShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ",
vertexShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ",uniforms:a,side:d.FrontSide,transparent:!0})}}]);return f}(T),W=window.navigator.userAgent||window.navigator.vendor||window.opera,eb=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(W)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(W.substr(0,
4)),ha=/(android)/i.test(W),fb=/^((?!chrome|android).)*safari/i.test(W),ia={xl:1200,lg:992,lgm:812,md:768,mdm:680,sm:576,smm:550,xs:450,xsm:375,xxs:320};Object.keys(ia).reduce(function(d,f){d[f]="min-width: ".concat(ia[f],"px");return d},{});Object.keys(ia).reduce(function(d,f){d[f]="max-width: ".concat(ia[f]-.02,"px");return d},{});var ja=function(g){function f(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,f);var c=k.call(this);var e=document.createElement("video");c.src=
a;c.isHls=!1;c.safeHls=P||window.Hls;c.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);"m3u8"!==a.slice(-4)||fb||(c.safeHls&&c.safeHls.isSupported()?(e.title=a,c.hls=new c.safeHls({liveSyncDuration:1}),c.hls.loadSource(a),c.hls.attachMedia(e),c.setupHlsListeners(),c.isHls=!0):!e.canPlayType("application/vnd.apple.mpegurl")&&b.originSrc&&(c.src=b.originSrc));c.options=z({videoElement:e,loop:!0,muted:!0,autoplay:!1,playsinline:!0,crossOrigin:"anonymous",
onInitialLoadedFinished:function(){}},b);c.videoElement=c.options.videoElement;c.videoProgress=0;c.maxDuration=b.maxDuration;c.subtype=q.VIDEO;c.floorPlane=null;c.firstToggleAudioBind=null;c.firstClickOnAudioButton=null;c.addEventListener("leave",c.pauseVideo.bind(t(c)));c.addEventListener("enter-fade-start",c.resumeVideoProgress.bind(t(c)));c.addEventListener("video-toggle",c.toggleVideo.bind(t(c)));c.addEventListener("video-time",c.setVideoCurrentTime.bind(t(c)));return c}F(f,g);var k=G(f);H(f,
[{key:"setupHlsListeners",value:function(){var a=this;this.hls.on(this.safeHls.Events.LEVEL_UPDATED,function(b){a.qualityLevel=b.data.level})}},{key:"load",value:function(){var a=this;r(v(f.prototype),"load",this).call(this,!1);var b=this.options,c=b.muted,e=b.loop,d=b.autoplay,g=b.playsinline,m=b.crossOrigin,k=b.maxDuration,l=this.videoElement,p=this.onProgress.bind(this),n=this.onLoad.bind(this);this.maxDuration=k||60;l.loop=e;l.autoplay=d;l.playsinline=g;l.crossOrigin=m;l.muted=c;g&&(l.setAttribute("playsinline",
""),l.setAttribute("webkit-playsinline",""));b=function(){var a,b=this,e=this.setVideoTexture(l);d&&this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1});c||this.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoSound"});eb&&(l.pause(),d&&c?this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}));window.requestAnimationFrame(function(){setTimeout(function(){p({loaded:1,
total:1});n(e)},1E3)});window.requestAnimationFrame(this.options.onInitialLoadedFinished);var f=(null===(a=this.videoElement.audioTracks)||void 0===a?void 0:a.length)||0<this.videoElement.webkitAudioDecodedByteCount,h=document.getElementById(fa.VIDEO_SOUND_BUTTON);f?(this.firstToggleAudioBind=this.firstToggleAudio.bind(this),this.firstClickOnAudioButton=function(a){return b.firstToggleAudioBind(a,!0)},h.addEventListener("click",this.firstClickOnAudioButton,{once:!0}),h.addEventListener("touchend",
this.firstClickOnAudioButton,{once:!0}),document.addEventListener("click",this.firstToggleAudioBind,{once:!0}),document.addEventListener("keydown",this.firstToggleAudioBind,{once:!0}),document.addEventListener("touchend",this.firstToggleAudioBind,{once:!0})):(h.isDisabled=!0,h.style.cursor="not-allowed",h.addEventListener(this.TOUCH_ENABLED?"touchstart":"mouseenter",function(){h.style.filter=h.style.webkitFilter="unset"},{passive:!0}))};2<l.readyState?b.call(this):(0===l.querySelectorAll("source").length&&
(g=document.createElement("source"),g.src=this.src,l.append(g)),l.load());l.addEventListener("loadeddata",b.bind(this));l.addEventListener("timeupdate",function(){a.isBuffering=!1;a.videoProgress=0<=l.duration?l.currentTime/a.maxDuration||l.duration:0;k&&l.currentTime>=a.maxDuration&&(l.currentTime=0);a.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:{percentage:a.videoProgress,quality:a.qualityLevel}})});l.addEventListener("ended",function(){e||(a.resetVideo(),a.dispatchEvent({type:"panolens-viewer-handler",
method:"updateVideoPlayButton",data:!0}))},!1)}},{key:"firstToggleAudio",value:function(a,b){b||(document.getElementById(fa.VIDEO_SOUND_BUTTON).update(!0),this.unmuteVideo());document.removeEventListener("click",this.firstToggleAudioBind);document.removeEventListener("keydown",this.firstToggleAudioBind);document.removeEventListener("touchend",this.firstToggleAudioBind)}},{key:"onLoad",value:function(){r(v(f.prototype),"onLoad",this).call(this);this.maxDuration=Math.min(this.maxDuration,this.videoElement.duration)}},
{key:"setVideoTexture",value:function(a){if(a)return a=new d.VideoTexture(a),a.minFilter=d.LinearFilter,a.magFilter=d.LinearFilter,a.format=d.RGBFormat,this.updateTexture(a),a}},{key:"reset",value:function(){this.videoElement=void 0;r(v(f.prototype),"reset",this).call(this)}},{key:"isVideoPaused",value:function(){return this.videoElement.paused}},{key:"toggleVideo",value:function(a){var b=this.videoElement;if(b)if(a.toggleMute)b&&this.isVideoMuted()?this.unmuteVideo():this.muteVideo();else b[b.paused?
"play":"pause"]()}},{key:"setVideoCurrentTime",value:function(a){a=a.percentage;var b=this.videoElement;b&&!Number.isNaN(a)&&1!==a&&(b.currentTime=this.maxDuration*a,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:a}))}},{key:"playVideo",value:function(){var a=this.videoElement,b=this.playVideo.bind(this),c=this.dispatchEvent.bind(this),e=function(){c({type:"play"})},d=function(a){window.requestAnimationFrame(b);c({type:"play-error",error:a})};if(a&&a.paused)a.play().then(e)["catch"](d)}},
{key:"pauseVideo",value:function(){var a=this.videoElement;a&&!a.paused&&a.pause();this.hls&&this.hls.stopLoad();this.dispatchEvent({type:"pause"});this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})}},{key:"resumeVideoProgress",value:function(){var a=this.videoElement;4<=a.readyState&&a.autoplay&&!this.isMobile?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",
method:"updateVideoPlayButton",data:!0}));this.setVideoCurrentTime({percentage:this.videoProgress})}},{key:"resetVideo",value:function(){this.videoElement&&this.setVideoCurrentTime({percentage:0})}},{key:"isVideoMuted",value:function(){return this.videoElement.muted}},{key:"muteVideo",value:function(){this.videoElement.muted=!0;this.dispatchEvent({type:"volumechange"})}},{key:"unmuteVideo",value:function(){this.videoElement.muted=!1;this.dispatchEvent({type:"volumechange"})}},{key:"getVideoElement",
value:function(){return this.videoElement}},{key:"add",value:function(a){a instanceof R&&(this.floorPlane=a);r(v(f.prototype),"add",this).call(this,a)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof R||(this.floorPlane=new R,this.add(this.floorPlane))}},{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof R&&(this.floorPlane.dispose(),this.floorPlane=null)}},{key:"dispose",value:function(){this.pauseVideo();this.removeEventListener("leave",
this.pauseVideo);this.removeEventListener("enter-fade-start",this.resumeVideoProgress);this.removeEventListener("video-toggle",this.toggleVideo);this.removeEventListener("video-time",this.setVideoCurrentTime);this.floorPlane=null;r(v(f.prototype),"dispose",this).call(this)}}]);return f}(T),ba={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:0},threshold:{value:.3},useTexture:{value:0},tMixTexture:{value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform float mixRatio;\nuniform sampler2D tDiffuse1;\nuniform sampler2D tDiffuse2;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texel1 = texture2D( tDiffuse1, vUv );\n\tvec4 texel2 = texture2D( tDiffuse2, vUv );\n\tif (useTexture==1) {\n\t\tvec4 transitionTexel = texture2D( tMixTexture, vUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\tgl_FragColor = mix( texel2, texel1, mixRatio );\n\t}\n}"};
ma.prototype={constructor:ma};var K={CROSSFADE:{id:0,label:"Crossfade",value:"crossfade",settings:{useTexture:!1,texture:3,transitionSpeed:-3,smoothstep:{start:.3,end:.7}}},PERLIN:{id:1,label:"Perlin",value:"perlin",settings:{useTexture:!0,texture:1,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},SQUARES:{id:2,label:"Squares",value:"squares",settings:{useTexture:!0,texture:2,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},CELLS:{id:3,label:"Cells",value:"cells",settings:{useTexture:!0,texture:3,
transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},DISTORT:{id:4,label:"Distort",value:"distort",settings:{useTexture:!0,texture:4,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},GRADIENT:{id:5,label:"Gradient",value:"gradient",settings:{useTexture:!0,texture:5,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},RADIAL:{id:6,label:"Radial",value:"radial",settings:{useTexture:!0,texture:6,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},PARALLAX:{id:7,label:"Parallax",value:"parallax",settings:{useTexture:!1,
texture:3,transitionSpeed:-3,smoothstep:{start:.45,end:.99}}},NONE:{id:8,label:"None",value:"none",settings:{useTexture:!1,texture:0,transitionSpeed:-1E4,smoothstep:{start:.3,end:.7}}}},wa=function(g){function f(a,b,c,e){var h,g,m=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1;C(this,f);var p=k.call(this);p.renderCount=0;p.fromScene=a;p.toScene=b;p.renderer=c;p.transitionParams=e;p.isInitiatorInfospot=m;p.clock=new d.Clock;p.transition=1;p.transitionScene=new d.Scene;p.cameraOrtho=new d.OrthographicCamera(window.innerWidth/
-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-10,10);p.updateParams(e);m=new d.TextureLoader;p.texture=m.load("/public/panolens/textures/transition/transition".concat(p.transitionParams.texture,".png"));p.quadmaterial=new ma(p.transitionParams,p.texture);m=new d.PlaneBufferGeometry(window.innerWidth,window.innerHeight);p.quad=new d.Mesh(m,p.quadmaterial);p.transitionScene.add(p.quad);m=function(){p.quadmaterial.uniforms.tDiffuse1.value=a.fbo.texture};var l=function(){p.quadmaterial.uniforms.tDiffuse2.value=
b.fbo.texture};if(null!==a&&void 0!==a&&null!==(h=a.panorama)&&void 0!==h&&h.loaded)m();else{var q;null===a||void 0===a?void 0:null===(q=a.panorama)||void 0===q?void 0:q.addEventListener("ready",m)}if(null!==b&&void 0!==b&&null!==(g=b.panorama)&&void 0!==g&&g.loaded)l();else{var n;null===b||void 0===b?void 0:null===(n=b.panorama)||void 0===n?void 0:n.addEventListener("ready",l)}return p}F(f,g);var k=G(f);H(f,[{key:"getTypeList",value:function(){return Object.keys(K).map(function(a){return z({},K[a])}).sort(function(a,
b){return a.id-b.id})}},{key:"getTypeRelatedParameters",value:function(a){switch(a){case K.PERLIN.value:return z({},K.PERLIN.settings);case K.SQUARES.value:return z({},K.SQUARES.settings);case K.CELLS.value:return z({},K.CELLS.settings);case K.DISTORT.value:return z({},K.DISTORT.settings);case K.GRADIENT.value:return z({},K.GRADIENT.settings);case K.RADIAL.value:return z({},K.RADIAL.settings);case K.PARALLAX.value:return z({},K.PARALLAX.settings);case K.NONE.value:return z({},K.NONE.settings);default:return z({},
K.CROSSFADE.settings)}}},{key:"updateParams",value:function(a){var b=this.getTypeRelatedParameters((null===a||void 0===a?void 0:a.type)||K.CROSSFADE.value);this.transitionParams=z(z(z({textureThreshold:.3},K.CROSSFADE.settings),a),b)}},{key:"execute",value:function(){this.transitionParams.animateTransition=!0;var a="parallax"===this.transitionParams.type;if(!a&&this.fromScene){var b,c,e=this.fromScene,d=this.toScene;null===e||void 0===e?void 0:null===(b=e.panorama)||void 0===b?void 0:b.dispatchEvent({type:"not-parallax-transition-start"});
null===d||void 0===d?void 0:null===(c=d.panorama)||void 0===c?void 0:c.dispatchEvent({type:"not-parallax-transition-start"})}a&&this.isInitiatorInfospot&&this.toScene.panorama.subtype!==q.SLIDER&&this.toScene.panorama.subtype!==q.SPIN&&(!this.fromScene||this.fromScene.panorama.subtype!==q.SLIDER&&this.fromScene.panorama.subtype!==q.SPIN)&&this.parallax()}},{key:"destroy",value:function(){this.toScene.destroy();this.fromScene.destroy()}},{key:"parallax",value:function(){var a=this.fromScene,b=this.toScene;
if(a){var c=a.lastTouch.scene||{x:0,y:0,z:0},e=a.camera.position,f=new d.Vector3;f.subVectors(e,c).normalize();e=new d.Vector3;a.camera.getWorldDirection(e);(new d.Vector3).subVectors(e,c.clone().normalize());c=f.multiply(new d.Vector3(-1,0,1));e=new d.Vector3;e=b.control.getRotations().h-a.control.getRotations().h;e=f.clone().applyAxisAngle(new d.Vector3(0,1,0),e).normalize();f=e.clone();e=b.panorama.position.clone();c=(new u.Tween(a.panorama.position)).to({x:2E3*c.x,y:2E3*c.y,z:2E3*c.z},1500).easing(u.Easing.Cubic.Out);
b.panorama.position.set(-2E3*f.x,f.y,-2E3*f.z);b.panorama.position.needsUpdate=!0;f=(new u.Tween(b.panorama.position)).to({x:e.x,y:e.y,z:e.z},1500).easing(u.Easing.Cubic.Out);c.start().onStart(function(){var b;null===a||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"parallax-transition-start"})}).onComplete(function(){var b;null===a||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"parallax-transition-complete"})});f.start().onStart(function(){var a;
null===b||void 0===b?void 0:null===(a=b.panorama)||void 0===a?void 0:a.dispatchEvent({type:"parallax-transition-start"})}).onComplete(function(){var a;null===b||void 0===b?void 0:null===(a=b.panorama)||void 0===a?void 0:a.dispatchEvent({type:"parallax-transition-complete"})})}}},{key:"render",value:function(){var a=this.cameraOrtho,b=this.clock,c=this.quadmaterial,e=this.renderer,f=this.transitionParams,g=this.transitionScene;if(null===this.fromScene){var m,k;a=null!==(m=f.controlEnabled)&&void 0!==
m?m:!0;this.toScene.render(!1);null!==(k=this.toScene)&&void 0!==k&&k.control&&(this.toScene.control.enabled=a);f.animateTransition=!1}else if(f.animateTransition&&(m=1+Math.sin(f.transitionSpeed*b.getElapsedTime()/Math.PI),this.transition=d.Math.smoothstep(m,f.smoothstep.start,f.smoothstep.end)),c.uniforms.mixRatio.value=this.transition,0===this.transition){var l,p,n;a=f&&(f.controlEnabled||!1===f.controlEnabled)?f.controlEnabled:!0;this.toScene.render(!1);null!==(l=this.toScene)&&void 0!==l&&l.control&&
(this.toScene.control.enabled=a);null!==(p=this.fromScene)&&void 0!==p&&p.control&&(this.fromScene.control.enabled=!1);f.animateTransition=!1;if("parallax"!==this.transitionParams.type&&this.fromScene){var q,w;null===(q=this.toScene)||void 0===q?void 0:null===(w=q.panorama)||void 0===w?void 0:w.dispatchEvent({type:"not-parallax-transition-complete"})}null===(n=this.fromScene)||void 0===n?void 0:n.destroy();this.fromScene=null;this.dispatchEvent({type:"transition-complete"})}else if(1===this.transition){var r,
t;f=f&&(f.controlEnabled||!1===f.controlEnabled)?f.controlEnabled:!0;this.fromScene.render(!1);null!==(r=this.toScene)&&void 0!==r&&r.control&&(this.toScene.control.enabled=f);null!==(t=this.fromScene)&&void 0!==t&&t.control&&(this.fromScene.control.enabled=f)}else{var u,v;f=f&&(f.controlEnabled||!1===f.controlEnabled)?f.controlEnabled:!0;this.fromScene.render(!0);this.toScene.render(!0);null!==(u=this.toScene)&&void 0!==u&&u.control&&(this.toScene.control.enabled=f);null!==(v=this.fromScene)&&void 0!==
v&&v.control&&(this.fromScene.control.enabled=f);e.setRenderTarget(null);e.clear();e.clearDepth();e.render(g,a)}}}]);return f}(d.EventDispatcher);W=function(g){function f(a){C(this,f);var b=k.call(this);var c="100%",e="100%";a&&a.container&&a.container.style&&(c=a.container.style.width||"100%",e=a.container.style.height||"100%");var h=a&&a.container?a.container:document.createElement("div");h.classList.add("panolens-container");h.style.width=c;h.style.height=e;h._width=window.innerWidth;h._height=
window.innerHeight;a&&a.container||document.body.append(h);b.container=h;b.options=z({container:b.container,autoHideInfospot:!0,horizontalView:!1,controlBar:!1,controlButtons:[],autoHideControlBar:!0,clickTolerance:10,cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,disableZoomInIframe:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new d.Vector3(0,0,-Number.MAX_SAFE_INTEGER),cameraInitialLookAt:null,
momentum:!0,rotateSpeed:-1,dampingFactor:.1,defaultFov:60,controlEnabled:!0,horizontalViewLimit:!1,horizontalViewDownLimitDegrees:0,horizontalViewUpLimitDegrees:180},a);a=window.devicePixelRatio;c=!0;1<a&&(c=!1);b.renderer=new d.WebGLRenderer({antialias:c,alpha:!0,powerPreference:"high-performance"});b.renderer.setPixelRatio(a);b.renderer.setSize(window.innerWidth,window.innerHeight);b.renderer.autoClear=!1;b.renderer.setClearColor(0,0);b.renderer.setAnimationLoop(function(){return b.animate()});
b.renderer.domElement.classList.add("panolens-canvas");b.renderer.domElement.style.display="block";b.renderer.domElement.style.position="absolute";b.container.style.backgroundColor="#000";b.container.append(b.renderer.domElement);a=document.createElement("div");a.style.transition="background-image 1.5s cubic-bezier( 1, 0, 0, 1 ) ";a.style.filter="blur(20px)";a.style.position="absolute";a.style.height="100%";a.style.width="100%";b.container.prepend(a);b.options.renderer=b.renderer;b.options.container=
b.container;b.mode=null;b.controlIndex=null;b.autoRotate=b.options.autoRotate;b.disableZoomInIframe=b.options.disableZoomInIframe;b.viewer=null;b.targetViewer=null;b.viewersQueue=[];b.composer=null;b.animate();b.inIframe=function(){try{return window.self!==window.top}catch(x){return!0}};return b}F(f,g);var k=G(f);H(f,[{key:"add",value:function(a){var b=this;this.viewer&&this.viewer.panorama instanceof ja&&this.viewer.removeWidget();this.viewer?(this.targetViewer=a,this.viewersQueue.push(a)):(this.viewer=
a,this.viewersQueue.push(a),this.transition=new wa(null,this.viewer,this.renderer,this.options.transitionParams),this.transition.addEventListener("transition-complete",function(){return b.disposePreviousViewer()}),this.transition.execute());a.panorama instanceof ja||this.removeVideoWidget();this.shareStateBetweenViewers()}},{key:"removeVideoWidget",value:function(){document.querySelectorAll(".videoWidgetBar").forEach(function(a){return a.remove()});document.querySelectorAll(".videoWidgetMask").forEach(function(a){return a.remove()})}},
{key:"updateTransitionType",value:function(a){a={type:a};this.options.transitionParams=z(z({},this.options.transitionParams),a);this.viewer.options.transitionParams=z(z({},this.viewer.options.transitionParams),a)}},{key:"setControlEnabled",value:function(){var a={controlEnabled:0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0};this.options.transitionParams=z(z({},this.options.transitionParams),a);this.viewer.options.transitionParams=z(z({},this.viewer.options.transitionParams),a);this.updateTransition()}},
{key:"updateTransition",value:function(){var a=this;this.transition=new wa(null,this.viewer,this.renderer,this.options.transitionParams);this.transition.addEventListener("transition-complete",function(){return a.disposePreviousViewer()});this.transition.execute()}},{key:"shareStateBetweenViewers",value:function(){this.options=this.viewer.options;this.mode=this.viewer.mode;this.controlIndex=this.viewer.getControlIndex();this.viewer.OrbitControls.noZoom=this.inIframe()?this.disableZoomInIframe:!1;this.targetViewer&&
(this.targetViewer.OrbitControls.noZoom=this.inIframe()?this.disableZoomInIframe:!1,this.mode!==this.targetViewer.mode&&this.targetViewer.enableEffect(this.mode),this.controlIndex!==this.targetViewer.getControlIndex()&&this.targetViewer.enableControl(this.controlIndex,!1),this.targetViewer.OrbitControls.minPolarAngle=this.viewer.OrbitControls.minPolarAngle,this.targetViewer.OrbitControls.maxPolarAngle=this.viewer.OrbitControls.maxPolarAngle,this.targetViewer.panorama.subtype===q.SLIDER||this.targetViewer.panorama.subtype===
q.SPIN?(this.targetViewer.OrbitControls.enableDamping=!1,this.targetViewer.OrbitControls.autoRotate=!1):(this.targetViewer.OrbitControls.enableDamping=!1,this.viewer.panorama.subtype===q.SLIDER||this.viewer.panorama.subtype===q.SPIN?this.targetViewer.OrbitControls.autoRotate=this.autoRotate:(this.targetViewer.OrbitControls.autoRotate=this.viewer.OrbitControls.autoRotate,this.autoRotate&&(this.targetViewer.autoRotateRequestId=window.setTimeout(this.targetViewer.enableAutoRate.bind(this.targetViewer),
this.options.autoRotateActivationDuration)))),this.targetViewer.OrbitControls.update(),this.targetViewer.OrbitControls.enableDamping=!0)}},{key:"setScene",value:function(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;a.render(!0);this.transition=new wa(this.viewer,a,this.renderer,this.options.transitionParams,c);this.transition.toScene.panorama.subtype===q.PROGRESSVIE_IMAGE?this.renderer.initTexture(this.transition.toScene.panorama.srcTexture):this.renderer.initTexture(this.transition.toScene.panorama.material.uniforms.tEquirect.value);
a===this.targetViewer&&requestAnimationFrame(function(){b.transition.addEventListener("transition-complete",b.disposePreviousViewer.bind(b));b.transition.execute();b.viewer=a;b.targetViewer=null})}},{key:"disposePreviousViewer",value:function(){this.transition.removeEventListener("transition-complete",this.disposePreviousViewer);if(2<=this.viewersQueue.length){var a=this.viewersQueue.shift();a.dispose();a.destroy()}}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getContainer",
value:function(){return this.container}},{key:"render",value:function(){var a,b;this.isRenderingDisabled||(this.transition&&this.transition.render(),null===(a=this.viewer)||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"render"}))}},{key:"disableRendering",value:function(a){this.isRenderingDisabled=a}},{key:"animate",value:function(){this.render()}},{key:"destroy",value:function(){this.render();window.cancelAnimationFrame(this.requestAnimationId)}}]);return f}(d.EventDispatcher);
var gb={tDiffuse:{value:new d.Texture},resolution:{value:1},transform:{value:new d.Matrix4},zoom:{value:1},opacity:{value:1}},hb=function(g){function f(a){C(this,f);a=k.call(this,a,f.createGeometry(1E4),f.createMaterial(1E4));a.subtype=q.IMAGE_LITTLE_PLANET;a.scale.x*=-1;a.EPS=1E-6;a.frameId=null;a.dragging=!1;a.userMouse=new d.Vector2;a.quatA=new d.Quaternion;a.quatB=new d.Quaternion;a.quatCur=new d.Quaternion;a.quatSlerp=new d.Quaternion;a.vectorX=new d.Vector3(1,0,0);a.vectorY=new d.Vector3(0,
1,0);a.handlerMouseDown=a.onMouseDown.bind(t(a));a.handlerMouseMove=a.onMouseMove.bind(t(a));a.handlerMouseUp=a.onMouseUp.bind(t(a));a.handlerMouseWheel=a.onMouseWheel.bind(t(a));a.handlerContextMenu=a.onContextMenu.bind(t(a));a.addEventListener("window-resize",a.onWindowResize);return a}F(f,g);var k=G(f);H(f,[{key:"add",value:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}a instanceof Ia&&(a.material.depthTest=!1);r(v(f.prototype),"add",this).call(this,
a)}},{key:"registerMouseEvents",value:function(){this.container.addEventListener("mousedown",this.handlerMouseDown,{passive:!0});this.container.addEventListener("mousemove",this.handlerMouseMove,{passive:!0});this.container.addEventListener("mouseup",this.handlerMouseUp,{passive:!0});this.container.addEventListener("touchstart",this.handlerMouseDown,{passive:!0});this.container.addEventListener("touchmove",this.handlerMouseMove,{passive:!0});this.container.addEventListener("touchend",this.handlerMouseUp,
{passive:!0});this.container.addEventListener("mousewheel",this.handlerMouseWheel,{passive:!1});this.container.addEventListener("DOMMouseScroll",this.handlerMouseWheel,{passive:!1});this.container.addEventListener("contextmenu",this.handlerContextMenu,{passive:!0})}},{key:"unregisterMouseEvents",value:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",
this.handlerMouseUp,!1);this.container.removeEventListener("touchstart",this.handlerMouseDown,!1);this.container.removeEventListener("touchmove",this.handlerMouseMove,!1);this.container.removeEventListener("touchend",this.handlerMouseUp,!1);this.container.removeEventListener("mousewheel",this.handlerMouseWheel,!1);this.container.removeEventListener("DOMMouseScroll",this.handlerMouseWheel,!1);this.container.removeEventListener("contextmenu",this.handlerContextMenu,!1)}},{key:"onMouseDown",value:function(a){switch(a.touches&&
0<a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;this.dragging=!0;this.userMouse.set(b,a);break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.userMouse.pinchDistance=Math.sqrt(b*b+a*a)}this.onUpdateCallback()}},{key:"onMouseMove",value:function(a){switch(a.touches&&a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;
var c=.4*d.Math.degToRad(b-this.userMouse.x),e=.4*d.Math.degToRad(a-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,c),this.quatB.setFromAxisAngle(this.vectorX,e),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(b,a));break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.addZoomDelta(this.userMouse.pinchDistance-Math.sqrt(b*b+a*a))}}},{key:"onMouseUp",value:function(){this.dragging=!1}},{key:"onMouseWheel",
value:function(a){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);this.addZoomDelta(b);this.onUpdateCallback()}},{key:"addZoomDelta",value:function(a){var b=this.material.uniforms,c=.1*this.size,e=10*this.size;b.zoom.value+=a;b.zoom.value<=c?b.zoom.value=c:b.zoom.value>=e&&(b.zoom.value=e)}},{key:"onUpdateCallback",value:function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this));this.quatSlerp.slerp(this.quatCur,
.1);this.material&&this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp);!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)}},{key:"reset",value:function(){this.quatCur.set(0,0,0,1);this.quatSlerp.set(0,0,0,1);this.onUpdateCallback()}},{key:"updateTexture",value:function(a){a.minFilter=d.LinearFilter;a.magFilter=d.LinearFilter;this.material.uniforms.tDiffuse.value=a}},{key:"getTexture",value:function(){return this.material.uniforms.tDiffuse.value}},
{key:"onLoad",value:function(a){a.minFilter=d.LinearFilter;a.magFilter=d.LinearFilter;this.material.uniforms.tDiffuse.value=a;this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight;this.registerMouseEvents();this.onUpdateCallback();this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"});r(v(f.prototype),"onLoad",this).call(this,a)}},{key:"onLeave",value:function(){this.unregisterMouseEvents();this.dispatchEvent({type:"panolens-viewer-handler",
method:"enableControl",data:Q.ORBIT});window.cancelAnimationFrame(this.frameId);r(v(f.prototype),"onLeave",this).call(this)}},{key:"onWindowResize",value:function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight}},{key:"onContextMenu",value:function(){this.dragging=!1}},{key:"dispose",value:function(){var a=this.material.uniforms.tDiffuse;a&&a.value&&a.value.dispose();this.unregisterMouseEvents();r(v(f.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",
value:function(){return new d.PlaneBufferGeometry(1E4,5E3)}},{key:"createMaterial",value:function(){var a=d.UniformsUtils.clone(gb);a.zoom.value=1E4;a.opacity.value=0;return new d.ShaderMaterial({vertexShader:"\n\n        varying vec2 vUv;\n\n        void main() {\n\n            vUv = uv;\n            gl_Position = vec4( position, 1.0 );\n\n        }\n\n    ",fragmentShader:"\n\n        uniform sampler2D tDiffuse;\n        uniform float resolution;\n        uniform mat4 transform;\n        uniform float zoom;\n        uniform float opacity;\n\n        varying vec2 vUv;\n\n        const float PI = 3.141592653589793;\n\n        void main(){\n\n            vec2 position = -1.0 +  2.0 * vUv;\n\n            position *= vec2( zoom * resolution, zoom * 0.5 );\n\n            float x2y2 = position.x * position.x + position.y * position.y;\n            vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );\n\n            sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );\n\n            vec2 sampleUV = vec2(\n                (atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,\n                (asin(sphere_pnt.z) / PI + 0.5)\n            );\n\n            gl_FragColor = texture2D( tDiffuse, sampleUV );\n            gl_FragColor.a *= opacity;\n\n        }\n    ",
uniforms:a,transparent:!0,opacity:0})}}]);return f}(sa);na.prototype=Object.assign(Object.create(d.EventDispatcher.prototype),{constructor:na});var ib=function(g){function f(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,f);var c=k.call(this,f.createGeometry(),f.createMaterial());c.options=z({},b);c.container=a;c.passThrough=!0;c.subtype=A.SPOT_MODEL;return c}F(f,g);var k=G(f);H(f,[{key:"dispose",value:function(){var a=this.geometry,b=this.material;a&&(a.dispose(),this.geometry=
null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new d.SphereGeometry(.5,30,1,0,2*Math.PI,1,1)}},{key:"createMaterial",value:function(){return new d.MeshToonMaterial({color:302836,transparent:!0,opacity:0})}}]);return f}(d.Mesh),jb=function(g){function f(a,b,c,e){var h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:function(){},g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};C(this,f);var m=k.call(this,f.createGeometry(),f.createMaterial());
m.subtype=q.SPIN;m.options=z({onLoadOneCallback:function(){},onLoadPassCallback:function(){},onInitialAutoRotateFinished:function(){},numberOfPasses:null,preview:null},g);m.onInitialAutoRotateFinished=function(){return m.options.onInitialAutoRotateFinished()};m.initialSpinFrame=m.options.initialSpinFrame||0;m.initialSpinZoom=m.options.initialSpinZoom||75;m.currentSide=m.initialSpinFrame;m.backgroundMode=m.options.backgroundMode||Y.DEFAULT;m.desiredWidth=m.options.desiredWidth||null;m.desiredHeight=
m.options.desiredHeight||null;m.desiredPosition=new d.Vector3(0,0,-2);m.position.copy(m.desiredPosition);m.src=m.options.preview||a&&a[m.initialSpinFrame];m.currentSideTexture=null;m.currentSide=null;if(!m.src)return console.error("Spin Panorama: the array of images is empty."),Aa(m);m.spotModel=new ib(m.container);m.spotModel.scale.set(1,1,1);m.spotModel.position.set(0,0,0);m.spotModel.rotation.y+=m.initialSpinFrame/a.length*Math.PI*2;m.add(m.spotModel);var p=m.options.numberOfPasses||Math.ceil(Math.log2(a.length));
m.texturesArray=Array(a.length);var l=function(a){return a===p-1?Math.pow(2,a):Math.pow(2,a+1)},r=function(b){return b===p-1?m.initialSpinFrame:(m.initialSpinFrame+Math.pow(2,b))%a.length},n=function(){return Object.values(t).reduce(function(a,b){return a+=b.count},0)/a.length},t=Array(p).fill(0).map(function(a,b){return b}).reduce(function(b,c){var e=Math.ceil((a.length-r(c))/l(c));b[c]={total:e,count:0};return b},{});m.setUpSpinEnvironment=function(d){m.container.children[0].style.backgroundImage=
"url(".concat(a[m.initialSpinFrame],")");m.container.children[0].style.backgroundPosition="center";m.container.children[0].style.backgroundSize=m.backgroundMode===Y.COLOR?"1%":"cover";m.desiredWidth=m.spotModel.desiredWidth=m.desiredWidth||d.image.width;m.desiredHeight=m.spotModel.desiredHeight=m.desiredHeight||d.image.height;for(var f=0;f<a.length;f++)m.texturesArray[f]=d;m.controls=new na(b,c,m.spotModel,e,m.texturesArray.length,m.initialSpinFrame);m.controls.addEventListener("rotation",m.onRotation,
!1);m.controls.addEventListener("initial-auto-rotate-finished",m.onInitialAutoRotateFinished,!1);w(p-1)};m.onRotation=function(b){b=b.data.currentSide;m.currentSide=b;var c=m.currentSideTexture;m.currentSideTexture=m.texturesArray[b];null===c||void 0===c?void 0:c.dispose();m.updateTexture(m.currentSideTexture);m.material.needsUpdate=!0;m.needsUpdate=!0;m.src=a[b]};m.rotateBySide=function(b){m.onRotation(b);m.spotModel.rotation.y+=(b.data.currentSide-m.currentSide)/a.length*Math.PI*2;m.currentSide=
b.data.currentSide};var w=function(b){for(var c=r(b),e=l(b),d=function(c){var e=c%a.length;V.load(a[e],function(c){t[b].count++;for(var d=0;d<l(b)/2;d++)e+d>=a.length||(m.texturesArray[e+d]=c);c=n();c===1/a.length&&m.dispatchEvent({type:"first-image-loaded"});m.options.onLoadOneCallback(c);t[b].count===t[b].total&&(m.options.onLoadPassCallback(b),0===b?(h(),m.controls.texturesLoaded=!0,m.options.disabledAutoAnimation||m.controls.animate(!1,m.initialSpinFrame)):w(b-1))})},f=c;f<a.length+c;f+=e)d(f)};
return m}F(f,g);var k=G(f);H(f,[{key:"load",value:function(a){a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)V.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new d.Texture(a))}},{key:"add",value:function(a){a.type===A.INFOSPOT?(this.dispatchInfospotListeners(a),this.spotModel.add(a)):r(v(f.prototype),"add",this).call(this,a)}},{key:"onLoad",value:function(a){a.minFilter=a.magFilter=
d.LinearFilter;a.needsUpdate=!0;this.updateTexture(a);window.requestAnimationFrame(r(v(f.prototype),"onLoad",this).bind(this));this.setUpSpinEnvironment(a)}},{key:"reset",value:function(){r(v(f.prototype),"reset",this).call(this)}},{key:"dispose",value:function(){var a,b,c,e,h;if(null!==(a=this.material)&&void 0!==a&&null!==(b=a.uniforms)&&void 0!==b&&null!==(c=b.tEquirect)&&void 0!==c&&c.value){var g,m,k;null===(g=this.material)||void 0===g?void 0:null===(m=g.uniforms)||void 0===m?void 0:null===
(k=m.tEquirect)||void 0===k?void 0:k.value.dispose()}this.texturesArray.forEach(function(a){a.dispose()});null===(e=this.controls)||void 0===e?void 0:e.removeEventListener("rotation",this.onRotation,!1);null===(h=this.controls)||void 0===h?void 0:h.removeEventListener("initial-auto-rotate-finished",this.onInitialAutoRotateFinished,!1);d.Cache.remove(this.src);r(v(f.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(){return new d.PlaneBufferGeometry(1,1)}},{key:"createMaterial",
value:function(){var a=d.UniformsUtils.clone(La);a.repeat.value.copy(new d.Vector2(1,1));a.offset.value.copy(new d.Vector2(0,0));a.opacity.value=0;return new d.ShaderMaterial({fragmentShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ",
vertexShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ",uniforms:a,side:d.FrontSide,transparent:!0})}}]);return f}(T);ca.prototype=Object.create(d.EventDispatcher.prototype);ca.prototype.constructor=ca;da.prototype=Object.assign(Object.create(d.EventDispatcher.prototype),
{constructor:da});pa.prototype=Object.assign(Object.create(d.EventDispatcher.prototype),{constructor:pa});Object.assign(ea.prototype,{constructor:ea,updateUniformByFormat:function(d,f){this.format=d;var g=f.repeat.value;f=f.offset.value;var a=this.loffset,b=this.roffset;switch(d){case U.TAB:g.set(1,.5);f.set(0,.5);a.set(0,.5);b.set(0,0);break;case U.SBS:g.set(.5,1),f.set(0,0),a.set(0,0),b.set(.5,0)}},updateTextureToLeft:function(d){d.copy(this.loffset)},updateTextureToRight:function(d){d.copy(this.roffset)}});
var Ra=function(g){function f(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new ea;C(this,f);var c=k.call(this,a);c.type=q.STEREO_IMAGE;c.stereo=b;return c}F(f,g);var k=G(f);H(f,[{key:"onLoad",value:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===b.width/b.height?U.SBS:U.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=a;r(v(f.prototype),"onLoad",this).call(this,a)}},{key:"updateTextureToLeft",value:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)}},
{key:"updateTextureToRight",value:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)}},{key:"dispose",value:function(){var a=this.material.uniforms.tEquirect.value;a instanceof d.Texture&&a.dispose();r(v(f.prototype),"dispose",this).call(this)}}]);return f}(sa),Sa=function(g){function f(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new ea;C(this,f);b=k.call(this,a,b);b.type=q.STEREO_VIDEO_PANORAMA;
b.stereo=c;return b}F(f,g);var k=G(f);H(f,[{key:"onLoad",value:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===b.videoWidth/b.videoHeight?U.SBS:U.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=a;r(v(f.prototype),"onLoad",this).call(this)}},{key:"updateTextureToLeft",value:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)}},{key:"updateTextureToRight",value:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)}},
{key:"dispose",value:function(){var a=this.material.uniforms.tEquirect.value;a instanceof d.Texture&&a.dispose();r(v(f.prototype),"dispose",this).call(this)}}]);return f}(ja),kb=function(g){var f=new d.StereoCamera;f.aspect=.5;var k=new d.Vector2;this.setEyeSeparation=function(a){f.eyeSep=a};this.setSize=function(a,b){g.setSize(a,b)};this.render=function(a,b){a.updateMatrixWorld();null===b.parent&&b.updateMatrixWorld();f.update(b);g.getSize(k);g.autoClear&&g.clear();g.setScissorTest(!0);g.setScissor(0,
0,k.width/2,k.height);g.setViewport(0,0,k.width/2,k.height);g.render(a,f.cameraL);g.setScissor(k.width/2,0,k.width/2,k.height);g.setViewport(k.width/2,0,k.width/2,k.height);g.render(a,f.cameraR);g.setScissorTest(!1)}},lb=function(g){function f(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C(this,f);var b=k.call(this);b.options=z({container:b.setupContainer(a.container),controlBar:!1,controlButtons:[],autoHideControlBar:!0,autoHideInfospot:!0,horizontalView:!1,clickTolerance:10,
cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new d.Vector3(0,0,-Number.MAX_SAFE_INTEGER),cameraInitialLookAt:null,momentum:!0,rotateSpeed:-1,dampingFactor:.1,defaultFov:60,horizontalViewLimit:!1,horizontalViewDownLimitDegrees:0,horizontalViewUpLimitDegrees:180},a);b.viewerInstanceNumber=Math.floor(30*Math.random());var c=b.options;a=c.container;
var e=c.cameraFov,h=c.defaultFov,g=c.controlBar,m=c.viewIndicator,p=c.indicatorSize,l=c.enableReticle,q=c.reverseDragging,n=c.output,r=c.scene,w=c.camera;c=c.renderer;var v=a.clientWidth,y=a.clientHeight,A={minFilter:d.LinearFilter,magFilter:d.LinearFilter};b.fbo=new d.WebGLRenderTarget(v,y,A);b.reticleFbo=new d.WebGLRenderTarget(v,y,A);b.container=a;b.scene=b.setupScene(r);b.sceneReticle=new d.Scene;b.defaultFov=h;b.camera=b.setupCamera(e,v/y,w);b.renderer=b.setupRenderer(c,a);b.reticle=b.addReticle(b.camera,
b.sceneReticle);b.control=b.setupControls(b.camera,a);b.effect=b.setupEffects(b.renderer,a);b.lastTouch={plane:null,scene:null};b.containerCursor=O.GRAB;b.CURSORS=O;b.mode=B.NORMAL;b.panorama=null;b.widget=null;b.hoverObject=null;b.infospot=null;b.pressEntityObject=null;b.pressObject=null;b.raycaster=new d.Raycaster;b.raycasterPoint=new d.Vector2;b.userMouse=new d.Vector2;b.updateCallbacks=[];b.requestAnimationId=null;b.cameraFrustum=new d.Frustum;b.cameraViewProjectionMatrix=new d.Matrix4;b.autoRotateRequestId=
null;b.outputDivElement=null;b.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;b.tweenLeftAnimation=new u.Tween;b.tweenUpAnimation=new u.Tween;b.tweenCanvasOpacityOut=new u.Tween;b.tweenCanvasOpacityIn=new u.Tween;b.outputEnabled=!1;b.viewIndicatorSize=p;b.tempEnableReticle=l;b.setupTween();b.handlerMouseUp=b.onMouseUp.bind(t(b));b.handlerMouseDown=b.onMouseDown.bind(t(b));b.handlerMouseMove=b.onMouseMove.bind(t(b));b.handlerWindowResize=b.onWindowResize.bind(t(b));
b.handlerKeyDown=b.onKeyDown.bind(t(b));b.handlerKeyUp=b.onKeyUp.bind(t(b));b.handlerTap=b.onTap.bind(t(b),{clientX:v/2,clientY:y/2});g&&b.addDefaultControlBar(b.options.controlButtons);m&&b.addViewIndicator();q&&b.reverseDraggingDirection();l?b.enableReticleControl():b.registerMouseAndTouchEvents();"overlay"===n&&b.addOutputElement();b.registerEventListeners();b.setupFloorCursor();return b}F(f,g);var k=G(f);H(f,[{key:"setupScene",value:function(){return 0<arguments.length&&void 0!==arguments[0]?
arguments[0]:new d.Scene}},{key:"setupCamera",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new d.PerspectiveCamera(a,b,1,11E3);c.position.z=1;return c}},{key:"setupRenderer",value:function(){return 0<arguments.length&&void 0!==arguments[0]?arguments[0]:new d.WebGLRenderer({alpha:!0,antialias:!1})}},{key:"setupControls",value:function(a,b){var c=this.options,e=c.autoRotate,d=c.autoRotateSpeed,f=c.horizontalView,g=c.momentum,k=c.rotateSpeed,l=c.dampingFactor,p=c.horizontalViewLimit,
n=c.horizontalViewDownLimitDegrees,q=c.horizontalViewUpLimitDegrees;c=new da(a,b);c.id="orbit";c.index=Q.ORBIT;c.minDistance=1;c.noPan=!0;c.autoRotate=e;c.autoRotateSpeed=d;c.momentum=g;c.rotateSpeed=k;c.dampingFactor=l;c.enabled=!0;c.addEventListener("fov",this.dispatchEventToChildren.bind(this));a=new pa(a,b);a.id="device-orientation";a.index=Q.DEVICEORIENTATION;a.enabled=!1;f&&(c.minPolarAngle=Math.PI/2,c.maxPolarAngle=Math.PI/2);!f&&p&&(c.minPolarAngle=Math.PI/180*n,c.maxPolarAngle=Math.PI/180*
q);f={id:"drag",index:Q.DRAG,enabled:!1};this.controls=[c,a,{id:"object",index:Q.OBJECT,enabled:!1},f];this.OrbitControls=c;this.DeviceOrientationControls=a;this.DragControls=f;return c}},{key:"setupEffects",value:function(a,b){var c=b.clientWidth;b=b.clientHeight;var e=new Qa(a);e.setSize(c,b);a=new kb(a);a.setSize(c,b);this.CardboardEffect=e;this.StereoEffect=a;return e}},{key:"setupContainer",value:function(a){a._width=a.clientWidth;a._height=a.clientHeight;return a}},{key:"setupTween",value:function(){this.tweenCanvasOpacityOut.to({},
500).easing(u.Easing.Exponential.Out);this.tweenCanvasOpacityIn.to({},500).easing(u.Easing.Exponential.Out);this.tweenCanvasOpacityOut.chain(this.tweenCanvasOpacityIn)}},{key:"setupFloorCursor",value:function(){this.floorCursor=new Ha;this.add(this.floorCursor)}},{key:"setContainerCursor",value:function(a){this.containerCursor=a;this.container&&(this.container.style.cursor=a)}},{key:"applyDefaultContainerCursor",value:function(){this.container&&(this.container.style.cursor=this.containerCursor)}},
{key:"add",value:function(a){var b=this,c=this.container,e=this.scene,d=this.camera,f=this.controls;if(1<arguments.length){for(c=0;c<arguments.length;c++)this.add(arguments[c]);return this}e.add(a);a.addEventListener&&a.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this));a.type===qa.FLOOR&&(this.floorCursor=a);a.type===q.PANORAMA&&(a.dispatchEvent({type:"panolens-container",container:c}),a.dispatchEvent({type:"panolens-scene",scene:e}),a.dispatchEvent({type:"panolens-camera",
camera:d}),a.dispatchEvent({type:"panolens-controls",controls:f}),this.addPanoramaEventListener(a),this.panorama||(this.setPanorama(a),this.setControlCenter(this.options.initialLookAt)));if(a.subtype===q.SLIDER||a.subtype===q.SPIN){this.camera.position.set(0,0,1);e.add(a);this.controls[Q.OBJECT]={};var g=!1,k=(new u.Tween(a.position)).to({x:0,y:0,z:-2},500).easing(u.Easing.Cubic.Out).onStart(function(){g=!0}).onComplete(function(){g=!1});a.addEventListener("addChild",this.fitObjectToScreenEvent.bind(this));
a.addEventListener("ready",function(){b.OrbitControls.addEventListener("start",function(){b.DragControls.enabled=!1});b.OrbitControls.addEventListener("end",function(){b.camera.fov<b.defaultFov?(b.DragControls.enabled=!0,b.panorama.subtype===q.SPIN&&(b.panorama.controls.setIsZoomed(!0),b.panorama.controls.disableHorizontalRotation())):(g||k.start(),b.panorama.subtype===q.SPIN&&(b.panorama.controls.setIsZoomed(!1),b.panorama.controls.enableHorizontalRotation()))});b.OrbitControls.addEventListener("change",
function(){b.DragControls.enabled=!1});b.DragControls=Object.assign(new ca([a],b.camera,b.container),b.DragControls);b.DragControls.activate();b.camera.fov<b.defaultFov&&(b.DragControls.enabled=!0)});a.addEventListener("ready",this.fitObjectToScreenEvent.bind(this))}}},{key:"fitObjectToScreenEvent",value:function(a){a.target.subtype!==q.SLIDER&&a.target.subtype!==q.SPIN||this.fitObjectToScreen(a.target)}},{key:"fitObjectToScreen",value:function(a){var b;if(a){var c=a.desiredWidth/a.desiredHeight;
a.position.copy(a.desiredPosition);this.camera.lookAt(a.position);var e=2*Math.tan(this.camera.fov/360*Math.PI),f=this.camera.aspect/c*e;e=e>f?f*(this.camera.position.z-a.position.z):e*(this.camera.position.z-a.position.z);e*=(this.defaultFov||60)/this.camera.fov;a.scale.set(e*c,e,1);a.subtype===q.SPIN&&(a.spotModel.scale.set(1,1,1),a.spotModel.scale.set(a.spotModel.scale.x/c,a.spotModel.scale.y,a.spotModel.scale.z/c));null===(b=a.children)||void 0===b?void 0:b.forEach(function(b){if(!b.alreadyScaled&&
a.subtype!==q.SPIN&&b.type===A.INFOSPOT){b.scale.set(b.scale.x/c,b.scale.y,b.scale.z);b._parentRatio=c;var e=new d.Vector3;e.copy(b.scale);b.scaleUpAnimation=(new u.Tween(b.scale)).to({x:1.3*e.x,y:1.3*e.y},500).easing(u.Easing.Elastic.Out);b.scaleDownAnimation=(new u.Tween(b.scale)).to({x:e.x,y:e.y},500).easing(u.Easing.Elastic.Out);null!=b.map&&(b.map.needsUpdate=!0);b.needsUpdate=!0;b.updateMatrixWorld();a.updateMatrixWorld();b.alreadyScaled=!0}});this.currentScale=e;this.currentRatio=c;this.panorama.subtype===
q.SPIN&&(this.OrbitControls.maxFov=this.camera.fov,this.setCameraFov(this.panorama.initialSpinZoom||this.camera.fov))}}},{key:"remove",value:function(a){a.removeEventListener&&a.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this));this.scene.remove(a)}},{key:"addDefaultControlBar",value:function(a){if(!this.widget){var b=new Fa(this.container);b.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this));b.addControlBar();a.forEach(function(a){b.addControlButton(a)});
this.widget=b}}},{key:"setPanorama",value:function(a){var b=this.panorama;a.type===q.PANORAMA&&b!==a&&(this.hideInfospot(),b&&(b._onReady&&(b.removeEventListener("ready",b._onReady),delete b._onReady),b.onLeave()),a._onLeaveComplete&&(a.removeEventListener("leave-complete",a._onLeaveComplete),delete a._onLeaveComplete),b=function e(){a.removeEventListener("ready",e);delete a._onReady;a.active&&a.fadeIn()},a.addEventListener("ready",b),a._onReady=b,this.panorama=a,this.panorama.onEnter())}},{key:"eventHandler",
value:function(a){if(a.method&&this[a.method])this[a.method](a.data)}},{key:"dispatchEventToChildren",value:function(a){this.scene.traverse(function(b){b.dispatchEvent&&b.dispatchEvent(a)})}},{key:"activateWidgetItem",value:function(a,b){var c=this.widget.mainMenu,e=c.children[0];c=c.children[1];if(void 0!==a){switch(a){case 0:a=e.subMenu.children[1];break;case 1:a=e.subMenu.children[2];break;default:a=e.subMenu.children[1]}e.subMenu.setActiveItem(a);e.setSelectionTitle(a.textContent)}if(void 0!==
b){switch(b){case B.CARDBOARD:a=c.subMenu.children[2];break;case B.STEREO:a=c.subMenu.children[3];break;default:a=c.subMenu.children[1]}c.subMenu.setActiveItem(a);c.setSelectionTitle(a.textContent)}}},{key:"enableEffect",value:function(a){var b=this;if(this.mode!==a)if(a===B.NORMAL)this.disableEffect();else{this.mode=a;var c=this.camera.fov;switch(a){case B.CARDBOARD:this.effect=this.CardboardEffect;this.enableReticleControl();break;case B.STEREO:this.effect=this.StereoEffect;this.enableReticleControl();
break;default:this.effect=null,this.disableReticleControl()}this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode});this.disableAutoRate();this.camera.fov=c+.01;setTimeout(function(){if(document.fullscreenElement){var a=window.screen.width;var c=window.screen.height}else a=b.container.clientWidth,c=b.container.clientHeight;b.effect.setSize(a,c);b.render()},50);this.camera.fov=c;this.dispatchEvent({type:"mode-change",mode:this.mode});this.dispatchEvent({type:"viewerStateUpdate"})}}},
{key:"disableEffect",value:function(){this.mode!==B.NORMAL&&(this.mode=B.NORMAL,this.disableReticleControl(),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.options.autoRotate&&this.enableAutoRate(),this.dispatchEvent({type:"mode-change",mode:this.mode}),this.dispatchEvent({type:"viewerStateUpdate"}))}},{key:"enableReticleControl",value:function(){this.reticle.visible||(this.tempEnableReticle=
!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())}},{key:"disableReticleControl",value:function(){this.tempEnableReticle=!1;this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())}},{key:"enableAutoRate",value:function(){this.options.autoRotate=!0;this.OrbitControls.autoRotate=!0;this.dispatchEvent({type:"enableAutoRotate"})}},{key:"disableAutoRate",
value:function(){clearTimeout(this.autoRotateRequestId);this.dispatchEvent({type:"viewerStateUpdate"});this.options.autoRotate=!1;this.OrbitControls.autoRotate=!1}},{key:"toggleVideoPlay",value:function(a){this.panorama.subtype===q.VIDEO&&this.panorama.dispatchEvent({type:"video-toggle",pause:a})}},{key:"toggleVideoSound",value:function(){this.panorama.subtype===q.VIDEO&&this.panorama.dispatchEvent({type:"video-toggle",toggleMute:!0})}},{key:"setVideoCurrentTime",value:function(a){this.panorama.subtype===
q.VIDEO&&this.panorama.dispatchEvent({type:"video-time",percentage:a})}},{key:"onVideoUpdate",value:function(a){var b=this.widget;b&&b.dispatchEvent({type:"video-update",percentage:a.percentage,quality:a.quality})}},{key:"addUpdateCallback",value:function(a){a&&this.updateCallbacks.push(a)}},{key:"removeUpdateCallback",value:function(a){var b=this.updateCallbacks.indexOf(a);a&&0<=b&&this.updateCallbacks.splice(b,1)}},{key:"showVideoWidget",value:function(){var a=this.widget;a&&a.dispatchEvent({type:"video-control-show"})}},
{key:"hideVideoWidget",value:function(){var a=this.widget;a&&a.dispatchEvent({type:"video-control-hide"})}},{key:"updateVideoPlayButton",value:function(a){var b=this.widget;b&&b.videoElement&&b.videoElement.controlButton&&b.videoElement.controlButton.update(a)}},{key:"addPanoramaEventListener",value:function(a){var b=this;a.subtype===q.VIDEO&&(a.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),a.addEventListener("leave-start",function(){b.panorama.subtype!==q.VIDEO&&b.hideVideoWidget.call(b)}))}},
{key:"setControl",value:function(a){this.control=this.controls[a];this.dispatchEvent({type:"viewerStateUpdate"})}},{key:"getControl",value:function(){return this.control}},{key:"getScene",value:function(){return this.scene}},{key:"getCamera",value:function(){return this.camera}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getContainer",value:function(){return this.container}},{key:"getControlId",value:function(){return this.control.id}},{key:"getNextControlId",value:function(){return this.controls[this.getNextControlIndex()].id}},
{key:"getNextControlIndex",value:function(){var a=this.controls,b=a.indexOf(this.control)+1;return b>=a.length?0:b}},{key:"getControlIndex",value:function(){return this.controls.indexOf(this.control)}},{key:"setCameraFov",value:function(a){this.camera.fov=a;this.camera.updateProjectionMatrix()}},{key:"getRaycastViewCenter",value:function(){var a=new d.Raycaster;a.setFromCamera(new d.Vector2(0,0),this.camera);a=a.intersectObject(this.panorama);return 0<a.length?a[0].point:new d.Vector3(0,0,-1)}},{key:"enableControl",
value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Q.ORBIT,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,e=this.control.index,d=this.controls,f=this.OrbitControls,g=this.DeviceOrientationControls,k=this.tweenCanvasOpacityOut,l=this.tweenCanvasOpacityIn,p=this.container.querySelector("canvas");if(b!==e){if(b===Q.DEVICEORIENTATION)k.onStart(function(){f.enabled=!1;g.enabled=!1;c?p.style.opacity=0:null}),l.onStart(function(){f.enabled=!0;g.updateAlphaOffsetAngle(f.publicSphericalDelta.data.theta);
g.connect();c?p.style.opacity=1:null});else{e=g.getRotations;e();var n=this.getRaycastViewCenter();k.onStart(function(){f.enabled=!1;g.disconnect();p.style.opacity=0});l.onStart(function(){f.enabled=!0;a.setControlCenter(n);p.style.opacity=1})}k.start();this.control=d[b]}}},{key:"disableControl",value:function(){this.control.enabled=!1}},{key:"toggleNextControl",value:function(){this.enableControl(this.getNextControlIndex())}},{key:"getScreenVector",value:function(a){a=a.clone();var b=this.container.clientWidth/
2,c=this.container.clientHeight/2;a.project(this.camera);a.x=a.x*b+b;a.y=-(a.y*c)+c;a.z=0;return a}},{key:"checkSpriteInViewport",value:function(a){this.camera.matrixWorldInverse.copy(this.camera.matrixWorld).invert();this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse);this.cameraFrustum.setFromProjectionMatrix(this.cameraViewProjectionMatrix);return a.visible&&this.cameraFrustum.intersectsSprite(a)}},{key:"reverseDraggingDirection",value:function(){console.warn("reverseDragging option is deprecated. Please use rotateSpeed to indicate strength and direction");
this.OrbitControls.rotateSpeed*=-1}},{key:"addReticle",value:function(a,b){var c=new Ga(16777215,!0,this.options.dwellTime);c.hide();a.add(c);b.add(a);return c}},{key:"rotateControlLeft",value:function(a){this.OrbitControls.rotateLeftStatic(a)}},{key:"rotateControlUp",value:function(a){this.OrbitControls.rotateUpStatic(a)}},{key:"rotateControl",value:function(a,b){this.rotateControlLeft(a);this.rotateControlUp(b)}},{key:"calculateCameraDirectionDelta",value:function(a){var b=this.camera.getWorldDirection(new d.Vector3);
var c=b.clone();var e=this.panorama.getWorldPosition(new d.Vector3).sub(this.camera.getWorldPosition(new d.Vector3));a=a.clone();a.add(e).normalize();var f=a.clone();b.y=0;a.y=0;e=Math.atan2(a.z,a.x)-Math.atan2(b.z,b.x);e=e>Math.PI?e-2*Math.PI:e;e=e<-Math.PI?e+2*Math.PI:e;b=Math.abs(c.angleTo(b)+(0>=c.y*f.y?f.angleTo(a):-f.angleTo(a)));b*=f.y<c.y?1:-1;return{left:e,up:b}}},{key:"setControlCenter",value:function(){var a=this.calculateCameraDirectionDelta(0<arguments.length&&void 0!==arguments[0]?arguments[0]:
this.options.initialLookAt);this.rotateControl(a.left,a.up)}},{key:"tweenControlCenter",value:function(a,b,c){Array.isArray(a)&&(c=a[2],b=a[1],a=a[0]);b=void 0!==b?b:400;c=c||u.Easing.Exponential.Out;var e=this.calculateCameraDirectionDelta(a);a=e.left;e=e.up;var d=this.rotateControlLeft.bind(this),f=this.rotateControlUp.bind(this),g={left:0,up:0},k=0,l=0;this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.tweenLeftAnimation=(new u.Tween(g)).to({left:a},b).easing(c).onUpdate(function(a){d(a.left-
k);k=a.left}).start();this.tweenUpAnimation=(new u.Tween(g)).to({up:e},b).easing(c).onUpdate(function(a){f(a.up-l);l=a.up}).start()}},{key:"tweenControlCenterByObject",value:function(a,b,c){this.tweenControlCenter(a.getWorldPosition(new d.Vector3),b,c)}},{key:"onWindowResize",value:function(a,b){var c=this.container.classList.contains("panolens-container")||this.container.isFullscreen;if(void 0!==a&&void 0!==b){var e=a;var d=b;this.container._width=a;this.container._height=b}else a=ha?Math.min(document.documentElement.clientWidth,
window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),b=ha?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),e=c?a:this.container.clientWidth,d=c?b:this.container.clientHeight,this.container._width=e,this.container._height=d;this.camera.aspect=e/d;this.camera.updateProjectionMatrix();this.renderer.setSize(e,d);if(this.panorama&&this.panorama.subtype===q.SLIDER||this.panorama&&
this.panorama.subtype===q.SPIN)this.renderer.clear(),this.renderer.clearDepth(),this.fitObjectToScreen(this.panorama);(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent();this.dispatchEvent({type:"window-resize",width:e,height:d});this.scene.traverse(function(a){a.dispatchEvent&&a.dispatchEvent({type:"window-resize",width:e,height:d})})}},{key:"addOutputElement",value:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="10px";a.style.top=
"10px";a.style.color="#fff";this.container.append(a);this.outputDivElement=a}},{key:"getPlanePosition",value:function(a){var b=new d.Vector3(-1,1,1),c=a.point.clone();c.multiply(b);a=Math.round(Math.abs(a.point.y))!==Math.abs(X.Y);if(0!==c.length()&&!a)return c}},{key:"getSliderPosition",value:function(a){a=a.point.clone();return new d.Vector3(((a.x+this.panorama.position.x)/this.currentScale/this.currentRatio).toFixed(6),((a.y-this.panorama.position.y)/this.currentScale).toFixed(6),(0).toFixed(2))}},
{key:"get360Position",value:function(a){var b=new d.Vector3(-1,1,1);a=a.point.clone();a.multiply(b);if(0!==a.length())return a}},{key:"outputPosition",value:function(){var a=this,b=this.raycaster.intersectObject(this.panorama,!0);if(0<b.length){var c={plane:null,scene:null};b.forEach(function(d){if(d.object.subtype!==q.PROGRESSVIE_IMAGE||b.some(function(a){return a.object.subtype===S.FLOOR_PLANE}))if(d.object.subtype===S.FLOOR_PLANE){if(d=a.getPlanePosition(d))d.y+=+Math.random().toFixed(2);c.plane=
d}else d.object.subtype===q.SLIDER?c.scene=a.getSliderPosition(d):d.object.subtype===q.IMAGE||d.object.subtype===q.VIDEO?c.scene=a.get360Position(d):d.object.subtype===q.PROGRESSVIE_IMAGE?c.scene=a.get360Position(d):d.object.subtype===A.SPOT_MODEL&&(d=d.point.clone(),a.panorama.spotModel.worldToLocal(d),c.scene=d);else d=b.find(function(a){return a.object.subtype===S.SPOT_SPHERE}),c.scene=a.get360Position(d)});return this.lastTouch=c}}},{key:"onMouseDown",value:function(a){a.preventDefault();this.userMouse.x=
0<=a.clientX?a.clientX:a.touches[0].clientX;this.userMouse.y=0<=a.clientY?a.clientY:a.touches[0].clientY;this.userMouse.type="mousedown";this.isProbablyDragging=!0;this.onTap(a)}},{key:"onMouseMove",value:function(a){a.preventDefault();this.userMouse.type="mousemove";this.onTap(a)}},{key:"onMouseUp",value:function(a){this.isProbablyDragging=!1;this.userMouse.type="mouseup";var b=this.userMouse.x>=a.clientX-this.options.clickTolerance&&this.userMouse.x<=a.clientX+this.options.clickTolerance&&this.userMouse.y>=
a.clientY-this.options.clickTolerance&&this.userMouse.y<=a.clientY+this.options.clickTolerance||a.changedTouches&&this.userMouse.x>=a.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=a.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=a.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=a.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;if(!a||!a.target||a.target.classList.contains("panolens-canvas"))if(a.preventDefault(),
a=a.changedTouches&&1===a.changedTouches.length?this.onTap({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY},b):this.onTap(a,b),this.userMouse.type="none",!a&&"click"===b){b=this.options;a=b.autoHideControlBar;var c=this.panorama;b.autoHideInfospot&&c&&c.toggleInfospotVisibility();a&&this.toggleControlBar()}}},{key:"onTap",value:function(a,b){var c=this,e=this.container.getBoundingClientRect(),f=e.top,g=this.container,m=g.clientHeight;this.raycasterPoint.x=(a.clientX-e.left)/
g.clientWidth*2-1;this.raycasterPoint.y=2*-((a.clientY-f)/m)+1;this.raycaster.setFromCamera(this.raycasterPoint,this.camera);if(this.panorama){"mousedown"!==a.type&&this.outputPosition();this.floorCursor&&this.floorCursor.enabled&&(this.lastTouch&&this.lastTouch.plane&&this.floorCursor.position.set(-this.lastTouch.plane.x,this.lastTouch.plane.y+1,this.lastTouch.plane.z),this.floorCursor.onMove());e=this.raycaster.intersectObjects(this.panorama.children,!0);f=e.filter(function(a){var b;return!(null!==
(b=a.object)&&void 0!==b&&b.passThrough)});if(0<f.length){var k=f.find(function(a){var b;return(null===(b=a.object)||void 0===b?void 0:b.type)===A.INFOSPOT});g=f.find(function(a){var b;return(null===(b=a.object)||void 0===b?void 0:b.type)===A.NADIR});k=k&&g?k.object:f[0].object}"click"!==b||k&&k.type===A.NADIR||this.panorama.dispatchEvent({type:"clickOnAviablePlaceForAddSpot"});"click"===b?(this.panorama.dispatchEvent({type:"click",intersects:e,mouseEvent:a}),k&&k.dispatchEvent&&k.dispatchEvent({type:"click",
mouseEvent:a})):(this.panorama.dispatchEvent({type:"hover",intersects:e,mouseEvent:a}),this.hoverObject&&k!==this.hoverObject&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:a}),this.reticle.end()),this.hoverObject=void 0),k&&this.hoverObject!==k&&(this.hoverObject=k,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:a}),this.options.autoReticleSelect&&(this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,
a,"click")))));if(!k||k.type!==A.INFOSPOT&&k.subtype!==A.FLOOR_RING_INFOSPOT)this.infospot&&"click"===b&&this.hideInfospot();else{this.infospot&&this.infospot!==k&&(this.infospot.unlockHoverElement(),this.hideInfospot());this.infospot=k;if("click"===b&&this.infospot.subtype!==A.HOTSPOT&&this.infospot.subtype!==A.FLOOR_RING_INFOSPOT&&this.panorama.subtype!==q.SPIN&&this.panorama.subtype!==q.SLIDER)return this.tweenControlCenter(new d.Vector3(-k.position.x,k.position.y,k.position.z)),!0;"click"===b&&
this.infospot.subtype===A.HOTSPOT&&k.type!==A.NADIR&&setTimeout(function(){return c.setContainerCursor(O.GRAB)},10)}this.options.autoRotate&&this.isProbablyDragging&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.dispatchEvent({type:"pauseAutoRotate"}),this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))}}},{key:"hideInfospot",value:function(){this.infospot&&(this.infospot.onHoverEnd(),
this.infospot=void 0)}},{key:"toggleControlBar",value:function(){this.widget&&this.widget.dispatchEvent({type:"control-bar-toggle"})}},{key:"onKeyDown",value:function(a){this.options.output&&"none"!==this.options.output&&"Control"===a.key&&(this.outputEnabled=!0)}},{key:"onKeyUp",value:function(){this.outputEnabled=!1}},{key:"update",value:function(){var a,b,c,e,f=this,g=this.scene,k=this.control,p=this.OrbitControls,l=this.DeviceOrientationControls,r=this.panorama;u.update();null===(a=this.updateCallbacks)||
void 0===a?void 0:a.forEach(function(a){return a()});(null===r||void 0===r?void 0:r.subtype)===q.PROGRESSVIE_IMAGE&&setTimeout(function(){return r.refresh()},0);p.enabled&&null!==(b=g.children[1])&&void 0!==b&&b.subtype&&(null===(c=g.children[1])||void 0===c?void 0:c.subtype)!==q.SPIN&&(null===(e=g.children[1])||void 0===e?void 0:e.subtype)!==q.SLIDER&&p.update();k===l&&l.update();var n=new d.Vector3,t=function(a){var b=f.hoverObject===a;(a.type===A.INFOSPOT||a.subtype===A.FLOOR_RING_INFOSPOT)&&a.element&&
(b||a.showTitleHotspotInfospot||"none"!==a.element.style.display||a.element.left&&"none"!==a.element.left.style.display||a.element.right&&"none"!==a.element.right.style.display)&&(f.checkSpriteInViewport(a)?(b=f.getScreenVector(a.getWorldPosition(n)),a.translateElement(b.x,b.y),a.showTitleHotspotInfospot&&a.handleAlwaysShowTitle(!0)):(a.onDismiss(!1),a.handleAlwaysShowTitle(!1)))};this.camera.updateMatrixWorld();this.camera.updateProjectionMatrix();g.traverse(function(a){t(a);a.subtype===q.SPIN&&
a.spotModel.traverse(function(a){t(a);var b=new d.Vector3;a.getWorldPosition(b);if(-2>b.z&&a.hide)a.hide();else if(-2<b.z){var c;a.lookAt(0,0,1);null===(c=a.parent)||void 0===c?void 0:c.updateMatrixWorld();a.updateMatrixWorld();f.camera.updateProjectionMatrix();f.camera.updateMatrixWorld();!a.visible&&a.shouldRender&&a.show()}})})}},{key:"renderEffect",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)?(this.renderer.setRenderTarget(this.fbo),this.renderer.clear(),this.effect.render(this.scene,
this.camera,this.panorama,!0,this.fbo),this.effect.render(this.sceneReticle,this.camera,this.panorama,!0,this.fbo)):(this.renderer.setRenderTarget(null),this.renderer.clear(),this.effect.render(this.scene,this.camera,this.panorama,!1,null),this.effect.render(this.sceneReticle,this.camera,this.panorama,!1,null));this.renderer.clearDepth()}},{key:"renderNormal",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)?this.renderer.setRenderTarget(this.fbo):this.renderer.setRenderTarget(null);
this.renderer.clear();this.renderer.render(this.scene,this.camera);this.renderer.render(this.sceneReticle,this.camera);this.renderer.clearDepth()}},{key:"render",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.update();this.panorama&&(this.mode===B.NORMAL?this.renderNormal(a):this.renderEffect(a))}},{key:"animate",value:function(){this.onChange()}},{key:"onChange",value:function(){this.update();this.render()}},{key:"registerMouseAndTouchEvents",value:function(){var a=
{passive:!1};this.container.addEventListener("mousedown",this.handlerMouseDown,a);this.container.addEventListener("mousemove",this.handlerMouseMove,a);this.container.addEventListener("mouseup",this.handlerMouseUp,a);this.container.addEventListener("touchstart",this.handlerMouseDown,a);this.container.addEventListener("touchend",this.handlerMouseUp,a)}},{key:"unregisterMouseAndTouchEvents",value:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",
this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",this.handlerMouseUp,!1);this.container.removeEventListener("touchstart",this.handlerMouseDown,!1);this.container.removeEventListener("touchend",this.handlerMouseUp,!1)}},{key:"registerReticleEvent",value:function(){this.addUpdateCallback(this.handlerTap)}},{key:"unregisterReticleEvent",value:function(){this.removeUpdateCallback(this.handlerTap)}},{key:"updateReticleEvent",value:function(){var a=this.container.clientWidth/2+this.container.offsetLeft,
b=this.container.clientHeight/2;this.removeUpdateCallback(this.handlerTap);this.handlerTap=this.onTap.bind(this,{clientX:a,clientY:b});this.addUpdateCallback(this.handlerTap)}},{key:"registerEventListeners",value:function(){window.addEventListener("resize",this.handlerWindowResize,!0);window.addEventListener("keydown",this.handlerKeyDown,!0);window.addEventListener("keyup",this.handlerKeyUp,!0)}},{key:"unregisterEventListeners",value:function(){window.removeEventListener("resize",this.handlerWindowResize,
!0);window.removeEventListener("keydown",this.handlerKeyDown,!0);window.removeEventListener("keyup",this.handlerKeyUp,!0)}},{key:"dispose",value:function(){function a(b){for(var c=b.children.length-1;0<=c;c--)a(b.children[c]),b.remove(b.children[c]);b.type===q.PANORAMA||b.type===A.INFOSPOT||b.subtype===A.FLOOR_RING_INFOSPOT?b.dispose():b.dispatchEvent&&b.dispatchEvent("dispose")}this.disableAutoRate();this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.unregisterEventListeners();this.fbo.dispose();
this.reticleFbo.dispose();a(this.scene);this.DragControls&&this.DragControls.dispose&&this.DragControls.dispose();this.OrbitControls&&this.OrbitControls.dispose&&this.OrbitControls.dispose();this.widget&&(this.widget.dispose(),this.widget=null);this.updateCallbacks=null;d.Cache&&d.Cache.enabled&&d.Cache.clear();this.floorCursor&&(this.floorCursor=null)}},{key:"removeWidget",value:function(){this.widget&&(this.widget.dispose(),this.widget=null)}},{key:"destroy",value:function(){this.dispose();this.render();
window.cancelAnimationFrame(this.requestAnimationId)}},{key:"onPanoramaDispose",value:function(a){this.scene.traverse(function(b){b.type===q.PANORAMA&&(b.linkedSpots=b.linkedSpots.map(function(b){return b.toPanorama!==a?b:b.dispose()}).filter(function(a){return!!a}))});a===this.panorama&&(this.panorama=null)}},{key:"loadAsyncRequest",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},c=new window.XMLHttpRequest;c.onloadend=function(a){b(a)};c.open("GET",a,
!0);c.send(null)}},{key:"addViewIndicator",value:function(){var a=this;this.loadAsyncRequest(J.ViewIndicator,function(b){var c=this;if(0!==b.loaded){b=b.target.responseXML.documentElement;b.style.width="".concat(a.viewIndicatorSize,"px");b.style.height="".concat(a.viewIndicatorSize,"px");b.style.position="absolute";b.style.top="10px";b.style.left="10px";b.style.opacity="0.5";b.style.cursor="-webkit-grab";b.id="panolens-view-indicator-container";a.container.append(b);var e=b.querySelector("#indicator");
a.addUpdateCallback(function(){a.radius=.225*a.viewIndicatorSize;a.currentPanoAngle=a.camera.rotation.y-d.Math.degToRad(90);a.fovAngle=d.Math.degToRad(a.camera.fov);a.leftAngle=-a.currentPanoAngle-a.fovAngle/2;a.rightAngle=-a.currentPanoAngle+a.fovAngle/2;a.leftX=a.radius*Math.cos(a.leftAngle);a.leftY=a.radius*Math.sin(a.leftAngle);a.rightX=a.radius*Math.cos(a.rightAngle);a.rightY=a.radius*Math.sin(a.rightAngle);a.indicatorD="M ".concat(a.leftX," ").concat(a.leftY," A ").concat(a.radius," ").concat(a.radius,
" 0 0 1 ").concat(a.rightX," ").concat(a.rightY);a.leftX&&a.leftY&&a.rightX&&a.rightY&&a.radius&&e.setAttribute("d",a.indicatorD)});b.addEventListener("mouseenter",function(){c.style.opacity="1"});b.addEventListener("mouseleave",function(){c.style.opacity="0.5"})}})}},{key:"appendControlItem",value:function(a){var b=this.widget.createCustomItem(a);"video"===a.group?this.widget.videoElement.append(b):this.widget.barElement.append(b);return b}},{key:"clearAllCache",value:function(){d.Cache.clear()}}]);
return f}(d.EventDispatcher),mb=function(g){function f(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C(this,f);var b=k.call(this);b.options=z({container:b.setupContainer(a.container),clickTolerance:10,isTourViewerPage:!1},a);b.container=b.options.container;b.renderer=b.setupRenderer();b.container.append(b.renderer.domElement);b.scene=new d.Scene;b.scene.background=new d.Color(1316891);b.camera=b.setupCamera(b.container.clientWidth/b.container.clientHeight);b.camera.updateProjectionMatrix();
b.control=b.setupControls();b.dollspot=null;b.selectedDollspot=null;b.dollhouse=null;b.panorama=null;b.requestAnimationId=null;b.DOLL_VIEWER_CONTAINER_ID="floorpano";b.userMouse=new d.Vector2;b.rightmousemove=!1;b.raycaster=new d.Raycaster;b.raycasterPoint=new d.Vector2;b.handlerMouseDown=b.onMouseDown.bind(t(b));b.handlerMouseMove=b.onMouseMove.bind(t(b));b.handlerMouseUp=b.onMouseUp.bind(t(b));b.handlerMouseWheel=b.onMouseWheel.bind(t(b));b.handlerContextmenu=b.onContextmenu.bind(t(b));b.handlerWindowResize=
b.onWindowResize.bind(t(b));b.registerEventListeners();b.animate();return b}F(f,g);var k=G(f);H(f,[{key:"setupCamera",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new d.PerspectiveCamera(20,a,.1,1E4);b.updateWorldMatrix=function(a,b){d.Object3D.prototype.updateWorldMatrix.call(this,a,b)};return b}},{key:"setupRenderer",value:function(){var a=window.devicePixelRatio,b=!0;1<a&&(b=!1);b=new d.WebGLRenderer({antialias:b,powerPreference:"high-performance"});b.setPixelRatio(a);
b.setSize(this.container.clientWidth,this.container.clientHeight);b.autoClear=!1;b.setClearColor(2764856,1);b.domElement.classList.add("panolens-canvas");b.domElement.style.display="block";return b}},{key:"setupContainer",value:function(a){var b=a||document.createElement("div"),c=b.clientWidth||"100%",d=b.clientHeight||"100%";b.classList.add("panolens-container");b.style.width=c;b.style.height=d;b._width=b.clientWidth;b._height=b.clientHeight;b.style.backgroundColor="#2A3038";a||document.body.appendChild(b);
return b}},{key:"setControlCenter",value:function(a){a=(new d.Box3).setFromObject(a);this.orbitControl.target=a.getCenter(new d.Vector3);this.orbitControl.update()}},{key:"setupControls",value:function(){var a=new da(this.camera,this.container,{panSpeed:3});a.screenSpacePanning=!0;a.noPan=!1;a.enableDamping=!1;a.enableZoom=!0;a.rotateSpeed=10;a.minDistance=.1;a.maxDistance=200;this.orbitControl=a;a.update();return a}},{key:"add",value:function(a){var b=this;a instanceof Da&&(a.dispatchEvent({type:"panolens-container",
container:this.container}),a.addEventListener("ready",function(){b.dollhouse=a;b.panorama=a;b.scene.add(b.dollhouse);b.setControlCenter(b.dollhouse);if(b.options.camera)b.camera.position.set(b.options.camera.position.x,b.options.camera.position.y,b.options.camera.position.z),b.orbitControl.target=new d.Vector3(b.options.camera.target.x,b.options.camera.target.y,b.options.camera.target.z);else{var c=(new d.Box3).setFromObject(a);b.camera.position.set(c.max.x+2*(c.max.x-c.min.x),c.max.y+2*(c.max.y-
c.min.y),c.max.z+2*(c.max.z-c.min.z));b.orbitControl.target=c.getCenter(new d.Vector3)}b.orbitControl.update();b.camera.updateProjectionMatrix()}),a.addEventListener("dollhouse-select-dollspot",function(a){b.dollspot=a.dollspot}))}},{key:"outputPosition",value:function(){var a=this.raycaster.intersectObject(this.panorama,!0);return 0<a.length?(a=a[0].point.clone(),0===a.length()?void 0:a):null}},{key:"onTap",value:function(a){var b=this.container.getBoundingClientRect(),c=b.top;this.raycasterPoint.x=
(a.clientX-b.left)/this.container.clientWidth*2-1;this.raycasterPoint.y=2*-((a.clientY-c)/this.container.clientHeight)+1;this.raycaster.setFromCamera(this.raycasterPoint,this.camera)}},{key:"getCameraPosition",value:function(){return{position:this.camera.position,target:this.orbitControl.target}}},{key:"selectDollspot",value:function(){this.dollspot.select();this.selectedDollspot=this.dollspot;this.orbitControl.enabled=!1}},{key:"unselectDollspot",value:function(){var a;null===(a=this.dollspot)||
void 0===a?void 0:a.unselect();this.selectedDollspot=this.dollspot=null;this.orbitControl.enabled=!0}},{key:"onMouseDown",value:function(a){this.userMouse.x=0<=a.clientX?a.clientX:a.touches[0].clientX;this.userMouse.y=0<=a.clientY?a.clientY:a.touches[0].clientY;this.userMouse.type="mousedown";this.onTap(a)}},{key:"onContextmenu",value:function(a){a.preventDefault()}},{key:"onMouseMove",value:function(a){this.rightmousemove&&a.preventDefault();this.userMouse.type="mousemove";var b=this.outputPosition();
this.dollspot&&b&&!this.options.isTourViewerPage&&(this.orbitControl.enabled=!1,this.dollspot.position.set(b.x,b.y,b.z));this.onTap(a)}},{key:"onMouseUp",value:function(a){this.userMouse.type="mouseup";this.rightmousemove=!1;a.preventDefault();2===a.button&&this.setOrbitTargetToScreenCenter();var b=0===a.button&&(this.userMouse.x>=a.clientX-this.options.clickTolerance&&this.userMouse.x<=a.clientX+this.options.clickTolerance&&this.userMouse.y>=a.clientY-this.options.clickTolerance&&this.userMouse.y<=
a.clientY+this.options.clickTolerance||a.changedTouches&&this.userMouse.x>=a.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=a.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=a.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=a.changedTouches[0].clientY+this.options.clickTolerance)?"click":void 0;"click"===b&&this.dollspot&&(this.selectDollspot(),this.dispatchEvent({type:"click-on-dollspot",shortId:this.dollspot.shortId}));
if("click"===b&&!this.dollspot){this.unselectDollspot();var c=this.outputPosition();c&&this.dispatchEvent({type:"create-new-dollspot",coords:c})}"click"!==b&&this.dollspot&&this.changeDollspotPosition(this.dollspot);this.onTap(a,b);this.userMouse.type="none";this.dollspot=null;this.orbitControl.enabled=!0}},{key:"onMouseWheel",value:function(a){a.preventDefault();var b=this.camera.position.x-this.orbitControl.target.x,c=this.camera.position.y-this.orbitControl.target.y,d=this.camera.position.z-this.orbitControl.target.z;
b*=(5E3+a.deltaY)/5E3;c*=(5E3+a.deltaY)/5E3;d*=(5E3+a.deltaY)/5E3;this.camera.position.x=b+this.orbitControl.target.x;this.camera.position.y=c+this.orbitControl.target.y;this.camera.position.z=d+this.orbitControl.target.z}},{key:"setOrbitTargetToScreenCenter",value:function(){var a,b=new d.Raycaster;b.setFromCamera(new d.Vector2(0,0),this.camera);if(b=null===(a=b.intersectObject(this.panorama,!0)[0])||void 0===a?void 0:a.point.clone())this.orbitControl.target=b,this.orbitControl.update()}},{key:"changeDollspotPosition",
value:function(a){this.dispatchEvent({type:"change-dollspot-position",shortId:a.shortId,coords:this.outputPosition()})}},{key:"onWindowResize",value:function(a,b){var c=this.container.classList.contains("panolens-container")||this.container.isFullscreen,d=null;d=document.getElementById(this.DOLL_VIEWER_CONTAINER_ID);if(void 0!==a&&void 0!==b){var f=a;var g=b;this.container._width=a;this.container._height=b}else d?(c=d.clientHeight,f=d.clientWidth,g=c):(d=ha?Math.min(document.documentElement.clientWidth,
window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=ha?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),f=c?d:this.container.clientWidth,g=c?a:this.container.clientHeight),this.container._width=f,this.container._height=g;this.camera.aspect=f/g;this.camera.updateProjectionMatrix();this.renderer.setSize(f,g);this.panorama&&this.panorama.subtype===q.SLIDER&&(this.panorama.position.set(0,
0,0),this.panorama.lookAt(this.camera),this.fitObjectToScreen(this.panorama));this.dispatchEvent({type:"window-resize",width:f,height:g});this.scene.traverse(function(a){a.dispatchEvent&&a.dispatchEvent({type:"window-resize",width:f,height:g})})}},{key:"getScreenVector",value:function(a){a=a.clone();var b=this.container.clientWidth/2,c=this.container.clientHeight/2;a.project(this.camera);a.x=a.x*b+b;a.y=-(a.y*c)+c;a.z=0;return a}},{key:"registerEventListeners",value:function(){var a={passive:!1};
this.container.addEventListener("mousedown",this.handlerMouseDown,a);this.container.addEventListener("mousemove",this.handlerMouseMove,a);this.container.addEventListener("mouseup",this.handlerMouseUp,a);this.container.addEventListener("wheel",this.handlerMouseWheel,a);this.container.addEventListener("contextmenu",this.handlerContextmenu,a);window.addEventListener("resize",this.handlerWindowResize,!0)}},{key:"unRegisterEventListeners",value:function(){this.container.removeEventListener("mousedown",
this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",this.handlerMouseUp,!1);this.container.removeEventListener("wheel",this.handlerMouseWheel,!1);this.container.removeEventListener("contextmenu",this.handlerContextmenu,!1);window.removeEventListener("resize",this.handlerWindowResize,!0)}},{key:"animate",value:function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this));this.update();
this.render()}},{key:"update",value:function(){var a=this;this.orbitControl.update();var b=new d.Vector3;this.scene.traverse(function(c){if(c.element&&c instanceof Z){var d=a.getScreenVector(c.getWorldPosition(b));c.translateElement(d.x,d.y)}})}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"destroy",value:function(){this.unRegisterEventListeners();this.render();window.cancelAnimationFrame(this.requestAnimationId)}}]);return f}(d.EventDispatcher);"134"!=d.REVISION&&
console.warn("three.js version is not matched. Please consider use the target revision ".concat("134"));window.TWEEN=u;p.BACKGROUNDS=Y;p.BasicPanorama=cb;p.CONTROLS=Q;p.CURSORS=O;p.CURSOR_TYPES=qa;p.CubeTextureLoader=Ea;p.DataImage=J;p.DollViewer=mb;p.Dollhouse=Da;p.Dollspot=Z;p.EXTRA_GEOMETRY=S;p.EmptyPanorama=bb;p.FLOOR_PLANE_POSITION=X;p.FloorCursor=Ha;p.FloorPlane=R;p.FloorRingInfospot=Wa;p.ID_FOR_CUSTOM_BUTTON=fa;p.ImageLittlePlanet=hb;p.ImageLoader=ra;p.ImagePanorama=sa;p.Infospot=Ia;p.MODES=
B;p.Nadir=Xa;p.PANORAMA_TYPES=q;p.Panorama=T;p.ProgressiveImagePanorama=ab;p.REVISION="11";p.Reticle=Ga;p.SPOT_TYPES=A;p.STEREOFORMAT=U;p.SliderPanorama=db;p.SpinPanorama=jb;p.THREE_REVISION="134";p.THREE_VERSION=Ta;p.TextureLoader=V;p.VERSION="0.11.0";p.VideoPanorama=ja;p.Viewer=lb;p.ViewerManager=W;p.Widget=Fa;Object.defineProperty(p,"__esModule",{value:!0})});
